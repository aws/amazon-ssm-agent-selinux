#line 1 "/usr/share/selinux/devel/include/support/file_patterns.spt"
#
# Directory patterns (dir)
#
# Parameters:
# 1. domain type
# 2. container (directory) type
# 3. directory type
#
#line 12


#line 17


#line 22


#line 27


#line 32


#line 37


#line 42


#line 47


#line 52


#line 57


#line 62


#line 67


#line 72


#line 77


#
# Regular file patterns (file)
#
# Parameters:
# 1. domain type
# 2. container (directory) type
# 3. file type
#
#line 90


#line 95


#line 100


#line 105


#line 110


#line 115


#line 120


#line 125


#line 130


#line 135


#line 140


#line 145


#line 150


#line 155


#line 160


#
# Symbolic link patterns (lnk_file)
#
# Parameters:
# 1. domain type
# 2. container (directory) type
# 3. file type
#
#line 173


#line 178


#line 183


#line 188


#line 193


#line 198


#line 203


#line 208


#line 213


#line 218


#line 223


#line 228


#line 233


#
# (Un)named Pipes/FIFO patterns (fifo_file)
#
# Parameters:
# 1. domain type
# 2. container (directory) type
# 3. file type
#
#line 246


#line 251


#line 256


#line 261


#line 266


#line 271


#line 276


#line 281


#line 286


#line 291


#line 296


#line 301


#line 306


#
# (Un)named sockets patterns (sock_file)
#
# Parameters:
# 1. domain type
# 2. container (directory) type
# 3. file type
#
#line 319


#line 324


#line 329


#line 334


#line 339


#line 344


#line 349


#line 354


#line 359


#line 364


#line 369


#line 374


#
# Block device node patterns (blk_file)
#
# Parameters:
# 1. domain type
# 2. container (directory) type
# 3. file type
#
#line 387


#line 392


#line 397


#line 402


#line 407


#line 412


#line 418


#line 423


#line 428


#line 434


#line 439


#line 444


#line 449


#
# Character device node patterns (chr_file)
#
# Parameters:
# 1. domain type
# 2. container (directory) type
# 3. file type
#
#line 462


#line 467


#line 472


#line 477


#line 482


#line 487


#line 493


#line 498


#line 503


#line 509


#line 514


#line 519


#line 524


#
# File type_transition patterns
#
# filetrans_add_pattern(domain,dirtype,newtype,class(es),[filename])
#
#line 534


#
# filetrans_pattern(domain,dirtype,newtype,class(es),[filename])
#
#line 542


#line 556

#line 1 "/usr/share/selinux/devel/include/support/ipc_patterns.spt"
#
# unix domain socket patterns
#
#line 8


#line 14

#line 1 "/usr/share/selinux/devel/include/support/obj_perm_sets.spt"
########################################
# 
# Support macros for sets of object classes and permissions
#
# This file should only have object class and permission set macros - they
# can only reference object classes and/or permissions.

#
# All directory and file classes
#


#
# All non-directory file classes.
#


#
# Non-device file classes.
#


#
# Device file classes.
#


#
# All socket classes.
#


#
# Datagram socket classes.
# 


#
# Stream socket classes.
#


#
# Unprivileged socket classes (exclude rawip, netlink, packet).
#


########################################
# 
# Macros for sets of permissions
#

#
# Permissions to mount and unmount file systems.
#


#
# Permissions for using sockets.
# 


#
# Permissions for creating and using sockets.
# 


#
# Permissions for using stream sockets.
# 


#
# Permissions for creating and using stream sockets.
# 


#
# Permissions for creating and using sockets.
# 


#
# Permissions for creating and using sockets.
# 



#
# Permissions for creating and using netlink sockets.
# 


#
# Permissions for using netlink sockets for operations that modify state.
# 


#
# Permissions for using netlink sockets for operations that observe state.
# 


#
# Permissions for sending all signals.
#


#
# Permissions for sending and receiving network packets.
#


#
# Permissions for using System V IPC
#










########################################
#
# New permission sets
#

#
# Directory (dir)
#















#
# Regular file (file)
#




















#
# Symbolic link (lnk_file)
#














#
# (Un)named Pipes/FIFOs (fifo_file)
#















#
# (Un)named Sockets (sock_file)
#














#
# Block device nodes (blk_file)
#















#
# Character device nodes (chr_file)
#















########################################
#
# Special permission sets
#

#
# Use (read and write) terminals
#



#
# Sockets
#



#
# Keys
#


#
# Service
#

#line 1 "/usr/share/selinux/devel/include/support/misc_patterns.spt"
#
# Specified domain transition patterns
#
#line 8


# compatibility:


#line 20


#
# Automatic domain transition patterns
#
#line 28


# compatibility:


#line 39


#
# Dynamic transition pattern
#
#line 48


#
# Other process permissions
#
#line 58

#line 1 "/usr/share/selinux/devel/include/support/all_perms.spt"


































































































#line 165


#line 200

#line 1 "/usr/share/selinux/devel/include/support/misc_macros.spt"

########################################
#
# Helper macros
#

#
# shiftn(num,list...)
#
# shift the list num times
#


#
# ifndef(expr,true_block,false_block)
#
# m4 does not have this.
#


#
# __endline__
#
# dummy macro to insert a newline.  used for 
# errprint, so the close parentheses can be
# indented correctly.
#
#line 29


########################################
#
# refpolwarn(message)
#
# print a warning message
#


########################################
#
# refpolerr(message)
#
# print an error message.  does not
# make anything fail.
#


########################################
#
# gen_user(username, prefix, role_set, mls_defaultlevel, mls_range, [mcs_categories])
#
#line 58


########################################
#
# gen_context(context,mls_sensitivity,[mcs_categories])
#
#line 65

########################################
#
# can_exec(domain,executable)
#


########################################
#
# gen_bool(name,default_value)
#
#line 78

#line 1 "/usr/share/selinux/devel/include/support/mls_mcs_macros.spt"
########################################
#
# gen_cats(N)
#
# declares categores c0 to c(N-1)
#
#line 10




########################################
#
# gen_sens(N)
#
# declares sensitivites s0 to s(N-1) with dominance
# in increasing numeric order with s0 lowest, s(N-1) highest
#
#line 24




#line 34


########################################
#
# gen_levels(N,M)
#
# levels from s0 to (N-1) with categories c0 to (M-1)
#
#line 45




########################################
#
# Basic level names for system low and high
#





#line 1 "/usr/share/selinux/devel/include/support/loadable_module.spt"
########################################
#
# Macros for switching between source policy
# and loadable policy module support
#

##############################
#
# For adding the module statement
#
#line 30


##############################
#
# For use in interfaces, to optionally insert a require block
#
#line 48


# helper function, since m4 wont expand macros
# if a line is a comment (#):
#line 55

##############################
#
# In the future interfaces should be in loadable modules
#
# template(name,rules)
#
#line 71


##############################
#
# In the future interfaces should be in loadable modules
#
# interface(name,rules)
#
#line 88




##############################
#
# Optional policy handling
#
#line 102


##############################
#
# Determine if we should use the default
# tunable value as specified by the policy
# or if the override value should be used
#


##############################
#
# Extract booleans out of an expression.
# This needs to be reworked so expressions
# with parentheses can work.

#line 123


##############################
#
# Tunable declaration
#
#line 131


##############################
#
# Tunable policy handling
#
#line 146

#line 377997 "tmp/all_interfaces.conf"

#line 1 "amazon_ssm_agent.te"

#line 1
	
#line 1
		module amazon_ssm_agent 1.0.0;
#line 1

#line 1
		require {
#line 1
			role system_r;
#line 1
			
#line 1
	class security { compute_av compute_create compute_member check_context load_policy compute_relabel compute_user setenforce setbool setsecparam setcheckreqprot read_policy validate_trans };
#line 1
	class process { fork transition sigchld sigkill sigstop signull signal ptrace getsched setsched getsession getpgid setpgid getcap setcap share getattr setexec setfscreate noatsecure siginh setrlimit rlimitinh dyntransition setcurrent execmem execstack execheap setkeycreate setsockcreate ptrace_child };
#line 1
	class system { ipc_info syslog_read syslog_mod syslog_console module_request module_load halt reboot status undefined enable disable reload kill };
#line 1
	class capability { chown dac_override dac_read_search fowner fsetid kill setgid setuid setpcap linux_immutable net_bind_service net_broadcast net_admin net_raw ipc_lock ipc_owner sys_module sys_rawio sys_chroot sys_ptrace sys_pacct sys_admin sys_boot sys_nice sys_resource sys_time sys_tty_config mknod lease audit_write audit_control setfcap };
#line 1
	class filesystem { mount remount unmount getattr relabelfrom relabelto transition associate quotamod quotaget };
#line 1
	class file { ioctl read write create getattr setattr lock relabelfrom relabelto append unlink link rename execute swapon quotaon mounton execute_no_trans entrypoint execmod open audit_access };
#line 1
	class dir { ioctl read write create getattr setattr lock relabelfrom relabelto append unlink link rename execute swapon quotaon mounton add_name remove_name reparent search rmdir open audit_access execmod };
#line 1
	class fd { use };
#line 1
	class lnk_file { ioctl read write create getattr setattr lock relabelfrom relabelto append unlink link rename execute swapon quotaon mounton open audit_access execmod };
#line 1
	class chr_file { ioctl read write create getattr setattr lock relabelfrom relabelto append unlink link rename execute swapon quotaon mounton execute_no_trans entrypoint execmod open audit_access };
#line 1
	class blk_file { ioctl read write create getattr setattr lock relabelfrom relabelto append unlink link rename execute swapon quotaon mounton open audit_access execmod };
#line 1
	class sock_file { ioctl read write create getattr setattr lock relabelfrom relabelto append unlink link rename execute swapon quotaon mounton open audit_access execmod };
#line 1
	class fifo_file { ioctl read write create getattr setattr lock relabelfrom relabelto append unlink link rename execute swapon quotaon mounton open audit_access execmod };
#line 1
	class socket { ioctl read write create getattr setattr lock relabelfrom relabelto append bind connect listen accept getopt setopt shutdown recvfrom sendto recv_msg send_msg name_bind };
#line 1
	class tcp_socket { ioctl read write create getattr setattr lock relabelfrom relabelto append bind connect listen accept getopt setopt shutdown recvfrom sendto recv_msg send_msg name_bind connectto newconn acceptfrom node_bind name_connect };
#line 1
	class udp_socket { ioctl read write create getattr setattr lock relabelfrom relabelto append bind connect listen accept getopt setopt shutdown recvfrom sendto recv_msg send_msg name_bind node_bind };
#line 1
	class rawip_socket { ioctl read write create getattr setattr lock relabelfrom relabelto append bind connect listen accept getopt setopt shutdown recvfrom sendto recv_msg send_msg name_bind node_bind };
#line 1
	class node { tcp_recv tcp_send udp_recv udp_send rawip_recv rawip_send enforce_dest dccp_recv dccp_send recvfrom sendto };
#line 1
	class netif { tcp_recv tcp_send udp_recv udp_send rawip_recv rawip_send dccp_recv dccp_send ingress egress };
#line 1
	class netlink_socket { ioctl read write create getattr setattr lock relabelfrom relabelto append bind connect listen accept getopt setopt shutdown recvfrom sendto recv_msg send_msg name_bind };
#line 1
	class packet_socket { ioctl read write create getattr setattr lock relabelfrom relabelto append bind connect listen accept getopt setopt shutdown recvfrom sendto recv_msg send_msg name_bind };
#line 1
	class key_socket { ioctl read write create getattr setattr lock relabelfrom relabelto append bind connect listen accept getopt setopt shutdown recvfrom sendto recv_msg send_msg name_bind };
#line 1
	class unix_stream_socket { ioctl read write create getattr setattr lock relabelfrom relabelto append bind connect listen accept getopt setopt shutdown recvfrom sendto recv_msg send_msg name_bind connectto newconn acceptfrom };
#line 1
	class unix_dgram_socket { ioctl read write create getattr setattr lock relabelfrom relabelto append bind connect listen accept getopt setopt shutdown recvfrom sendto recv_msg send_msg name_bind };
#line 1
	class sem { create destroy getattr setattr read write associate unix_read unix_write };
#line 1
	class msg { send receive };
#line 1
	class msgq { create destroy getattr setattr read write associate unix_read unix_write enqueue };
#line 1
	class shm { create destroy getattr setattr read write associate unix_read unix_write lock };
#line 1
	class ipc { create destroy getattr setattr read write associate unix_read unix_write };
#line 1
	class netlink_route_socket { ioctl read write create getattr setattr lock relabelfrom relabelto append bind connect listen accept getopt setopt shutdown recvfrom sendto recv_msg send_msg name_bind nlmsg_read nlmsg_write };
#line 1
	class netlink_firewall_socket { ioctl read write create getattr setattr lock relabelfrom relabelto append bind connect listen accept getopt setopt shutdown recvfrom sendto recv_msg send_msg name_bind nlmsg_read nlmsg_write };
#line 1
	class netlink_tcpdiag_socket { ioctl read write create getattr setattr lock relabelfrom relabelto append bind connect listen accept getopt setopt shutdown recvfrom sendto recv_msg send_msg name_bind nlmsg_read nlmsg_write };
#line 1
	class netlink_nflog_socket { ioctl read write create getattr setattr lock relabelfrom relabelto append bind connect listen accept getopt setopt shutdown recvfrom sendto recv_msg send_msg name_bind };
#line 1
	class netlink_xfrm_socket { ioctl read write create getattr setattr lock relabelfrom relabelto append bind connect listen accept getopt setopt shutdown recvfrom sendto recv_msg send_msg name_bind nlmsg_read nlmsg_write };
#line 1
	class netlink_selinux_socket { ioctl read write create getattr setattr lock relabelfrom relabelto append bind connect listen accept getopt setopt shutdown recvfrom sendto recv_msg send_msg name_bind };
#line 1
	class netlink_audit_socket { ioctl read write create getattr setattr lock relabelfrom relabelto append bind connect listen accept getopt setopt shutdown recvfrom sendto recv_msg send_msg name_bind nlmsg_read nlmsg_write nlmsg_relay nlmsg_readpriv nlmsg_tty_audit };
#line 1
	class netlink_ip6fw_socket { ioctl read write create getattr setattr lock relabelfrom relabelto append bind connect listen accept getopt setopt shutdown recvfrom sendto recv_msg send_msg name_bind nlmsg_read nlmsg_write };
#line 1
	class netlink_dnrt_socket { ioctl read write create getattr setattr lock relabelfrom relabelto append bind connect listen accept getopt setopt shutdown recvfrom sendto recv_msg send_msg name_bind };
#line 1
	class association { sendto recvfrom setcontext polmatch };
#line 1
	class netlink_kobject_uevent_socket { ioctl read write create getattr setattr lock relabelfrom relabelto append bind connect listen accept getopt setopt shutdown recvfrom sendto recv_msg send_msg name_bind };
#line 1
	class appletalk_socket { ioctl read write create getattr setattr lock relabelfrom relabelto append bind connect listen accept getopt setopt shutdown recvfrom sendto recv_msg send_msg name_bind };
#line 1
	class packet { send recv relabelto flow_in flow_out forward_in forward_out };
#line 1
	class key { view read write search link setattr create };
#line 1
	class dccp_socket { ioctl read write create getattr setattr lock relabelfrom relabelto append bind connect listen accept getopt setopt shutdown recvfrom sendto recv_msg send_msg name_bind node_bind name_connect };
#line 1
	class memprotect { mmap_zero };
#line 1
	class peer { recv };
#line 1
	class capability2 { mac_override mac_admin syslog wake_alarm block_suspend audit_read epolwakeup compromise_kernel };
#line 1
	class kernel_service { use_as_override create_files_as };
#line 1
	class tun_socket { ioctl read write create getattr setattr lock relabelfrom relabelto append bind connect listen accept getopt setopt shutdown recvfrom sendto recv_msg send_msg name_bind attach_queue };
#line 1
	class binder { impersonate call set_context_mgr transfer };
#line 1
	class netlink_iscsi_socket { ioctl read write create getattr setattr lock relabelfrom relabelto append bind connect listen accept getopt setopt shutdown recvfrom sendto recv_msg send_msg name_bind };
#line 1
	class netlink_fib_lookup_socket { ioctl read write create getattr setattr lock relabelfrom relabelto append bind connect listen accept getopt setopt shutdown recvfrom sendto recv_msg send_msg name_bind };
#line 1
	class netlink_connector_socket { ioctl read write create getattr setattr lock relabelfrom relabelto append bind connect listen accept getopt setopt shutdown recvfrom sendto recv_msg send_msg name_bind };
#line 1
	class netlink_netfilter_socket { ioctl read write create getattr setattr lock relabelfrom relabelto append bind connect listen accept getopt setopt shutdown recvfrom sendto recv_msg send_msg name_bind };
#line 1
	class netlink_generic_socket { ioctl read write create getattr setattr lock relabelfrom relabelto append bind connect listen accept getopt setopt shutdown recvfrom sendto recv_msg send_msg name_bind };
#line 1
	class netlink_scsitransport_socket { ioctl read write create getattr setattr lock relabelfrom relabelto append bind connect listen accept getopt setopt shutdown recvfrom sendto recv_msg send_msg name_bind };
#line 1
	class netlink_rdma_socket { ioctl read write create getattr setattr lock relabelfrom relabelto append bind connect listen accept getopt setopt shutdown recvfrom sendto recv_msg send_msg name_bind };
#line 1
	class netlink_crypto_socket { ioctl read write create getattr setattr lock relabelfrom relabelto append bind connect listen accept getopt setopt shutdown recvfrom sendto recv_msg send_msg name_bind };
#line 1
	class infiniband_pkey { access };
#line 1
	class infiniband_endport { manage_subnet };
#line 1
	class service { start stop status reload enable disable kill load };
#line 1
	class proxy { read };
#line 1
	class cap_userns { chown dac_override dac_read_search fowner fsetid kill setgid setuid setpcap linux_immutable net_bind_service net_broadcast net_admin net_raw ipc_lock ipc_owner sys_module sys_rawio sys_chroot sys_ptrace sys_pacct sys_admin sys_boot sys_nice sys_resource sys_time sys_tty_config mknod lease audit_write audit_control setfcap };
#line 1
	class cap2_userns { mac_override mac_admin syslog wake_alarm block_suspend audit_read };
#line 1
	class process2 { nnp_transition nosuid_transition };
#line 1

#line 1

#line 1
			
#line 1
				sensitivity s0;
#line 1

#line 1
				category c0;
#line 1
category c1;
#line 1
category c2;
#line 1
category c3;
#line 1
category c4;
#line 1
category c5;
#line 1
category c6;
#line 1
category c7;
#line 1
category c8;
#line 1
category c9;
#line 1
category c10;
#line 1
category c11;
#line 1
category c12;
#line 1
category c13;
#line 1
category c14;
#line 1
category c15;
#line 1
category c16;
#line 1
category c17;
#line 1
category c18;
#line 1
category c19;
#line 1
category c20;
#line 1
category c21;
#line 1
category c22;
#line 1
category c23;
#line 1
category c24;
#line 1
category c25;
#line 1
category c26;
#line 1
category c27;
#line 1
category c28;
#line 1
category c29;
#line 1
category c30;
#line 1
category c31;
#line 1
category c32;
#line 1
category c33;
#line 1
category c34;
#line 1
category c35;
#line 1
category c36;
#line 1
category c37;
#line 1
category c38;
#line 1
category c39;
#line 1
category c40;
#line 1
category c41;
#line 1
category c42;
#line 1
category c43;
#line 1
category c44;
#line 1
category c45;
#line 1
category c46;
#line 1
category c47;
#line 1
category c48;
#line 1
category c49;
#line 1
category c50;
#line 1
category c51;
#line 1
category c52;
#line 1
category c53;
#line 1
category c54;
#line 1
category c55;
#line 1
category c56;
#line 1
category c57;
#line 1
category c58;
#line 1
category c59;
#line 1
category c60;
#line 1
category c61;
#line 1
category c62;
#line 1
category c63;
#line 1
category c64;
#line 1
category c65;
#line 1
category c66;
#line 1
category c67;
#line 1
category c68;
#line 1
category c69;
#line 1
category c70;
#line 1
category c71;
#line 1
category c72;
#line 1
category c73;
#line 1
category c74;
#line 1
category c75;
#line 1
category c76;
#line 1
category c77;
#line 1
category c78;
#line 1
category c79;
#line 1
category c80;
#line 1
category c81;
#line 1
category c82;
#line 1
category c83;
#line 1
category c84;
#line 1
category c85;
#line 1
category c86;
#line 1
category c87;
#line 1
category c88;
#line 1
category c89;
#line 1
category c90;
#line 1
category c91;
#line 1
category c92;
#line 1
category c93;
#line 1
category c94;
#line 1
category c95;
#line 1
category c96;
#line 1
category c97;
#line 1
category c98;
#line 1
category c99;
#line 1
category c100;
#line 1
category c101;
#line 1
category c102;
#line 1
category c103;
#line 1
category c104;
#line 1
category c105;
#line 1
category c106;
#line 1
category c107;
#line 1
category c108;
#line 1
category c109;
#line 1
category c110;
#line 1
category c111;
#line 1
category c112;
#line 1
category c113;
#line 1
category c114;
#line 1
category c115;
#line 1
category c116;
#line 1
category c117;
#line 1
category c118;
#line 1
category c119;
#line 1
category c120;
#line 1
category c121;
#line 1
category c122;
#line 1
category c123;
#line 1
category c124;
#line 1
category c125;
#line 1
category c126;
#line 1
category c127;
#line 1
category c128;
#line 1
category c129;
#line 1
category c130;
#line 1
category c131;
#line 1
category c132;
#line 1
category c133;
#line 1
category c134;
#line 1
category c135;
#line 1
category c136;
#line 1
category c137;
#line 1
category c138;
#line 1
category c139;
#line 1
category c140;
#line 1
category c141;
#line 1
category c142;
#line 1
category c143;
#line 1
category c144;
#line 1
category c145;
#line 1
category c146;
#line 1
category c147;
#line 1
category c148;
#line 1
category c149;
#line 1
category c150;
#line 1
category c151;
#line 1
category c152;
#line 1
category c153;
#line 1
category c154;
#line 1
category c155;
#line 1
category c156;
#line 1
category c157;
#line 1
category c158;
#line 1
category c159;
#line 1
category c160;
#line 1
category c161;
#line 1
category c162;
#line 1
category c163;
#line 1
category c164;
#line 1
category c165;
#line 1
category c166;
#line 1
category c167;
#line 1
category c168;
#line 1
category c169;
#line 1
category c170;
#line 1
category c171;
#line 1
category c172;
#line 1
category c173;
#line 1
category c174;
#line 1
category c175;
#line 1
category c176;
#line 1
category c177;
#line 1
category c178;
#line 1
category c179;
#line 1
category c180;
#line 1
category c181;
#line 1
category c182;
#line 1
category c183;
#line 1
category c184;
#line 1
category c185;
#line 1
category c186;
#line 1
category c187;
#line 1
category c188;
#line 1
category c189;
#line 1
category c190;
#line 1
category c191;
#line 1
category c192;
#line 1
category c193;
#line 1
category c194;
#line 1
category c195;
#line 1
category c196;
#line 1
category c197;
#line 1
category c198;
#line 1
category c199;
#line 1
category c200;
#line 1
category c201;
#line 1
category c202;
#line 1
category c203;
#line 1
category c204;
#line 1
category c205;
#line 1
category c206;
#line 1
category c207;
#line 1
category c208;
#line 1
category c209;
#line 1
category c210;
#line 1
category c211;
#line 1
category c212;
#line 1
category c213;
#line 1
category c214;
#line 1
category c215;
#line 1
category c216;
#line 1
category c217;
#line 1
category c218;
#line 1
category c219;
#line 1
category c220;
#line 1
category c221;
#line 1
category c222;
#line 1
category c223;
#line 1
category c224;
#line 1
category c225;
#line 1
category c226;
#line 1
category c227;
#line 1
category c228;
#line 1
category c229;
#line 1
category c230;
#line 1
category c231;
#line 1
category c232;
#line 1
category c233;
#line 1
category c234;
#line 1
category c235;
#line 1
category c236;
#line 1
category c237;
#line 1
category c238;
#line 1
category c239;
#line 1
category c240;
#line 1
category c241;
#line 1
category c242;
#line 1
category c243;
#line 1
category c244;
#line 1
category c245;
#line 1
category c246;
#line 1
category c247;
#line 1
category c248;
#line 1
category c249;
#line 1
category c250;
#line 1
category c251;
#line 1
category c252;
#line 1
category c253;
#line 1
category c254;
#line 1
category c255;
#line 1
category c256;
#line 1
category c257;
#line 1
category c258;
#line 1
category c259;
#line 1
category c260;
#line 1
category c261;
#line 1
category c262;
#line 1
category c263;
#line 1
category c264;
#line 1
category c265;
#line 1
category c266;
#line 1
category c267;
#line 1
category c268;
#line 1
category c269;
#line 1
category c270;
#line 1
category c271;
#line 1
category c272;
#line 1
category c273;
#line 1
category c274;
#line 1
category c275;
#line 1
category c276;
#line 1
category c277;
#line 1
category c278;
#line 1
category c279;
#line 1
category c280;
#line 1
category c281;
#line 1
category c282;
#line 1
category c283;
#line 1
category c284;
#line 1
category c285;
#line 1
category c286;
#line 1
category c287;
#line 1
category c288;
#line 1
category c289;
#line 1
category c290;
#line 1
category c291;
#line 1
category c292;
#line 1
category c293;
#line 1
category c294;
#line 1
category c295;
#line 1
category c296;
#line 1
category c297;
#line 1
category c298;
#line 1
category c299;
#line 1
category c300;
#line 1
category c301;
#line 1
category c302;
#line 1
category c303;
#line 1
category c304;
#line 1
category c305;
#line 1
category c306;
#line 1
category c307;
#line 1
category c308;
#line 1
category c309;
#line 1
category c310;
#line 1
category c311;
#line 1
category c312;
#line 1
category c313;
#line 1
category c314;
#line 1
category c315;
#line 1
category c316;
#line 1
category c317;
#line 1
category c318;
#line 1
category c319;
#line 1
category c320;
#line 1
category c321;
#line 1
category c322;
#line 1
category c323;
#line 1
category c324;
#line 1
category c325;
#line 1
category c326;
#line 1
category c327;
#line 1
category c328;
#line 1
category c329;
#line 1
category c330;
#line 1
category c331;
#line 1
category c332;
#line 1
category c333;
#line 1
category c334;
#line 1
category c335;
#line 1
category c336;
#line 1
category c337;
#line 1
category c338;
#line 1
category c339;
#line 1
category c340;
#line 1
category c341;
#line 1
category c342;
#line 1
category c343;
#line 1
category c344;
#line 1
category c345;
#line 1
category c346;
#line 1
category c347;
#line 1
category c348;
#line 1
category c349;
#line 1
category c350;
#line 1
category c351;
#line 1
category c352;
#line 1
category c353;
#line 1
category c354;
#line 1
category c355;
#line 1
category c356;
#line 1
category c357;
#line 1
category c358;
#line 1
category c359;
#line 1
category c360;
#line 1
category c361;
#line 1
category c362;
#line 1
category c363;
#line 1
category c364;
#line 1
category c365;
#line 1
category c366;
#line 1
category c367;
#line 1
category c368;
#line 1
category c369;
#line 1
category c370;
#line 1
category c371;
#line 1
category c372;
#line 1
category c373;
#line 1
category c374;
#line 1
category c375;
#line 1
category c376;
#line 1
category c377;
#line 1
category c378;
#line 1
category c379;
#line 1
category c380;
#line 1
category c381;
#line 1
category c382;
#line 1
category c383;
#line 1
category c384;
#line 1
category c385;
#line 1
category c386;
#line 1
category c387;
#line 1
category c388;
#line 1
category c389;
#line 1
category c390;
#line 1
category c391;
#line 1
category c392;
#line 1
category c393;
#line 1
category c394;
#line 1
category c395;
#line 1
category c396;
#line 1
category c397;
#line 1
category c398;
#line 1
category c399;
#line 1
category c400;
#line 1
category c401;
#line 1
category c402;
#line 1
category c403;
#line 1
category c404;
#line 1
category c405;
#line 1
category c406;
#line 1
category c407;
#line 1
category c408;
#line 1
category c409;
#line 1
category c410;
#line 1
category c411;
#line 1
category c412;
#line 1
category c413;
#line 1
category c414;
#line 1
category c415;
#line 1
category c416;
#line 1
category c417;
#line 1
category c418;
#line 1
category c419;
#line 1
category c420;
#line 1
category c421;
#line 1
category c422;
#line 1
category c423;
#line 1
category c424;
#line 1
category c425;
#line 1
category c426;
#line 1
category c427;
#line 1
category c428;
#line 1
category c429;
#line 1
category c430;
#line 1
category c431;
#line 1
category c432;
#line 1
category c433;
#line 1
category c434;
#line 1
category c435;
#line 1
category c436;
#line 1
category c437;
#line 1
category c438;
#line 1
category c439;
#line 1
category c440;
#line 1
category c441;
#line 1
category c442;
#line 1
category c443;
#line 1
category c444;
#line 1
category c445;
#line 1
category c446;
#line 1
category c447;
#line 1
category c448;
#line 1
category c449;
#line 1
category c450;
#line 1
category c451;
#line 1
category c452;
#line 1
category c453;
#line 1
category c454;
#line 1
category c455;
#line 1
category c456;
#line 1
category c457;
#line 1
category c458;
#line 1
category c459;
#line 1
category c460;
#line 1
category c461;
#line 1
category c462;
#line 1
category c463;
#line 1
category c464;
#line 1
category c465;
#line 1
category c466;
#line 1
category c467;
#line 1
category c468;
#line 1
category c469;
#line 1
category c470;
#line 1
category c471;
#line 1
category c472;
#line 1
category c473;
#line 1
category c474;
#line 1
category c475;
#line 1
category c476;
#line 1
category c477;
#line 1
category c478;
#line 1
category c479;
#line 1
category c480;
#line 1
category c481;
#line 1
category c482;
#line 1
category c483;
#line 1
category c484;
#line 1
category c485;
#line 1
category c486;
#line 1
category c487;
#line 1
category c488;
#line 1
category c489;
#line 1
category c490;
#line 1
category c491;
#line 1
category c492;
#line 1
category c493;
#line 1
category c494;
#line 1
category c495;
#line 1
category c496;
#line 1
category c497;
#line 1
category c498;
#line 1
category c499;
#line 1
category c500;
#line 1
category c501;
#line 1
category c502;
#line 1
category c503;
#line 1
category c504;
#line 1
category c505;
#line 1
category c506;
#line 1
category c507;
#line 1
category c508;
#line 1
category c509;
#line 1
category c510;
#line 1
category c511;
#line 1
category c512;
#line 1
category c513;
#line 1
category c514;
#line 1
category c515;
#line 1
category c516;
#line 1
category c517;
#line 1
category c518;
#line 1
category c519;
#line 1
category c520;
#line 1
category c521;
#line 1
category c522;
#line 1
category c523;
#line 1
category c524;
#line 1
category c525;
#line 1
category c526;
#line 1
category c527;
#line 1
category c528;
#line 1
category c529;
#line 1
category c530;
#line 1
category c531;
#line 1
category c532;
#line 1
category c533;
#line 1
category c534;
#line 1
category c535;
#line 1
category c536;
#line 1
category c537;
#line 1
category c538;
#line 1
category c539;
#line 1
category c540;
#line 1
category c541;
#line 1
category c542;
#line 1
category c543;
#line 1
category c544;
#line 1
category c545;
#line 1
category c546;
#line 1
category c547;
#line 1
category c548;
#line 1
category c549;
#line 1
category c550;
#line 1
category c551;
#line 1
category c552;
#line 1
category c553;
#line 1
category c554;
#line 1
category c555;
#line 1
category c556;
#line 1
category c557;
#line 1
category c558;
#line 1
category c559;
#line 1
category c560;
#line 1
category c561;
#line 1
category c562;
#line 1
category c563;
#line 1
category c564;
#line 1
category c565;
#line 1
category c566;
#line 1
category c567;
#line 1
category c568;
#line 1
category c569;
#line 1
category c570;
#line 1
category c571;
#line 1
category c572;
#line 1
category c573;
#line 1
category c574;
#line 1
category c575;
#line 1
category c576;
#line 1
category c577;
#line 1
category c578;
#line 1
category c579;
#line 1
category c580;
#line 1
category c581;
#line 1
category c582;
#line 1
category c583;
#line 1
category c584;
#line 1
category c585;
#line 1
category c586;
#line 1
category c587;
#line 1
category c588;
#line 1
category c589;
#line 1
category c590;
#line 1
category c591;
#line 1
category c592;
#line 1
category c593;
#line 1
category c594;
#line 1
category c595;
#line 1
category c596;
#line 1
category c597;
#line 1
category c598;
#line 1
category c599;
#line 1
category c600;
#line 1
category c601;
#line 1
category c602;
#line 1
category c603;
#line 1
category c604;
#line 1
category c605;
#line 1
category c606;
#line 1
category c607;
#line 1
category c608;
#line 1
category c609;
#line 1
category c610;
#line 1
category c611;
#line 1
category c612;
#line 1
category c613;
#line 1
category c614;
#line 1
category c615;
#line 1
category c616;
#line 1
category c617;
#line 1
category c618;
#line 1
category c619;
#line 1
category c620;
#line 1
category c621;
#line 1
category c622;
#line 1
category c623;
#line 1
category c624;
#line 1
category c625;
#line 1
category c626;
#line 1
category c627;
#line 1
category c628;
#line 1
category c629;
#line 1
category c630;
#line 1
category c631;
#line 1
category c632;
#line 1
category c633;
#line 1
category c634;
#line 1
category c635;
#line 1
category c636;
#line 1
category c637;
#line 1
category c638;
#line 1
category c639;
#line 1
category c640;
#line 1
category c641;
#line 1
category c642;
#line 1
category c643;
#line 1
category c644;
#line 1
category c645;
#line 1
category c646;
#line 1
category c647;
#line 1
category c648;
#line 1
category c649;
#line 1
category c650;
#line 1
category c651;
#line 1
category c652;
#line 1
category c653;
#line 1
category c654;
#line 1
category c655;
#line 1
category c656;
#line 1
category c657;
#line 1
category c658;
#line 1
category c659;
#line 1
category c660;
#line 1
category c661;
#line 1
category c662;
#line 1
category c663;
#line 1
category c664;
#line 1
category c665;
#line 1
category c666;
#line 1
category c667;
#line 1
category c668;
#line 1
category c669;
#line 1
category c670;
#line 1
category c671;
#line 1
category c672;
#line 1
category c673;
#line 1
category c674;
#line 1
category c675;
#line 1
category c676;
#line 1
category c677;
#line 1
category c678;
#line 1
category c679;
#line 1
category c680;
#line 1
category c681;
#line 1
category c682;
#line 1
category c683;
#line 1
category c684;
#line 1
category c685;
#line 1
category c686;
#line 1
category c687;
#line 1
category c688;
#line 1
category c689;
#line 1
category c690;
#line 1
category c691;
#line 1
category c692;
#line 1
category c693;
#line 1
category c694;
#line 1
category c695;
#line 1
category c696;
#line 1
category c697;
#line 1
category c698;
#line 1
category c699;
#line 1
category c700;
#line 1
category c701;
#line 1
category c702;
#line 1
category c703;
#line 1
category c704;
#line 1
category c705;
#line 1
category c706;
#line 1
category c707;
#line 1
category c708;
#line 1
category c709;
#line 1
category c710;
#line 1
category c711;
#line 1
category c712;
#line 1
category c713;
#line 1
category c714;
#line 1
category c715;
#line 1
category c716;
#line 1
category c717;
#line 1
category c718;
#line 1
category c719;
#line 1
category c720;
#line 1
category c721;
#line 1
category c722;
#line 1
category c723;
#line 1
category c724;
#line 1
category c725;
#line 1
category c726;
#line 1
category c727;
#line 1
category c728;
#line 1
category c729;
#line 1
category c730;
#line 1
category c731;
#line 1
category c732;
#line 1
category c733;
#line 1
category c734;
#line 1
category c735;
#line 1
category c736;
#line 1
category c737;
#line 1
category c738;
#line 1
category c739;
#line 1
category c740;
#line 1
category c741;
#line 1
category c742;
#line 1
category c743;
#line 1
category c744;
#line 1
category c745;
#line 1
category c746;
#line 1
category c747;
#line 1
category c748;
#line 1
category c749;
#line 1
category c750;
#line 1
category c751;
#line 1
category c752;
#line 1
category c753;
#line 1
category c754;
#line 1
category c755;
#line 1
category c756;
#line 1
category c757;
#line 1
category c758;
#line 1
category c759;
#line 1
category c760;
#line 1
category c761;
#line 1
category c762;
#line 1
category c763;
#line 1
category c764;
#line 1
category c765;
#line 1
category c766;
#line 1
category c767;
#line 1
category c768;
#line 1
category c769;
#line 1
category c770;
#line 1
category c771;
#line 1
category c772;
#line 1
category c773;
#line 1
category c774;
#line 1
category c775;
#line 1
category c776;
#line 1
category c777;
#line 1
category c778;
#line 1
category c779;
#line 1
category c780;
#line 1
category c781;
#line 1
category c782;
#line 1
category c783;
#line 1
category c784;
#line 1
category c785;
#line 1
category c786;
#line 1
category c787;
#line 1
category c788;
#line 1
category c789;
#line 1
category c790;
#line 1
category c791;
#line 1
category c792;
#line 1
category c793;
#line 1
category c794;
#line 1
category c795;
#line 1
category c796;
#line 1
category c797;
#line 1
category c798;
#line 1
category c799;
#line 1
category c800;
#line 1
category c801;
#line 1
category c802;
#line 1
category c803;
#line 1
category c804;
#line 1
category c805;
#line 1
category c806;
#line 1
category c807;
#line 1
category c808;
#line 1
category c809;
#line 1
category c810;
#line 1
category c811;
#line 1
category c812;
#line 1
category c813;
#line 1
category c814;
#line 1
category c815;
#line 1
category c816;
#line 1
category c817;
#line 1
category c818;
#line 1
category c819;
#line 1
category c820;
#line 1
category c821;
#line 1
category c822;
#line 1
category c823;
#line 1
category c824;
#line 1
category c825;
#line 1
category c826;
#line 1
category c827;
#line 1
category c828;
#line 1
category c829;
#line 1
category c830;
#line 1
category c831;
#line 1
category c832;
#line 1
category c833;
#line 1
category c834;
#line 1
category c835;
#line 1
category c836;
#line 1
category c837;
#line 1
category c838;
#line 1
category c839;
#line 1
category c840;
#line 1
category c841;
#line 1
category c842;
#line 1
category c843;
#line 1
category c844;
#line 1
category c845;
#line 1
category c846;
#line 1
category c847;
#line 1
category c848;
#line 1
category c849;
#line 1
category c850;
#line 1
category c851;
#line 1
category c852;
#line 1
category c853;
#line 1
category c854;
#line 1
category c855;
#line 1
category c856;
#line 1
category c857;
#line 1
category c858;
#line 1
category c859;
#line 1
category c860;
#line 1
category c861;
#line 1
category c862;
#line 1
category c863;
#line 1
category c864;
#line 1
category c865;
#line 1
category c866;
#line 1
category c867;
#line 1
category c868;
#line 1
category c869;
#line 1
category c870;
#line 1
category c871;
#line 1
category c872;
#line 1
category c873;
#line 1
category c874;
#line 1
category c875;
#line 1
category c876;
#line 1
category c877;
#line 1
category c878;
#line 1
category c879;
#line 1
category c880;
#line 1
category c881;
#line 1
category c882;
#line 1
category c883;
#line 1
category c884;
#line 1
category c885;
#line 1
category c886;
#line 1
category c887;
#line 1
category c888;
#line 1
category c889;
#line 1
category c890;
#line 1
category c891;
#line 1
category c892;
#line 1
category c893;
#line 1
category c894;
#line 1
category c895;
#line 1
category c896;
#line 1
category c897;
#line 1
category c898;
#line 1
category c899;
#line 1
category c900;
#line 1
category c901;
#line 1
category c902;
#line 1
category c903;
#line 1
category c904;
#line 1
category c905;
#line 1
category c906;
#line 1
category c907;
#line 1
category c908;
#line 1
category c909;
#line 1
category c910;
#line 1
category c911;
#line 1
category c912;
#line 1
category c913;
#line 1
category c914;
#line 1
category c915;
#line 1
category c916;
#line 1
category c917;
#line 1
category c918;
#line 1
category c919;
#line 1
category c920;
#line 1
category c921;
#line 1
category c922;
#line 1
category c923;
#line 1
category c924;
#line 1
category c925;
#line 1
category c926;
#line 1
category c927;
#line 1
category c928;
#line 1
category c929;
#line 1
category c930;
#line 1
category c931;
#line 1
category c932;
#line 1
category c933;
#line 1
category c934;
#line 1
category c935;
#line 1
category c936;
#line 1
category c937;
#line 1
category c938;
#line 1
category c939;
#line 1
category c940;
#line 1
category c941;
#line 1
category c942;
#line 1
category c943;
#line 1
category c944;
#line 1
category c945;
#line 1
category c946;
#line 1
category c947;
#line 1
category c948;
#line 1
category c949;
#line 1
category c950;
#line 1
category c951;
#line 1
category c952;
#line 1
category c953;
#line 1
category c954;
#line 1
category c955;
#line 1
category c956;
#line 1
category c957;
#line 1
category c958;
#line 1
category c959;
#line 1
category c960;
#line 1
category c961;
#line 1
category c962;
#line 1
category c963;
#line 1
category c964;
#line 1
category c965;
#line 1
category c966;
#line 1
category c967;
#line 1
category c968;
#line 1
category c969;
#line 1
category c970;
#line 1
category c971;
#line 1
category c972;
#line 1
category c973;
#line 1
category c974;
#line 1
category c975;
#line 1
category c976;
#line 1
category c977;
#line 1
category c978;
#line 1
category c979;
#line 1
category c980;
#line 1
category c981;
#line 1
category c982;
#line 1
category c983;
#line 1
category c984;
#line 1
category c985;
#line 1
category c986;
#line 1
category c987;
#line 1
category c988;
#line 1
category c989;
#line 1
category c990;
#line 1
category c991;
#line 1
category c992;
#line 1
category c993;
#line 1
category c994;
#line 1
category c995;
#line 1
category c996;
#line 1
category c997;
#line 1
category c998;
#line 1
category c999;
#line 1
category c1000;
#line 1
category c1001;
#line 1
category c1002;
#line 1
category c1003;
#line 1
category c1004;
#line 1
category c1005;
#line 1
category c1006;
#line 1
category c1007;
#line 1
category c1008;
#line 1
category c1009;
#line 1
category c1010;
#line 1
category c1011;
#line 1
category c1012;
#line 1
category c1013;
#line 1
category c1014;
#line 1
category c1015;
#line 1
category c1016;
#line 1
category c1017;
#line 1
category c1018;
#line 1
category c1019;
#line 1
category c1020;
#line 1
category c1021;
#line 1
category c1022;
#line 1
category c1023;
#line 1

#line 1
			
#line 1

#line 1
			
#line 1
		}
#line 1
	
#line 1


########################################
#
# Declarations
#

type amazon_ssm_agent_t;
type amazon_ssm_agent_exec_t;
 	 	
#line 10
##### begin init_daemon_domain(amazon_ssm_agent_t,amazon_ssm_agent_exec_t) depth: 1
#line 10
 	
#line 10
	
#line 10
	
#line 10
		require {
#line 10
			
#line 10
		attribute direct_run_init, direct_init, direct_init_entry;
#line 10
		type init_t;
#line 10
		role system_r;
#line 10
		attribute daemon;
#line 10
		attribute initrc_transition_domain;
#line 10
		attribute initrc_domain;
#line 10
	
#line 10
		} # end require
#line 10
	
#line 10

#line 10

#line 10
	typeattribute amazon_ssm_agent_t daemon;
#line 10
	typeattribute amazon_ssm_agent_exec_t direct_init_entry;
#line 10

#line 10
	 	 	
#line 10
##### begin domain_type(amazon_ssm_agent_t) depth: 2
#line 10
 	
#line 10
	# start with basic domain
#line 10
	 	 	
#line 10
##### begin domain_base_type(amazon_ssm_agent_t) depth: 3
#line 10
 	
#line 10
	
#line 10
	
#line 10
		require {
#line 10
			
#line 10
		attribute domain;
#line 10
	
#line 10
		} # end require
#line 10
	
#line 10

#line 10

#line 10
	typeattribute amazon_ssm_agent_t domain;
#line 10

#line 10
	 	
#line 10
##### end domain_base_type(amazon_ssm_agent_t) depth: 2
#line 10
 	
#line 10

#line 10
	# Only way to get corenet_unlabeled packets disabled to work
#line 10
	 	 	
#line 10
##### begin corenet_all_recvfrom_unlabeled(amazon_ssm_agent_t) depth: 3
#line 10
 	
#line 10
	
#line 10
	
#line 10
		require {
#line 10
			
#line 10
                attribute corenet_unlabeled_type;
#line 10
	
#line 10
		} # end require
#line 10
	
#line 10

#line 10
	typeattribute amazon_ssm_agent_t corenet_unlabeled_type;
#line 10

#line 10
	 	
#line 10
##### end corenet_all_recvfrom_unlabeled(amazon_ssm_agent_t) depth: 2
#line 10
 	
#line 10

#line 10
	 	
#line 10
##### end domain_type(amazon_ssm_agent_t) depth: 1
#line 10
 	
#line 10
	 	 	
#line 10
##### begin domain_entry_file(amazon_ssm_agent_t,amazon_ssm_agent_exec_t) depth: 2
#line 10
 	
#line 10
	
#line 10
	
#line 10
		require {
#line 10
			
#line 10
		attribute entry_type;
#line 10
	
#line 10
		} # end require
#line 10
	
#line 10

#line 10

#line 10
	allow amazon_ssm_agent_t amazon_ssm_agent_exec_t:file entrypoint;
#line 10
	allow amazon_ssm_agent_t amazon_ssm_agent_exec_t:file { { getattr open read execute ioctl } ioctl lock execute_no_trans };
#line 10

#line 10
	typeattribute amazon_ssm_agent_exec_t entry_type;
#line 10

#line 10
	 	 	
#line 10
##### begin corecmd_executable_file(amazon_ssm_agent_exec_t) depth: 3
#line 10
 	
#line 10
	
#line 10
	
#line 10
		require {
#line 10
			
#line 10
		attribute exec_type;
#line 10
	
#line 10
		} # end require
#line 10
	
#line 10

#line 10

#line 10
	typeattribute amazon_ssm_agent_exec_t exec_type;
#line 10

#line 10
	 	 	
#line 10
##### begin files_type(amazon_ssm_agent_exec_t) depth: 4
#line 10
 	
#line 10
	
#line 10
	
#line 10
		require {
#line 10
			
#line 10
		attribute file_type, non_security_file_type, non_auth_file_type;
#line 10
	
#line 10
		} # end require
#line 10
	
#line 10

#line 10

#line 10
	typeattribute amazon_ssm_agent_exec_t file_type, non_security_file_type, non_auth_file_type;
#line 10

#line 10
	 	
#line 10
##### end files_type(amazon_ssm_agent_exec_t) depth: 3
#line 10
 	
#line 10

#line 10
	 	
#line 10
##### end corecmd_executable_file(amazon_ssm_agent_exec_t) depth: 2
#line 10
 	
#line 10

#line 10
	 	
#line 10
##### end domain_entry_file(amazon_ssm_agent_t,amazon_ssm_agent_exec_t) depth: 1
#line 10
 	
#line 10

#line 10
	type_transition initrc_domain amazon_ssm_agent_exec_t:process amazon_ssm_agent_t;
#line 10

#line 10
	
#line 10

#line 10
	 	
#line 10
##### end init_daemon_domain(amazon_ssm_agent_t,amazon_ssm_agent_exec_t) depth: 0
#line 10
 	


type amazon_ssm_agent_log_t;
 	 	
#line 14
##### begin logging_log_file(amazon_ssm_agent_log_t) depth: 1
#line 14
 	
#line 14
	
#line 14
	
#line 14
		require {
#line 14
			
#line 14
		attribute logfile;
#line 14
	
#line 14
		} # end require
#line 14
	
#line 14

#line 14

#line 14
	 	 	
#line 14
##### begin files_type(amazon_ssm_agent_log_t) depth: 2
#line 14
 	
#line 14
	
#line 14
	
#line 14
		require {
#line 14
			
#line 14
		attribute file_type, non_security_file_type, non_auth_file_type;
#line 14
	
#line 14
		} # end require
#line 14
	
#line 14

#line 14

#line 14
	typeattribute amazon_ssm_agent_log_t file_type, non_security_file_type, non_auth_file_type;
#line 14

#line 14
	 	
#line 14
##### end files_type(amazon_ssm_agent_log_t) depth: 1
#line 14
 	
#line 14
	 	 	
#line 14
##### begin files_associate_tmp(amazon_ssm_agent_log_t) depth: 2
#line 14
 	
#line 14
	
#line 14
	
#line 14
		require {
#line 14
			
#line 14
		type tmp_t;
#line 14
	
#line 14
		} # end require
#line 14
	
#line 14

#line 14

#line 14
	allow amazon_ssm_agent_log_t tmp_t:filesystem associate;
#line 14

#line 14
	 	
#line 14
##### end files_associate_tmp(amazon_ssm_agent_log_t) depth: 1
#line 14
 	
#line 14
	 	 	
#line 14
##### begin fs_associate_tmpfs(amazon_ssm_agent_log_t) depth: 2
#line 14
 	
#line 14
	
#line 14
	
#line 14
		require {
#line 14
			
#line 14
		type tmpfs_t;
#line 14
	
#line 14
		} # end require
#line 14
	
#line 14

#line 14

#line 14
	allow amazon_ssm_agent_log_t tmpfs_t:filesystem associate;
#line 14

#line 14
	 	
#line 14
##### end fs_associate_tmpfs(amazon_ssm_agent_log_t) depth: 1
#line 14
 	
#line 14
	typeattribute amazon_ssm_agent_log_t logfile;
#line 14

#line 14
	 	
#line 14
##### end logging_log_file(amazon_ssm_agent_log_t) depth: 0
#line 14
 	

type amazon_ssm_agent_var_lib_t;
 	 	
#line 17
##### begin files_type(amazon_ssm_agent_var_lib_t) depth: 1
#line 17
 	
#line 17
	
#line 17
	
#line 17
		require {
#line 17
			
#line 17
		attribute file_type, non_security_file_type, non_auth_file_type;
#line 17
	
#line 17
		} # end require
#line 17
	
#line 17

#line 17

#line 17
	typeattribute amazon_ssm_agent_var_lib_t file_type, non_security_file_type, non_auth_file_type;
#line 17

#line 17
	 	
#line 17
##### end files_type(amazon_ssm_agent_var_lib_t) depth: 0
#line 17
 	

type amazon_ssm_agent_unit_file_t;
 	 	
#line 20
##### begin systemd_unit_file(amazon_ssm_agent_unit_file_t) depth: 1
#line 20
 	
#line 20
        
#line 20
	
#line 20
		require {
#line 20
			
#line 20
                attribute systemd_unit_file_type;
#line 20
        
#line 20
		} # end require
#line 20
	
#line 20

#line 20

#line 20
        typeattribute amazon_ssm_agent_unit_file_t systemd_unit_file_type;
#line 20
	 	 	
#line 20
##### begin files_type(amazon_ssm_agent_unit_file_t) depth: 2
#line 20
 	
#line 20
	
#line 20
	
#line 20
		require {
#line 20
			
#line 20
		attribute file_type, non_security_file_type, non_auth_file_type;
#line 20
	
#line 20
		} # end require
#line 20
	
#line 20

#line 20

#line 20
	typeattribute amazon_ssm_agent_unit_file_t file_type, non_security_file_type, non_auth_file_type;
#line 20

#line 20
	 	
#line 20
##### end files_type(amazon_ssm_agent_unit_file_t) depth: 1
#line 20
 	
#line 20

#line 20
	 	
#line 20
##### end systemd_unit_file(amazon_ssm_agent_unit_file_t) depth: 0
#line 20
 	

########################################
#
# amazon_ssm_agent local policy
#
allow amazon_ssm_agent_t self:fifo_file { open { getattr read write append ioctl lock } };
allow amazon_ssm_agent_t self:unix_stream_socket { { { create { ioctl read getattr lock write setattr append bind connect getopt setopt shutdown } } listen accept } connectto };

optional {

        require {
        type boot_t;
        type kernel_t;
        type useradd_exec_t;
        type amazon_ssm_agent_unit_file_t;
        type amazon_ssm_agent_exec_t;
        type bin_t;
        type var_run_t;
        type etc_t;
        type usr_t;
        type rpm_exec_t;
        type syslog_conf_t;
        type system_dbusd_t;
        type var_log_t;
        type var_run_t;
        type systemd_unit_file_t;
        type passwd_exec_t;
        type rpm_var_lib_t;
        class netlink_audit_socket { read write create nlmsg_relay };
        class netlink_route_socket { bind create getattr nlmsg_read read write };
        class udp_socket { connect create getattr getopt setopt read write sendto };
        class unix_stream_socket connectto;
        class tcp_socket { connect create getattr getopt setopt read write sendto bind };
        class file { open read execute unlink create relabelfrom relabelto rename setattr write execute_no_trans };
        class lnk_file { relabelfrom relabelto };
        class sock_file { create unlink write getattr};
        class dir { getattr search relabelfrom relabelto remove_name add_name create write read };
        class process { setexec execmem setrlimit setpgid setfscreate setsched };
        class capability { linux_immutable net_admin audit_write setfcap dac_override dac_read_search sys_ptrace chown fowner fsetid net_admin kill setgid setuid };
        class service { start status stop };
        class passwd passwd;
        class netlink_selinux_socket { bind create };
        class key write;

        }
        
        allow amazon_ssm_agent_t amazon_ssm_agent_var_lib_t:dir { relabelfrom relabelto };
        allow amazon_ssm_agent_t self:netlink_route_socket { bind create getattr nlmsg_read read write };
        allow amazon_ssm_agent_t self:udp_socket { connect create getattr getopt setopt read write sendto };
        allow amazon_ssm_agent_t amazon_ssm_agent_var_lib_t:sock_file { create unlink write getattr };
        allow amazon_ssm_agent_t self:tcp_socket { connect create getattr getopt setopt read write sendto bind };
        allow amazon_ssm_agent_t amazon_ssm_agent_var_lib_t:file { execute execute_no_trans };
        allow amazon_ssm_agent_t self:netlink_audit_socket { read write create nlmsg_relay  };
        allow amazon_ssm_agent_t amazon_ssm_agent_log_t:file execute;
        allow amazon_ssm_agent_t amazon_ssm_agent_log_t:lnk_file relabelfrom;
        allow amazon_ssm_agent_t var_run_t:file { create unlink };
        allow amazon_ssm_agent_t rpm_exec_t:file relabelto;
        allow amazon_ssm_agent_t self:process { setexec execmem setrlimit setpgid setfscreate setsched };
        allow amazon_ssm_agent_t self:capability { linux_immutable net_admin audit_write setfcap dac_override dac_read_search sys_ptrace chown fowner fsetid net_admin kill setgid setuid };
        allow amazon_ssm_agent_t system_dbusd_t:dir { getattr search };
        allow amazon_ssm_agent_t system_dbusd_t:file { open read };
        allow amazon_ssm_agent_t bin_t:dir relabelto;
        allow amazon_ssm_agent_t bin_t:lnk_file { relabelfrom relabelto };
        allow amazon_ssm_agent_t etc_t:file { relabelto rename setattr };
        allow amazon_ssm_agent_t etc_t:lnk_file { relabelfrom relabelto };
        allow amazon_ssm_agent_t syslog_conf_t:file relabelfrom;
        allow amazon_ssm_agent_t systemd_unit_file_t:dir { add_name remove_name write };
        allow amazon_ssm_agent_t systemd_unit_file_t:file { create open relabelfrom relabelto rename setattr write getattr unlink };
        allow amazon_ssm_agent_t usr_t:dir { relabelfrom relabelto };
        allow amazon_ssm_agent_t usr_t:file { relabelfrom relabelto };
        allow amazon_ssm_agent_t var_log_t:lnk_file relabelto;
        allow amazon_ssm_agent_t var_run_t:dir { create relabelfrom relabelto };
        allow amazon_ssm_agent_t var_run_t:lnk_file { relabelfrom relabelto };  
        allow amazon_ssm_agent_t amazon_ssm_agent_unit_file_t:service { start status };
        allow amazon_ssm_agent_t self:netlink_audit_socket write;
        allow amazon_ssm_agent_t self:passwd passwd;
        allow amazon_ssm_agent_t self:netlink_selinux_socket { bind create };
        allow amazon_ssm_agent_t self:key write;
        allow amazon_ssm_agent_t useradd_exec_t:file { execute execute_no_trans };
        allow amazon_ssm_agent_t kernel_t:dir read;
        allow amazon_ssm_agent_t amazon_ssm_agent_unit_file_t:file {open rename getattr relabelto read setattr unlink };
        allow amazon_ssm_agent_t passwd_exec_t:file execute_no_trans;
        allow amazon_ssm_agent_t amazon_ssm_agent_exec_t:file relabelto;
        allow amazon_ssm_agent_t lib_t:lnk_file { create relabelfrom relabelto rename setattr };
        allow amazon_ssm_agent_t lib_t:dir { relabelto relabelfrom };
        allow amazon_ssm_agent_t rpm_var_lib_t:dir create;
        allow amazon_ssm_agent_t amazon_ssm_agent_unit_file_t:service stop;
        allow amazon_ssm_agent_t boot_t:file { create relabelfrom };
}


#line 111
	allow amazon_ssm_agent_t amazon_ssm_agent_log_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 111
	allow amazon_ssm_agent_t amazon_ssm_agent_log_t:dir { create open getattr setattr read write link unlink rename search add_name remove_name reparent rmdir lock ioctl };
#line 111


#line 112
	allow amazon_ssm_agent_t amazon_ssm_agent_log_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 112
	allow amazon_ssm_agent_t amazon_ssm_agent_log_t:file { create open getattr setattr read write append rename link unlink ioctl lock };
#line 112


#line 113
	allow amazon_ssm_agent_t amazon_ssm_agent_log_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 113
	allow amazon_ssm_agent_t amazon_ssm_agent_log_t:lnk_file { create getattr setattr read write append rename link unlink ioctl lock };
#line 113

 	 	
#line 114
##### begin logging_log_filetrans(amazon_ssm_agent_t,amazon_ssm_agent_log_t,{ dir file lnk_file }) depth: 1
#line 114
 	
#line 114
	
#line 114
	
#line 114
		require {
#line 114
			
#line 114
		type var_log_t;
#line 114
	
#line 114
		} # end require
#line 114
	
#line 114

#line 114

#line 114
	 	 	
#line 114
##### begin files_search_var(amazon_ssm_agent_t) depth: 2
#line 114
 	
#line 114
	
#line 114
	
#line 114
		require {
#line 114
			
#line 114
		type var_t;
#line 114
	
#line 114
		} # end require
#line 114
	
#line 114

#line 114

#line 114
	allow amazon_ssm_agent_t var_t:dir { getattr search open };
#line 114

#line 114
	 	
#line 114
##### end files_search_var(amazon_ssm_agent_t) depth: 1
#line 114
 	
#line 114
	
#line 114
	allow amazon_ssm_agent_t var_log_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 114
	type_transition amazon_ssm_agent_t var_log_t:{ dir file lnk_file } amazon_ssm_agent_log_t ;
#line 114

#line 114

#line 114
	 	
#line 114
##### end logging_log_filetrans(amazon_ssm_agent_t,amazon_ssm_agent_log_t,{ dir file lnk_file }) depth: 0
#line 114
 	


#line 116
	allow amazon_ssm_agent_t amazon_ssm_agent_var_lib_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 116
	allow amazon_ssm_agent_t amazon_ssm_agent_var_lib_t:dir { create open getattr setattr read write link unlink rename search add_name remove_name reparent rmdir lock ioctl };
#line 116


#line 117
	allow amazon_ssm_agent_t amazon_ssm_agent_var_lib_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 117
	allow amazon_ssm_agent_t amazon_ssm_agent_var_lib_t:file { create open getattr setattr read write append rename link unlink ioctl lock };
#line 117


#line 118
	allow amazon_ssm_agent_t amazon_ssm_agent_var_lib_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 118
	allow amazon_ssm_agent_t amazon_ssm_agent_var_lib_t:lnk_file { create getattr setattr read write append rename link unlink ioctl lock };
#line 118

 	 	
#line 119
##### begin files_var_lib_filetrans(amazon_ssm_agent_t,amazon_ssm_agent_var_lib_t,{ dir file lnk_file }) depth: 1
#line 119
 	
#line 119
	
#line 119
	
#line 119
		require {
#line 119
			
#line 119
		type var_t, var_lib_t;
#line 119
	
#line 119
		} # end require
#line 119
	
#line 119

#line 119

#line 119
	allow amazon_ssm_agent_t var_t:dir { getattr search open };
#line 119
	
#line 119
	allow amazon_ssm_agent_t var_lib_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 119
	type_transition amazon_ssm_agent_t var_lib_t:{ dir file lnk_file } amazon_ssm_agent_var_lib_t ;
#line 119

#line 119

#line 119
	 	
#line 119
##### end files_var_lib_filetrans(amazon_ssm_agent_t,amazon_ssm_agent_var_lib_t,{ dir file lnk_file }) depth: 0
#line 119
 	

 	 	
#line 121
##### begin domain_use_interactive_fds(amazon_ssm_agent_t) depth: 1
#line 121
 	
#line 121
	
#line 121
	
#line 121
		require {
#line 121
			
#line 121
		attribute privfd;
#line 121
	
#line 121
		} # end require
#line 121
	
#line 121

#line 121

#line 121
	allow amazon_ssm_agent_t privfd:fd use;
#line 121

#line 121
	 	
#line 121
##### end domain_use_interactive_fds(amazon_ssm_agent_t) depth: 0
#line 121
 	

 	 	
#line 123
##### begin files_read_etc_files(amazon_ssm_agent_t) depth: 1
#line 123
 	
#line 123
	
#line 123
	
#line 123
		require {
#line 123
			
#line 123
		type etc_t;
#line 123
	
#line 123
		} # end require
#line 123
	
#line 123

#line 123

#line 123
	allow amazon_ssm_agent_t etc_t:dir { getattr search open read lock ioctl };
#line 123
	
#line 123
	allow amazon_ssm_agent_t etc_t:dir { getattr search open };
#line 123
	allow amazon_ssm_agent_t etc_t:file { open { getattr read ioctl lock } };
#line 123

#line 123
	
#line 123
	allow amazon_ssm_agent_t etc_t:dir { getattr search open };
#line 123
	allow amazon_ssm_agent_t etc_t:lnk_file { getattr read };
#line 123

#line 123
	 	 	
#line 123
##### begin files_read_etc_runtime_files(amazon_ssm_agent_t) depth: 2
#line 123
 	
#line 123
	
#line 123
	
#line 123
		require {
#line 123
			
#line 123
		type etc_t, etc_runtime_t;
#line 123
	
#line 123
		} # end require
#line 123
	
#line 123

#line 123

#line 123
	allow amazon_ssm_agent_t etc_t:dir { getattr search open read lock ioctl };
#line 123
	
#line 123
	allow amazon_ssm_agent_t etc_t:dir { getattr search open };
#line 123
	allow amazon_ssm_agent_t etc_runtime_t:file { open { getattr read ioctl lock } };
#line 123

#line 123
	
#line 123
	allow amazon_ssm_agent_t etc_t:dir { getattr search open };
#line 123
	allow amazon_ssm_agent_t etc_runtime_t:lnk_file { getattr read };
#line 123

#line 123

#line 123
	 	
#line 123
##### end files_read_etc_runtime_files(amazon_ssm_agent_t) depth: 1
#line 123
 	
#line 123

#line 123
	 	
#line 123
##### end files_read_etc_files(amazon_ssm_agent_t) depth: 0
#line 123
 	

 	 	
#line 125
##### begin miscfiles_read_localization(amazon_ssm_agent_t) depth: 1
#line 125
 	
#line 125
	
#line 125
	
#line 125
		require {
#line 125
			
#line 125
		type locale_t;
#line 125
	
#line 125
		} # end require
#line 125
	
#line 125

#line 125

#line 125
	 	 	
#line 125
##### begin files_read_etc_symlinks(amazon_ssm_agent_t) depth: 2
#line 125
 	
#line 125
	
#line 125
	
#line 125
		require {
#line 125
			
#line 125
		type etc_t;
#line 125
	
#line 125
		} # end require
#line 125
	
#line 125

#line 125

#line 125
	
#line 125
	allow amazon_ssm_agent_t etc_t:dir { getattr search open };
#line 125
	allow amazon_ssm_agent_t etc_t:lnk_file { getattr read };
#line 125

#line 125

#line 125
	 	
#line 125
##### end files_read_etc_symlinks(amazon_ssm_agent_t) depth: 1
#line 125
 	
#line 125
	 	 	
#line 125
##### begin files_search_usr(amazon_ssm_agent_t) depth: 2
#line 125
 	
#line 125
	
#line 125
	
#line 125
		require {
#line 125
			
#line 125
		type usr_t;
#line 125
	
#line 125
		} # end require
#line 125
	
#line 125

#line 125

#line 125
	allow amazon_ssm_agent_t usr_t:dir { getattr search open };
#line 125

#line 125
	 	
#line 125
##### end files_search_usr(amazon_ssm_agent_t) depth: 1
#line 125
 	
#line 125
	allow amazon_ssm_agent_t locale_t:dir { getattr search open read lock ioctl };
#line 125
	
#line 125
	allow amazon_ssm_agent_t locale_t:dir { getattr search open };
#line 125
	allow amazon_ssm_agent_t locale_t:file { open { getattr read ioctl lock } };
#line 125

#line 125
	
#line 125
	allow amazon_ssm_agent_t locale_t:dir { getattr search open };
#line 125
	allow amazon_ssm_agent_t locale_t:lnk_file { getattr read };
#line 125

#line 125

#line 125
	 	
#line 125
##### end miscfiles_read_localization(amazon_ssm_agent_t) depth: 0
#line 125
 	

 	 	
#line 127
##### begin auth_read_passwd(amazon_ssm_agent_t) depth: 1
#line 127
 	
#line 127
	
#line 127
	
#line 127
		require {
#line 127
			
#line 127
		type passwd_file_t;
#line 127
	
#line 127
		} # end require
#line 127
	
#line 127

#line 127

#line 127
	allow amazon_ssm_agent_t passwd_file_t:file { open { getattr read ioctl lock } };
#line 127

#line 127
	 	
#line 127
##### end auth_read_passwd(amazon_ssm_agent_t) depth: 0
#line 127
 	

 	 	
#line 129
##### begin auth_read_shadow(amazon_ssm_agent_t) depth: 1
#line 129
 	
#line 129
	 	 	
#line 129
##### begin auth_can_read_shadow_passwords(amazon_ssm_agent_t) depth: 2
#line 129
 	
#line 129
	
#line 129
	
#line 129
		require {
#line 129
			
#line 129
		attribute can_read_shadow_passwords;
#line 129
	
#line 129
		} # end require
#line 129
	
#line 129

#line 129

#line 129
	typeattribute amazon_ssm_agent_t can_read_shadow_passwords;
#line 129

#line 129
	 	
#line 129
##### end auth_can_read_shadow_passwords(amazon_ssm_agent_t) depth: 1
#line 129
 	
#line 129
	 	 	
#line 129
##### begin auth_tunable_read_shadow(amazon_ssm_agent_t) depth: 2
#line 129
 	
#line 129
	
#line 129
	
#line 129
		require {
#line 129
			
#line 129
		type shadow_t;
#line 129
	
#line 129
		} # end require
#line 129
	
#line 129

#line 129

#line 129
	 	 	
#line 129
##### begin files_list_etc(amazon_ssm_agent_t) depth: 3
#line 129
 	
#line 129
	
#line 129
	
#line 129
		require {
#line 129
			
#line 129
		type etc_t;
#line 129
	
#line 129
		} # end require
#line 129
	
#line 129

#line 129

#line 129
	allow amazon_ssm_agent_t etc_t:dir { getattr search open read lock ioctl };
#line 129

#line 129
	 	
#line 129
##### end files_list_etc(amazon_ssm_agent_t) depth: 2
#line 129
 	
#line 129
	allow amazon_ssm_agent_t shadow_t:file { open { getattr read ioctl lock } };
#line 129

#line 129
	 	
#line 129
##### end auth_tunable_read_shadow(amazon_ssm_agent_t) depth: 1
#line 129
 	
#line 129

#line 129
	 	
#line 129
##### end auth_read_shadow(amazon_ssm_agent_t) depth: 0
#line 129
 	

 	 	
#line 131
##### begin corenet_tcp_connect_http_port(amazon_ssm_agent_t) depth: 1
#line 131
 	
#line 131
	
#line 131
	
#line 131
		require {
#line 131
			
#line 131
		type http_port_t;
#line 131
	
#line 131
		} # end require
#line 131
	
#line 131

#line 131

#line 131
	allow amazon_ssm_agent_t http_port_t:tcp_socket name_connect;
#line 131

#line 131
	 	
#line 131
##### end corenet_tcp_connect_http_port(amazon_ssm_agent_t) depth: 0
#line 131
 	

 	 	
#line 133
##### begin dev_read_sysfs(amazon_ssm_agent_t) depth: 1
#line 133
 	
#line 133
	
#line 133
	
#line 133
		require {
#line 133
			
#line 133
		type sysfs_t;
#line 133
	
#line 133
		} # end require
#line 133
	
#line 133

#line 133

#line 133
	
#line 133
	allow amazon_ssm_agent_t sysfs_t:dir { getattr search open };
#line 133
	allow amazon_ssm_agent_t sysfs_t:file { open { getattr read ioctl lock } };
#line 133

#line 133
	
#line 133
	allow amazon_ssm_agent_t sysfs_t:dir { getattr search open };
#line 133
	allow amazon_ssm_agent_t sysfs_t:lnk_file { getattr read };
#line 133

#line 133

#line 133
	
#line 133
	allow amazon_ssm_agent_t sysfs_t:dir { getattr search open };
#line 133
	allow amazon_ssm_agent_t sysfs_t:dir { getattr search open read lock ioctl };
#line 133

#line 133

#line 133
	 	
#line 133
##### end dev_read_sysfs(amazon_ssm_agent_t) depth: 0
#line 133
 	

 	 	
#line 135
##### begin hostname_exec(amazon_ssm_agent_t) depth: 1
#line 135
 	
#line 135
	
#line 135
	
#line 135
		require {
#line 135
			
#line 135
		type hostname_exec_t;
#line 135
	
#line 135
		} # end require
#line 135
	
#line 135

#line 135

#line 135
	 	 	
#line 135
##### begin corecmd_search_bin(amazon_ssm_agent_t) depth: 2
#line 135
 	
#line 135
	
#line 135
	
#line 135
		require {
#line 135
			
#line 135
		type bin_t;
#line 135
	
#line 135
		} # end require
#line 135
	
#line 135

#line 135

#line 135
	 	 	
#line 135
##### begin corecmd_read_bin_symlinks(amazon_ssm_agent_t) depth: 3
#line 135
 	
#line 135
	
#line 135
	
#line 135
		require {
#line 135
			
#line 135
		type bin_t;
#line 135
	
#line 135
		} # end require
#line 135
	
#line 135

#line 135

#line 135
	
#line 135
	allow amazon_ssm_agent_t bin_t:dir { getattr search open };
#line 135
	allow amazon_ssm_agent_t bin_t:lnk_file { getattr read };
#line 135

#line 135

#line 135
	 	
#line 135
##### end corecmd_read_bin_symlinks(amazon_ssm_agent_t) depth: 2
#line 135
 	
#line 135
	
#line 135
	allow amazon_ssm_agent_t bin_t:dir { getattr search open };
#line 135
	allow amazon_ssm_agent_t bin_t:dir { getattr search open };
#line 135

#line 135

#line 135
	 	
#line 135
##### end corecmd_search_bin(amazon_ssm_agent_t) depth: 1
#line 135
 	
#line 135
	allow amazon_ssm_agent_t hostname_exec_t:file { { getattr open read execute ioctl } ioctl lock execute_no_trans };
#line 135

#line 135
	 	
#line 135
##### end hostname_exec(amazon_ssm_agent_t) depth: 0
#line 135
 	

 	 	
#line 137
##### begin kernel_read_net_sysctls(amazon_ssm_agent_t) depth: 1
#line 137
 	
#line 137
	
#line 137
	
#line 137
		require {
#line 137
			
#line 137
		type proc_t, sysctl_t, sysctl_net_t;
#line 137
	
#line 137
		} # end require
#line 137
	
#line 137

#line 137

#line 137
	
#line 137
	allow amazon_ssm_agent_t { proc_t sysctl_t sysctl_net_t }:dir { getattr search open };
#line 137
	allow amazon_ssm_agent_t sysctl_net_t:file { open { getattr read ioctl lock } };
#line 137

#line 137
	
#line 137
	allow amazon_ssm_agent_t { proc_t sysctl_t sysctl_net_t }:dir { getattr search open };
#line 137
	allow amazon_ssm_agent_t sysctl_net_t:lnk_file { getattr read };
#line 137

#line 137
	
#line 137
	allow amazon_ssm_agent_t { proc_t sysctl_t }:dir { getattr search open };
#line 137
	allow amazon_ssm_agent_t sysctl_net_t:dir { getattr search open read lock ioctl };
#line 137

#line 137

#line 137
	 	
#line 137
##### end kernel_read_net_sysctls(amazon_ssm_agent_t) depth: 0
#line 137
 	

 	 	
#line 139
##### begin kernel_search_network_sysctl(amazon_ssm_agent_t) depth: 1
#line 139
 	
#line 139
	
#line 139
	
#line 139
		require {
#line 139
			
#line 139
		type proc_t, sysctl_t, sysctl_net_t;
#line 139
	
#line 139
		} # end require
#line 139
	
#line 139

#line 139

#line 139
	
#line 139
	allow amazon_ssm_agent_t { proc_t sysctl_t }:dir { getattr search open };
#line 139
	allow amazon_ssm_agent_t sysctl_net_t:dir { getattr search open };
#line 139

#line 139

#line 139
	 	
#line 139
##### end kernel_search_network_sysctl(amazon_ssm_agent_t) depth: 0
#line 139
 	

 	 	
#line 141
##### begin miscfiles_read_generic_certs(amazon_ssm_agent_t) depth: 1
#line 141
 	
#line 141
	
#line 141
	
#line 141
		require {
#line 141
			
#line 141
		type cert_t;
#line 141
	
#line 141
		} # end require
#line 141
	
#line 141

#line 141

#line 141
	allow amazon_ssm_agent_t cert_t:dir { getattr search open read lock ioctl };
#line 141
	
#line 141
	allow amazon_ssm_agent_t cert_t:dir { getattr search open };
#line 141
	allow amazon_ssm_agent_t cert_t:file { open { getattr read ioctl lock } };
#line 141

#line 141
	
#line 141
	allow amazon_ssm_agent_t cert_t:dir { getattr search open };
#line 141
	allow amazon_ssm_agent_t cert_t:lnk_file { getattr read };
#line 141

#line 141

#line 141
	 	
#line 141
##### end miscfiles_read_generic_certs(amazon_ssm_agent_t) depth: 0
#line 141
 	

 	 	
#line 143
##### begin sysnet_read_config(amazon_ssm_agent_t) depth: 1
#line 143
 	
#line 143
	
#line 143
	
#line 143
		require {
#line 143
			
#line 143
		type net_conf_t;
#line 143
	
#line 143
		} # end require
#line 143
	
#line 143

#line 143

#line 143
	 	 	
#line 143
##### begin files_search_etc(amazon_ssm_agent_t) depth: 2
#line 143
 	
#line 143
	
#line 143
	
#line 143
		require {
#line 143
			
#line 143
		type etc_t;
#line 143
	
#line 143
		} # end require
#line 143
	
#line 143

#line 143

#line 143
	allow amazon_ssm_agent_t etc_t:dir { getattr search open };
#line 143

#line 143
	 	
#line 143
##### end files_search_etc(amazon_ssm_agent_t) depth: 1
#line 143
 	
#line 143
	allow amazon_ssm_agent_t net_conf_t:file { open { getattr read ioctl lock } };
#line 143

#line 143
	
#line 143

#line 143
	
#line 143
         	 	
#line 143
##### begin files_search_all_pids(amazon_ssm_agent_t) depth: 2
#line 143
 	
#line 143
	
#line 143
	
#line 143
		require {
#line 143
			
#line 143
		attribute pidfile;
#line 143
	
#line 143
		} # end require
#line 143
	
#line 143

#line 143

#line 143
	allow amazon_ssm_agent_t pidfile:dir { getattr search open };
#line 143

#line 143
	 	
#line 143
##### end files_search_all_pids(amazon_ssm_agent_t) depth: 1
#line 143
 	
#line 143
         	 	
#line 143
##### begin init_search_pid_dirs(amazon_ssm_agent_t) depth: 2
#line 143
 	
#line 143
    
#line 143
	
#line 143
		require {
#line 143
			
#line 143
        type init_var_run_t;
#line 143
    
#line 143
		} # end require
#line 143
	
#line 143

#line 143

#line 143
    allow amazon_ssm_agent_t init_var_run_t:dir { getattr search open };
#line 143

#line 143
	 	
#line 143
##### end init_search_pid_dirs(amazon_ssm_agent_t) depth: 1
#line 143
 	
#line 143
		allow amazon_ssm_agent_t net_conf_t:dir { getattr search open read lock ioctl };
#line 143
		allow amazon_ssm_agent_t net_conf_t:lnk_file { getattr read };
#line 143
		
#line 143
	allow amazon_ssm_agent_t net_conf_t:dir { getattr search open };
#line 143
	allow amazon_ssm_agent_t net_conf_t:file { open { getattr read ioctl lock } };
#line 143

#line 143
	
#line 143

#line 143
	 	
#line 143
##### end sysnet_read_config(amazon_ssm_agent_t) depth: 0
#line 143
 	

 	 	
#line 145
##### begin term_open_unallocated_ttys(amazon_ssm_agent_t) depth: 1
#line 145
 	
#line 145
	
#line 145
	
#line 145
		require {
#line 145
			
#line 145
		type tty_device_t;
#line 145
	
#line 145
		} # end require
#line 145
	
#line 145

#line 145

#line 145
	 	 	
#line 145
##### begin dev_list_all_dev_nodes(amazon_ssm_agent_t) depth: 2
#line 145
 	
#line 145
	
#line 145
	
#line 145
		require {
#line 145
			
#line 145
		type device_t;
#line 145
	
#line 145
		} # end require
#line 145
	
#line 145

#line 145

#line 145
	
#line 145
	allow amazon_ssm_agent_t device_t:dir { getattr search open };
#line 145
	allow amazon_ssm_agent_t device_t:dir { getattr search open read lock ioctl };
#line 145

#line 145
	
#line 145
	allow amazon_ssm_agent_t device_t:dir { getattr search open };
#line 145
	allow amazon_ssm_agent_t device_t:lnk_file { getattr read };
#line 145

#line 145

#line 145
	 	
#line 145
##### end dev_list_all_dev_nodes(amazon_ssm_agent_t) depth: 1
#line 145
 	
#line 145
	allow amazon_ssm_agent_t tty_device_t:chr_file open;
#line 145

#line 145
	 	
#line 145
##### end term_open_unallocated_ttys(amazon_ssm_agent_t) depth: 0
#line 145
 	

 	 	
#line 147
##### begin corecmd_exec_bin(amazon_ssm_agent_t) depth: 1
#line 147
 	
#line 147
	
#line 147
	
#line 147
		require {
#line 147
			
#line 147
		type bin_t;
#line 147
	
#line 147
		} # end require
#line 147
	
#line 147

#line 147

#line 147
	
#line 147
	allow amazon_ssm_agent_t bin_t:dir { getattr search open };
#line 147
	allow amazon_ssm_agent_t bin_t:lnk_file { getattr read };
#line 147

#line 147
	
#line 147
	allow amazon_ssm_agent_t bin_t:dir { getattr search open };
#line 147
	allow amazon_ssm_agent_t bin_t:dir { getattr search open read lock ioctl };
#line 147

#line 147
	allow amazon_ssm_agent_t bin_t:file { { getattr open read execute ioctl } ioctl lock execute_no_trans };
#line 147

#line 147
	
#line 147
		 	 	
#line 147
##### begin files_exec_all_base_ro_files(amazon_ssm_agent_t) depth: 2
#line 147
 	
#line 147
	
#line 147
	
#line 147
		require {
#line 147
			
#line 147
		attribute base_ro_file_type;
#line 147
	
#line 147
		} # end require
#line 147
	
#line 147

#line 147

#line 147
	allow amazon_ssm_agent_t base_ro_file_type:file { { getattr open read execute ioctl } ioctl lock execute_no_trans };
#line 147

#line 147
	 	
#line 147
##### end files_exec_all_base_ro_files(amazon_ssm_agent_t) depth: 1
#line 147
 	
#line 147
	
#line 147

#line 147
	 	
#line 147
##### end corecmd_exec_bin(amazon_ssm_agent_t) depth: 0
#line 147
 	

 	 	
#line 149
##### begin udev_read_state(amazon_ssm_agent_t) depth: 1
#line 149
 	
#line 149
	
#line 149
	
#line 149
		require {
#line 149
			
#line 149
		type udev_t;
#line 149
	
#line 149
		} # end require
#line 149
	
#line 149

#line 149

#line 149
	 	 	
#line 149
##### begin kernel_search_proc(amazon_ssm_agent_t) depth: 2
#line 149
 	
#line 149
	
#line 149
	
#line 149
		require {
#line 149
			
#line 149
		type proc_t;
#line 149
	
#line 149
		} # end require
#line 149
	
#line 149

#line 149

#line 149
	
#line 149
	allow amazon_ssm_agent_t proc_t:dir { getattr search open };
#line 149
	allow amazon_ssm_agent_t proc_t:dir { getattr search open };
#line 149

#line 149

#line 149
	 	
#line 149
##### end kernel_search_proc(amazon_ssm_agent_t) depth: 1
#line 149
 	
#line 149
	
#line 149
	allow amazon_ssm_agent_t udev_t:dir { getattr search open read lock ioctl };
#line 149
	allow amazon_ssm_agent_t udev_t:file { open { getattr read ioctl lock } };
#line 149
	allow amazon_ssm_agent_t udev_t:lnk_file { getattr read };
#line 149
	allow amazon_ssm_agent_t udev_t:process getattr;
#line 149

#line 149

#line 149
	 	
#line 149
##### end udev_read_state(amazon_ssm_agent_t) depth: 0
#line 149
 	

 	 	
#line 151
##### begin ssh_systemctl(amazon_ssm_agent_t) depth: 1
#line 151
 	
#line 151
	
#line 151
	
#line 151
		require {
#line 151
			
#line 151
		type sshd_t;
#line 151
		type sshd_unit_file_t;
#line 151
	
#line 151
		} # end require
#line 151
	
#line 151

#line 151

#line 151
	 	 	
#line 151
##### begin systemd_exec_systemctl(amazon_ssm_agent_t) depth: 2
#line 151
 	
#line 151
        
#line 151
	
#line 151
		require {
#line 151
			
#line 151
                type systemd_systemctl_exec_t;
#line 151
        
#line 151
		} # end require
#line 151
	
#line 151

#line 151

#line 151
	 	 	
#line 151
##### begin corecmd_search_bin(amazon_ssm_agent_t) depth: 3
#line 151
 	
#line 151
	
#line 151
	
#line 151
		require {
#line 151
			
#line 151
		type bin_t;
#line 151
	
#line 151
		} # end require
#line 151
	
#line 151

#line 151

#line 151
	 	 	
#line 151
##### begin corecmd_read_bin_symlinks(amazon_ssm_agent_t) depth: 4
#line 151
 	
#line 151
	
#line 151
	
#line 151
		require {
#line 151
			
#line 151
		type bin_t;
#line 151
	
#line 151
		} # end require
#line 151
	
#line 151

#line 151

#line 151
	
#line 151
	allow amazon_ssm_agent_t bin_t:dir { getattr search open };
#line 151
	allow amazon_ssm_agent_t bin_t:lnk_file { getattr read };
#line 151

#line 151

#line 151
	 	
#line 151
##### end corecmd_read_bin_symlinks(amazon_ssm_agent_t) depth: 3
#line 151
 	
#line 151
	
#line 151
	allow amazon_ssm_agent_t bin_t:dir { getattr search open };
#line 151
	allow amazon_ssm_agent_t bin_t:dir { getattr search open };
#line 151

#line 151

#line 151
	 	
#line 151
##### end corecmd_search_bin(amazon_ssm_agent_t) depth: 2
#line 151
 	
#line 151
	allow amazon_ssm_agent_t systemd_systemctl_exec_t:file { { getattr open read execute ioctl } ioctl lock execute_no_trans };
#line 151

#line 151
	 	 	
#line 151
##### begin fs_list_cgroup_dirs(amazon_ssm_agent_t) depth: 3
#line 151
 	
#line 151
	
#line 151
	
#line 151
		require {
#line 151
			
#line 151
		type cgroup_t;
#line 151
	
#line 151
		} # end require
#line 151
	
#line 151

#line 151

#line 151
	
#line 151
	allow amazon_ssm_agent_t cgroup_t:dir { getattr search open };
#line 151
	allow amazon_ssm_agent_t cgroup_t:dir { getattr search open read lock ioctl };
#line 151

#line 151
	 	 	
#line 151
##### begin fs_search_tmpfs(amazon_ssm_agent_t) depth: 4
#line 151
 	
#line 151
	
#line 151
	
#line 151
		require {
#line 151
			
#line 151
		type tmpfs_t;
#line 151
	
#line 151
		} # end require
#line 151
	
#line 151

#line 151

#line 151
	allow amazon_ssm_agent_t tmpfs_t:dir { getattr search open };
#line 151

#line 151
	 	
#line 151
##### end fs_search_tmpfs(amazon_ssm_agent_t) depth: 3
#line 151
 	
#line 151
	 	 	
#line 151
##### begin dev_search_sysfs(amazon_ssm_agent_t) depth: 4
#line 151
 	
#line 151
	
#line 151
	
#line 151
		require {
#line 151
			
#line 151
		type sysfs_t;
#line 151
	
#line 151
		} # end require
#line 151
	
#line 151

#line 151

#line 151
	
#line 151
	allow amazon_ssm_agent_t sysfs_t:dir { getattr search open };
#line 151
	allow amazon_ssm_agent_t sysfs_t:dir { getattr search open };
#line 151

#line 151

#line 151
	 	
#line 151
##### end dev_search_sysfs(amazon_ssm_agent_t) depth: 3
#line 151
 	
#line 151

#line 151
	 	
#line 151
##### end fs_list_cgroup_dirs(amazon_ssm_agent_t) depth: 2
#line 151
 	
#line 151
	 	 	
#line 151
##### begin fs_read_cgroup_files(amazon_ssm_agent_t) depth: 3
#line 151
 	
#line 151
	
#line 151
	
#line 151
		require {
#line 151
			
#line 151
		type cgroup_t;
#line 151

#line 151
	
#line 151
		} # end require
#line 151
	
#line 151

#line 151

#line 151
	
#line 151
	allow amazon_ssm_agent_t cgroup_t:dir { getattr search open };
#line 151
	allow amazon_ssm_agent_t cgroup_t:file { open { getattr read ioctl lock } };
#line 151

#line 151
	
#line 151
	allow amazon_ssm_agent_t cgroup_t:dir { getattr search open };
#line 151
	allow amazon_ssm_agent_t cgroup_t:lnk_file { getattr read };
#line 151

#line 151
	 	 	
#line 151
##### begin fs_search_tmpfs(amazon_ssm_agent_t) depth: 4
#line 151
 	
#line 151
	
#line 151
	
#line 151
		require {
#line 151
			
#line 151
		type tmpfs_t;
#line 151
	
#line 151
		} # end require
#line 151
	
#line 151

#line 151

#line 151
	allow amazon_ssm_agent_t tmpfs_t:dir { getattr search open };
#line 151

#line 151
	 	
#line 151
##### end fs_search_tmpfs(amazon_ssm_agent_t) depth: 3
#line 151
 	
#line 151
	 	 	
#line 151
##### begin dev_search_sysfs(amazon_ssm_agent_t) depth: 4
#line 151
 	
#line 151
	
#line 151
	
#line 151
		require {
#line 151
			
#line 151
		type sysfs_t;
#line 151
	
#line 151
		} # end require
#line 151
	
#line 151

#line 151

#line 151
	
#line 151
	allow amazon_ssm_agent_t sysfs_t:dir { getattr search open };
#line 151
	allow amazon_ssm_agent_t sysfs_t:dir { getattr search open };
#line 151

#line 151

#line 151
	 	
#line 151
##### end dev_search_sysfs(amazon_ssm_agent_t) depth: 3
#line 151
 	
#line 151

#line 151
	 	
#line 151
##### end fs_read_cgroup_files(amazon_ssm_agent_t) depth: 2
#line 151
 	
#line 151
	 	 	
#line 151
##### begin systemd_list_unit_dirs(amazon_ssm_agent_t) depth: 3
#line 151
 	
#line 151
        
#line 151
	
#line 151
		require {
#line 151
			
#line 151
                attribute systemd_unit_file_type;
#line 151
        
#line 151
		} # end require
#line 151
	
#line 151

#line 151
	
#line 151
	 	 	
#line 151
##### begin files_search_var_lib(amazon_ssm_agent_t) depth: 4
#line 151
 	
#line 151
	
#line 151
	
#line 151
		require {
#line 151
			
#line 151
		type var_t, var_lib_t;
#line 151
	
#line 151
		} # end require
#line 151
	
#line 151

#line 151

#line 151
	
#line 151
	allow amazon_ssm_agent_t var_t:dir { getattr search open };
#line 151
	allow amazon_ssm_agent_t var_lib_t:dir { getattr search open };
#line 151

#line 151

#line 151
	 	
#line 151
##### end files_search_var_lib(amazon_ssm_agent_t) depth: 3
#line 151
 	
#line 151
	allow amazon_ssm_agent_t systemd_unit_file_type:dir { getattr search open read lock ioctl };
#line 151

#line 151
	 	
#line 151
##### end systemd_list_unit_dirs(amazon_ssm_agent_t) depth: 2
#line 151
 	
#line 151
	 	 	
#line 151
##### begin init_list_pid_dirs(amazon_ssm_agent_t) depth: 3
#line 151
 	
#line 151
    
#line 151
	
#line 151
		require {
#line 151
			
#line 151
        type init_var_run_t;
#line 151
    
#line 151
		} # end require
#line 151
	
#line 151

#line 151

#line 151
    allow amazon_ssm_agent_t init_var_run_t:dir { getattr search open read lock ioctl };
#line 151

#line 151
	 	
#line 151
##### end init_list_pid_dirs(amazon_ssm_agent_t) depth: 2
#line 151
 	
#line 151
	 	 	
#line 151
##### begin init_read_state(amazon_ssm_agent_t) depth: 3
#line 151
 	
#line 151
	
#line 151
	
#line 151
		require {
#line 151
			
#line 151
		type init_t;
#line 151
	
#line 151
		} # end require
#line 151
	
#line 151

#line 151

#line 151
	allow amazon_ssm_agent_t init_t:dir { getattr search open };
#line 151
	allow amazon_ssm_agent_t init_t:file { open { getattr read ioctl lock } };
#line 151
	allow amazon_ssm_agent_t init_t:lnk_file { getattr read };
#line 151

#line 151
	 	
#line 151
##### end init_read_state(amazon_ssm_agent_t) depth: 2
#line 151
 	
#line 151
	 	 	
#line 151
##### begin init_stream_send(amazon_ssm_agent_t) depth: 3
#line 151
 	
#line 151
	
#line 151
	
#line 151
		require {
#line 151
			
#line 151
		type init_t;
#line 151
	
#line 151
		} # end require
#line 151
	
#line 151

#line 151

#line 151
	allow amazon_ssm_agent_t init_t:unix_stream_socket sendto;
#line 151

#line 151
	 	
#line 151
##### end init_stream_send(amazon_ssm_agent_t) depth: 2
#line 151
 	
#line 151
	 	 	
#line 151
##### begin init_stream_connect(amazon_ssm_agent_t) depth: 3
#line 151
 	
#line 151
	
#line 151
	
#line 151
		require {
#line 151
			
#line 151
		type init_t, init_var_run_t;
#line 151
	
#line 151
		} # end require
#line 151
	
#line 151

#line 151

#line 151
	 	 	
#line 151
##### begin files_search_pids(amazon_ssm_agent_t) depth: 4
#line 151
 	
#line 151
	
#line 151
	
#line 151
		require {
#line 151
			
#line 151
		type var_t, var_run_t;
#line 151
	
#line 151
		} # end require
#line 151
	
#line 151

#line 151

#line 151
	allow amazon_ssm_agent_t var_t:lnk_file { getattr read };
#line 151
	allow amazon_ssm_agent_t var_run_t:lnk_file { getattr read };
#line 151
	
#line 151
	allow amazon_ssm_agent_t var_t:dir { getattr search open };
#line 151
	allow amazon_ssm_agent_t var_run_t:dir { getattr search open };
#line 151

#line 151

#line 151
	 	
#line 151
##### end files_search_pids(amazon_ssm_agent_t) depth: 3
#line 151
 	
#line 151
	
#line 151
	allow amazon_ssm_agent_t init_var_run_t:dir { getattr search open };
#line 151
	allow amazon_ssm_agent_t init_var_run_t:sock_file { getattr write open append };
#line 151
	allow amazon_ssm_agent_t init_t:unix_stream_socket connectto;
#line 151
    
#line 151
	allow amazon_ssm_agent_t init_t:unix_stream_socket getattr;
#line 151

#line 151
	 	
#line 151
##### end init_stream_connect(amazon_ssm_agent_t) depth: 2
#line 151
 	
#line 151

#line 151
	 	 	
#line 151
##### begin systemd_login_list_pid_dirs(amazon_ssm_agent_t) depth: 3
#line 151
 	
#line 151
	
#line 151
	
#line 151
		require {
#line 151
			
#line 151
		type systemd_logind_var_run_t;
#line 151
	
#line 151
		} # end require
#line 151
	
#line 151

#line 151

#line 151
	 	 	
#line 151
##### begin files_search_pids(amazon_ssm_agent_t) depth: 4
#line 151
 	
#line 151
	
#line 151
	
#line 151
		require {
#line 151
			
#line 151
		type var_t, var_run_t;
#line 151
	
#line 151
		} # end require
#line 151
	
#line 151

#line 151

#line 151
	allow amazon_ssm_agent_t var_t:lnk_file { getattr read };
#line 151
	allow amazon_ssm_agent_t var_run_t:lnk_file { getattr read };
#line 151
	
#line 151
	allow amazon_ssm_agent_t var_t:dir { getattr search open };
#line 151
	allow amazon_ssm_agent_t var_run_t:dir { getattr search open };
#line 151

#line 151

#line 151
	 	
#line 151
##### end files_search_pids(amazon_ssm_agent_t) depth: 3
#line 151
 	
#line 151
	
#line 151
	allow amazon_ssm_agent_t systemd_logind_var_run_t:dir { getattr search open };
#line 151
	allow amazon_ssm_agent_t systemd_logind_var_run_t:dir { getattr search open read lock ioctl };
#line 151

#line 151

#line 151
	 	
#line 151
##### end systemd_login_list_pid_dirs(amazon_ssm_agent_t) depth: 2
#line 151
 	
#line 151
	 	 	
#line 151
##### begin systemd_login_read_pid_files(amazon_ssm_agent_t) depth: 3
#line 151
 	
#line 151
	
#line 151
	
#line 151
		require {
#line 151
			
#line 151
		type systemd_logind_var_run_t;
#line 151
	
#line 151
		} # end require
#line 151
	
#line 151

#line 151

#line 151
	 	 	
#line 151
##### begin files_search_pids(amazon_ssm_agent_t) depth: 4
#line 151
 	
#line 151
	
#line 151
	
#line 151
		require {
#line 151
			
#line 151
		type var_t, var_run_t;
#line 151
	
#line 151
		} # end require
#line 151
	
#line 151

#line 151

#line 151
	allow amazon_ssm_agent_t var_t:lnk_file { getattr read };
#line 151
	allow amazon_ssm_agent_t var_run_t:lnk_file { getattr read };
#line 151
	
#line 151
	allow amazon_ssm_agent_t var_t:dir { getattr search open };
#line 151
	allow amazon_ssm_agent_t var_run_t:dir { getattr search open };
#line 151

#line 151

#line 151
	 	
#line 151
##### end files_search_pids(amazon_ssm_agent_t) depth: 3
#line 151
 	
#line 151
	
#line 151
	allow amazon_ssm_agent_t systemd_logind_var_run_t:dir { getattr search open };
#line 151
	allow amazon_ssm_agent_t systemd_logind_var_run_t:file { open { getattr read ioctl lock } };
#line 151

#line 151

#line 151
	 	
#line 151
##### end systemd_login_read_pid_files(amazon_ssm_agent_t) depth: 2
#line 151
 	
#line 151
	 	 	
#line 151
##### begin systemd_passwd_agent_exec(amazon_ssm_agent_t) depth: 3
#line 151
 	
#line 151
	
#line 151
	
#line 151
		require {
#line 151
			
#line 151
		type systemd_passwd_agent_t, systemd_passwd_agent_exec_t;
#line 151
	
#line 151
		} # end require
#line 151
	
#line 151

#line 151

#line 151
	allow amazon_ssm_agent_t systemd_passwd_agent_exec_t:file { { getattr open read execute ioctl } ioctl lock execute_no_trans };
#line 151
	 	 	
#line 151
##### begin systemd_manage_passwd_run(amazon_ssm_agent_t) depth: 4
#line 151
 	
#line 151
	
#line 151
	
#line 151
		require {
#line 151
			
#line 151
		type systemd_passwd_agent_t;	
#line 151
		type systemd_passwd_var_run_t;
#line 151
	
#line 151
		} # end require
#line 151
	
#line 151

#line 151

#line 151
	 	 	
#line 151
##### begin init_search_pid_dirs(amazon_ssm_agent_t) depth: 5
#line 151
 	
#line 151
    
#line 151
	
#line 151
		require {
#line 151
			
#line 151
        type init_var_run_t;
#line 151
    
#line 151
		} # end require
#line 151
	
#line 151

#line 151

#line 151
    allow amazon_ssm_agent_t init_var_run_t:dir { getattr search open };
#line 151

#line 151
	 	
#line 151
##### end init_search_pid_dirs(amazon_ssm_agent_t) depth: 4
#line 151
 	
#line 151
	
#line 151
	allow amazon_ssm_agent_t systemd_passwd_var_run_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 151
	allow amazon_ssm_agent_t systemd_passwd_var_run_t:file { create open getattr setattr read write append rename link unlink ioctl lock };
#line 151

#line 151
	
#line 151
	allow amazon_ssm_agent_t systemd_passwd_var_run_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 151
	allow amazon_ssm_agent_t systemd_passwd_var_run_t:sock_file { create open getattr setattr read write rename link unlink ioctl lock append };
#line 151

#line 151
	
#line 151
	allow amazon_ssm_agent_t systemd_passwd_var_run_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 151
	allow amazon_ssm_agent_t systemd_passwd_var_run_t:fifo_file { create open getattr setattr read write append rename link unlink ioctl lock };
#line 151

#line 151

#line 151
	allow systemd_passwd_agent_t amazon_ssm_agent_t:process signull;
#line 151
	allow systemd_passwd_agent_t amazon_ssm_agent_t:unix_dgram_socket sendto;
#line 151

#line 151
	 	
#line 151
##### end systemd_manage_passwd_run(amazon_ssm_agent_t) depth: 3
#line 151
 	
#line 151

#line 151
	 	
#line 151
##### end systemd_passwd_agent_exec(amazon_ssm_agent_t) depth: 2
#line 151
 	
#line 151

#line 151
	dontaudit amazon_ssm_agent_t self:capability net_admin;
#line 151

#line 151
	 	
#line 151
##### end systemd_exec_systemctl(amazon_ssm_agent_t) depth: 1
#line 151
 	
#line 151
     	 	
#line 151
##### begin init_reload_services(amazon_ssm_agent_t) depth: 2
#line 151
 	
#line 151
	
#line 151
	
#line 151
		require {
#line 151
			
#line 151
		type init_t;
#line 151
	
#line 151
		} # end require
#line 151
	
#line 151

#line 151

#line 151
	allow amazon_ssm_agent_t init_t:system reload;
#line 151

#line 151
	 	
#line 151
##### end init_reload_services(amazon_ssm_agent_t) depth: 1
#line 151
 	
#line 151
	allow amazon_ssm_agent_t sshd_unit_file_t:file { create open getattr setattr read write append rename link unlink ioctl lock };
#line 151
	allow amazon_ssm_agent_t sshd_unit_file_t:service { start stop status reload enable disable } ;
#line 151

#line 151
	
#line 151
	allow amazon_ssm_agent_t sshd_t:dir { getattr search open read lock ioctl };
#line 151
	allow amazon_ssm_agent_t sshd_t:file { open { getattr read ioctl lock } };
#line 151
	allow amazon_ssm_agent_t sshd_t:lnk_file { getattr read };
#line 151
	allow amazon_ssm_agent_t sshd_t:process getattr;
#line 151

#line 151

#line 151
	 	
#line 151
##### end ssh_systemctl(amazon_ssm_agent_t) depth: 0
#line 151
 	

 	 	
#line 153
##### begin lvm_read_state(amazon_ssm_agent_t) depth: 1
#line 153
 	
#line 153
	
#line 153
	
#line 153
		require {
#line 153
			
#line 153
		type lvm_t;
#line 153
	
#line 153
		} # end require
#line 153
	
#line 153

#line 153

#line 153
	
#line 153
	allow amazon_ssm_agent_t lvm_t:dir { getattr search open read lock ioctl };
#line 153
	allow amazon_ssm_agent_t lvm_t:file { open { getattr read ioctl lock } };
#line 153
	allow amazon_ssm_agent_t lvm_t:lnk_file { getattr read };
#line 153
	allow amazon_ssm_agent_t lvm_t:process getattr;
#line 153

#line 153

#line 153
	 	
#line 153
##### end lvm_read_state(amazon_ssm_agent_t) depth: 0
#line 153
 	

 	 	
#line 155
##### begin lsmd_systemctl(amazon_ssm_agent_t) depth: 1
#line 155
 	
#line 155
	
#line 155
	
#line 155
		require {
#line 155
			
#line 155
		type lsmd_t;
#line 155
		type lsmd_unit_file_t;
#line 155
	
#line 155
		} # end require
#line 155
	
#line 155

#line 155

#line 155
	 	 	
#line 155
##### begin systemd_exec_systemctl(amazon_ssm_agent_t) depth: 2
#line 155
 	
#line 155
        
#line 155
	
#line 155
		require {
#line 155
			
#line 155
                type systemd_systemctl_exec_t;
#line 155
        
#line 155
		} # end require
#line 155
	
#line 155

#line 155

#line 155
	 	 	
#line 155
##### begin corecmd_search_bin(amazon_ssm_agent_t) depth: 3
#line 155
 	
#line 155
	
#line 155
	
#line 155
		require {
#line 155
			
#line 155
		type bin_t;
#line 155
	
#line 155
		} # end require
#line 155
	
#line 155

#line 155

#line 155
	 	 	
#line 155
##### begin corecmd_read_bin_symlinks(amazon_ssm_agent_t) depth: 4
#line 155
 	
#line 155
	
#line 155
	
#line 155
		require {
#line 155
			
#line 155
		type bin_t;
#line 155
	
#line 155
		} # end require
#line 155
	
#line 155

#line 155

#line 155
	
#line 155
	allow amazon_ssm_agent_t bin_t:dir { getattr search open };
#line 155
	allow amazon_ssm_agent_t bin_t:lnk_file { getattr read };
#line 155

#line 155

#line 155
	 	
#line 155
##### end corecmd_read_bin_symlinks(amazon_ssm_agent_t) depth: 3
#line 155
 	
#line 155
	
#line 155
	allow amazon_ssm_agent_t bin_t:dir { getattr search open };
#line 155
	allow amazon_ssm_agent_t bin_t:dir { getattr search open };
#line 155

#line 155

#line 155
	 	
#line 155
##### end corecmd_search_bin(amazon_ssm_agent_t) depth: 2
#line 155
 	
#line 155
	allow amazon_ssm_agent_t systemd_systemctl_exec_t:file { { getattr open read execute ioctl } ioctl lock execute_no_trans };
#line 155

#line 155
	 	 	
#line 155
##### begin fs_list_cgroup_dirs(amazon_ssm_agent_t) depth: 3
#line 155
 	
#line 155
	
#line 155
	
#line 155
		require {
#line 155
			
#line 155
		type cgroup_t;
#line 155
	
#line 155
		} # end require
#line 155
	
#line 155

#line 155

#line 155
	
#line 155
	allow amazon_ssm_agent_t cgroup_t:dir { getattr search open };
#line 155
	allow amazon_ssm_agent_t cgroup_t:dir { getattr search open read lock ioctl };
#line 155

#line 155
	 	 	
#line 155
##### begin fs_search_tmpfs(amazon_ssm_agent_t) depth: 4
#line 155
 	
#line 155
	
#line 155
	
#line 155
		require {
#line 155
			
#line 155
		type tmpfs_t;
#line 155
	
#line 155
		} # end require
#line 155
	
#line 155

#line 155

#line 155
	allow amazon_ssm_agent_t tmpfs_t:dir { getattr search open };
#line 155

#line 155
	 	
#line 155
##### end fs_search_tmpfs(amazon_ssm_agent_t) depth: 3
#line 155
 	
#line 155
	 	 	
#line 155
##### begin dev_search_sysfs(amazon_ssm_agent_t) depth: 4
#line 155
 	
#line 155
	
#line 155
	
#line 155
		require {
#line 155
			
#line 155
		type sysfs_t;
#line 155
	
#line 155
		} # end require
#line 155
	
#line 155

#line 155

#line 155
	
#line 155
	allow amazon_ssm_agent_t sysfs_t:dir { getattr search open };
#line 155
	allow amazon_ssm_agent_t sysfs_t:dir { getattr search open };
#line 155

#line 155

#line 155
	 	
#line 155
##### end dev_search_sysfs(amazon_ssm_agent_t) depth: 3
#line 155
 	
#line 155

#line 155
	 	
#line 155
##### end fs_list_cgroup_dirs(amazon_ssm_agent_t) depth: 2
#line 155
 	
#line 155
	 	 	
#line 155
##### begin fs_read_cgroup_files(amazon_ssm_agent_t) depth: 3
#line 155
 	
#line 155
	
#line 155
	
#line 155
		require {
#line 155
			
#line 155
		type cgroup_t;
#line 155

#line 155
	
#line 155
		} # end require
#line 155
	
#line 155

#line 155

#line 155
	
#line 155
	allow amazon_ssm_agent_t cgroup_t:dir { getattr search open };
#line 155
	allow amazon_ssm_agent_t cgroup_t:file { open { getattr read ioctl lock } };
#line 155

#line 155
	
#line 155
	allow amazon_ssm_agent_t cgroup_t:dir { getattr search open };
#line 155
	allow amazon_ssm_agent_t cgroup_t:lnk_file { getattr read };
#line 155

#line 155
	 	 	
#line 155
##### begin fs_search_tmpfs(amazon_ssm_agent_t) depth: 4
#line 155
 	
#line 155
	
#line 155
	
#line 155
		require {
#line 155
			
#line 155
		type tmpfs_t;
#line 155
	
#line 155
		} # end require
#line 155
	
#line 155

#line 155

#line 155
	allow amazon_ssm_agent_t tmpfs_t:dir { getattr search open };
#line 155

#line 155
	 	
#line 155
##### end fs_search_tmpfs(amazon_ssm_agent_t) depth: 3
#line 155
 	
#line 155
	 	 	
#line 155
##### begin dev_search_sysfs(amazon_ssm_agent_t) depth: 4
#line 155
 	
#line 155
	
#line 155
	
#line 155
		require {
#line 155
			
#line 155
		type sysfs_t;
#line 155
	
#line 155
		} # end require
#line 155
	
#line 155

#line 155

#line 155
	
#line 155
	allow amazon_ssm_agent_t sysfs_t:dir { getattr search open };
#line 155
	allow amazon_ssm_agent_t sysfs_t:dir { getattr search open };
#line 155

#line 155

#line 155
	 	
#line 155
##### end dev_search_sysfs(amazon_ssm_agent_t) depth: 3
#line 155
 	
#line 155

#line 155
	 	
#line 155
##### end fs_read_cgroup_files(amazon_ssm_agent_t) depth: 2
#line 155
 	
#line 155
	 	 	
#line 155
##### begin systemd_list_unit_dirs(amazon_ssm_agent_t) depth: 3
#line 155
 	
#line 155
        
#line 155
	
#line 155
		require {
#line 155
			
#line 155
                attribute systemd_unit_file_type;
#line 155
        
#line 155
		} # end require
#line 155
	
#line 155

#line 155
	
#line 155
	 	 	
#line 155
##### begin files_search_var_lib(amazon_ssm_agent_t) depth: 4
#line 155
 	
#line 155
	
#line 155
	
#line 155
		require {
#line 155
			
#line 155
		type var_t, var_lib_t;
#line 155
	
#line 155
		} # end require
#line 155
	
#line 155

#line 155

#line 155
	
#line 155
	allow amazon_ssm_agent_t var_t:dir { getattr search open };
#line 155
	allow amazon_ssm_agent_t var_lib_t:dir { getattr search open };
#line 155

#line 155

#line 155
	 	
#line 155
##### end files_search_var_lib(amazon_ssm_agent_t) depth: 3
#line 155
 	
#line 155
	allow amazon_ssm_agent_t systemd_unit_file_type:dir { getattr search open read lock ioctl };
#line 155

#line 155
	 	
#line 155
##### end systemd_list_unit_dirs(amazon_ssm_agent_t) depth: 2
#line 155
 	
#line 155
	 	 	
#line 155
##### begin init_list_pid_dirs(amazon_ssm_agent_t) depth: 3
#line 155
 	
#line 155
    
#line 155
	
#line 155
		require {
#line 155
			
#line 155
        type init_var_run_t;
#line 155
    
#line 155
		} # end require
#line 155
	
#line 155

#line 155

#line 155
    allow amazon_ssm_agent_t init_var_run_t:dir { getattr search open read lock ioctl };
#line 155

#line 155
	 	
#line 155
##### end init_list_pid_dirs(amazon_ssm_agent_t) depth: 2
#line 155
 	
#line 155
	 	 	
#line 155
##### begin init_read_state(amazon_ssm_agent_t) depth: 3
#line 155
 	
#line 155
	
#line 155
	
#line 155
		require {
#line 155
			
#line 155
		type init_t;
#line 155
	
#line 155
		} # end require
#line 155
	
#line 155

#line 155

#line 155
	allow amazon_ssm_agent_t init_t:dir { getattr search open };
#line 155
	allow amazon_ssm_agent_t init_t:file { open { getattr read ioctl lock } };
#line 155
	allow amazon_ssm_agent_t init_t:lnk_file { getattr read };
#line 155

#line 155
	 	
#line 155
##### end init_read_state(amazon_ssm_agent_t) depth: 2
#line 155
 	
#line 155
	 	 	
#line 155
##### begin init_stream_send(amazon_ssm_agent_t) depth: 3
#line 155
 	
#line 155
	
#line 155
	
#line 155
		require {
#line 155
			
#line 155
		type init_t;
#line 155
	
#line 155
		} # end require
#line 155
	
#line 155

#line 155

#line 155
	allow amazon_ssm_agent_t init_t:unix_stream_socket sendto;
#line 155

#line 155
	 	
#line 155
##### end init_stream_send(amazon_ssm_agent_t) depth: 2
#line 155
 	
#line 155
	 	 	
#line 155
##### begin init_stream_connect(amazon_ssm_agent_t) depth: 3
#line 155
 	
#line 155
	
#line 155
	
#line 155
		require {
#line 155
			
#line 155
		type init_t, init_var_run_t;
#line 155
	
#line 155
		} # end require
#line 155
	
#line 155

#line 155

#line 155
	 	 	
#line 155
##### begin files_search_pids(amazon_ssm_agent_t) depth: 4
#line 155
 	
#line 155
	
#line 155
	
#line 155
		require {
#line 155
			
#line 155
		type var_t, var_run_t;
#line 155
	
#line 155
		} # end require
#line 155
	
#line 155

#line 155

#line 155
	allow amazon_ssm_agent_t var_t:lnk_file { getattr read };
#line 155
	allow amazon_ssm_agent_t var_run_t:lnk_file { getattr read };
#line 155
	
#line 155
	allow amazon_ssm_agent_t var_t:dir { getattr search open };
#line 155
	allow amazon_ssm_agent_t var_run_t:dir { getattr search open };
#line 155

#line 155

#line 155
	 	
#line 155
##### end files_search_pids(amazon_ssm_agent_t) depth: 3
#line 155
 	
#line 155
	
#line 155
	allow amazon_ssm_agent_t init_var_run_t:dir { getattr search open };
#line 155
	allow amazon_ssm_agent_t init_var_run_t:sock_file { getattr write open append };
#line 155
	allow amazon_ssm_agent_t init_t:unix_stream_socket connectto;
#line 155
    
#line 155
	allow amazon_ssm_agent_t init_t:unix_stream_socket getattr;
#line 155

#line 155
	 	
#line 155
##### end init_stream_connect(amazon_ssm_agent_t) depth: 2
#line 155
 	
#line 155

#line 155
	 	 	
#line 155
##### begin systemd_login_list_pid_dirs(amazon_ssm_agent_t) depth: 3
#line 155
 	
#line 155
	
#line 155
	
#line 155
		require {
#line 155
			
#line 155
		type systemd_logind_var_run_t;
#line 155
	
#line 155
		} # end require
#line 155
	
#line 155

#line 155

#line 155
	 	 	
#line 155
##### begin files_search_pids(amazon_ssm_agent_t) depth: 4
#line 155
 	
#line 155
	
#line 155
	
#line 155
		require {
#line 155
			
#line 155
		type var_t, var_run_t;
#line 155
	
#line 155
		} # end require
#line 155
	
#line 155

#line 155

#line 155
	allow amazon_ssm_agent_t var_t:lnk_file { getattr read };
#line 155
	allow amazon_ssm_agent_t var_run_t:lnk_file { getattr read };
#line 155
	
#line 155
	allow amazon_ssm_agent_t var_t:dir { getattr search open };
#line 155
	allow amazon_ssm_agent_t var_run_t:dir { getattr search open };
#line 155

#line 155

#line 155
	 	
#line 155
##### end files_search_pids(amazon_ssm_agent_t) depth: 3
#line 155
 	
#line 155
	
#line 155
	allow amazon_ssm_agent_t systemd_logind_var_run_t:dir { getattr search open };
#line 155
	allow amazon_ssm_agent_t systemd_logind_var_run_t:dir { getattr search open read lock ioctl };
#line 155

#line 155

#line 155
	 	
#line 155
##### end systemd_login_list_pid_dirs(amazon_ssm_agent_t) depth: 2
#line 155
 	
#line 155
	 	 	
#line 155
##### begin systemd_login_read_pid_files(amazon_ssm_agent_t) depth: 3
#line 155
 	
#line 155
	
#line 155
	
#line 155
		require {
#line 155
			
#line 155
		type systemd_logind_var_run_t;
#line 155
	
#line 155
		} # end require
#line 155
	
#line 155

#line 155

#line 155
	 	 	
#line 155
##### begin files_search_pids(amazon_ssm_agent_t) depth: 4
#line 155
 	
#line 155
	
#line 155
	
#line 155
		require {
#line 155
			
#line 155
		type var_t, var_run_t;
#line 155
	
#line 155
		} # end require
#line 155
	
#line 155

#line 155

#line 155
	allow amazon_ssm_agent_t var_t:lnk_file { getattr read };
#line 155
	allow amazon_ssm_agent_t var_run_t:lnk_file { getattr read };
#line 155
	
#line 155
	allow amazon_ssm_agent_t var_t:dir { getattr search open };
#line 155
	allow amazon_ssm_agent_t var_run_t:dir { getattr search open };
#line 155

#line 155

#line 155
	 	
#line 155
##### end files_search_pids(amazon_ssm_agent_t) depth: 3
#line 155
 	
#line 155
	
#line 155
	allow amazon_ssm_agent_t systemd_logind_var_run_t:dir { getattr search open };
#line 155
	allow amazon_ssm_agent_t systemd_logind_var_run_t:file { open { getattr read ioctl lock } };
#line 155

#line 155

#line 155
	 	
#line 155
##### end systemd_login_read_pid_files(amazon_ssm_agent_t) depth: 2
#line 155
 	
#line 155
	 	 	
#line 155
##### begin systemd_passwd_agent_exec(amazon_ssm_agent_t) depth: 3
#line 155
 	
#line 155
	
#line 155
	
#line 155
		require {
#line 155
			
#line 155
		type systemd_passwd_agent_t, systemd_passwd_agent_exec_t;
#line 155
	
#line 155
		} # end require
#line 155
	
#line 155

#line 155

#line 155
	allow amazon_ssm_agent_t systemd_passwd_agent_exec_t:file { { getattr open read execute ioctl } ioctl lock execute_no_trans };
#line 155
	 	 	
#line 155
##### begin systemd_manage_passwd_run(amazon_ssm_agent_t) depth: 4
#line 155
 	
#line 155
	
#line 155
	
#line 155
		require {
#line 155
			
#line 155
		type systemd_passwd_agent_t;	
#line 155
		type systemd_passwd_var_run_t;
#line 155
	
#line 155
		} # end require
#line 155
	
#line 155

#line 155

#line 155
	 	 	
#line 155
##### begin init_search_pid_dirs(amazon_ssm_agent_t) depth: 5
#line 155
 	
#line 155
    
#line 155
	
#line 155
		require {
#line 155
			
#line 155
        type init_var_run_t;
#line 155
    
#line 155
		} # end require
#line 155
	
#line 155

#line 155

#line 155
    allow amazon_ssm_agent_t init_var_run_t:dir { getattr search open };
#line 155

#line 155
	 	
#line 155
##### end init_search_pid_dirs(amazon_ssm_agent_t) depth: 4
#line 155
 	
#line 155
	
#line 155
	allow amazon_ssm_agent_t systemd_passwd_var_run_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 155
	allow amazon_ssm_agent_t systemd_passwd_var_run_t:file { create open getattr setattr read write append rename link unlink ioctl lock };
#line 155

#line 155
	
#line 155
	allow amazon_ssm_agent_t systemd_passwd_var_run_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 155
	allow amazon_ssm_agent_t systemd_passwd_var_run_t:sock_file { create open getattr setattr read write rename link unlink ioctl lock append };
#line 155

#line 155
	
#line 155
	allow amazon_ssm_agent_t systemd_passwd_var_run_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 155
	allow amazon_ssm_agent_t systemd_passwd_var_run_t:fifo_file { create open getattr setattr read write append rename link unlink ioctl lock };
#line 155

#line 155

#line 155
	allow systemd_passwd_agent_t amazon_ssm_agent_t:process signull;
#line 155
	allow systemd_passwd_agent_t amazon_ssm_agent_t:unix_dgram_socket sendto;
#line 155

#line 155
	 	
#line 155
##### end systemd_manage_passwd_run(amazon_ssm_agent_t) depth: 3
#line 155
 	
#line 155

#line 155
	 	
#line 155
##### end systemd_passwd_agent_exec(amazon_ssm_agent_t) depth: 2
#line 155
 	
#line 155

#line 155
	dontaudit amazon_ssm_agent_t self:capability net_admin;
#line 155

#line 155
	 	
#line 155
##### end systemd_exec_systemctl(amazon_ssm_agent_t) depth: 1
#line 155
 	
#line 155
	 	 	
#line 155
##### begin init_reload_services(amazon_ssm_agent_t) depth: 2
#line 155
 	
#line 155
	
#line 155
	
#line 155
		require {
#line 155
			
#line 155
		type init_t;
#line 155
	
#line 155
		} # end require
#line 155
	
#line 155

#line 155

#line 155
	allow amazon_ssm_agent_t init_t:system reload;
#line 155

#line 155
	 	
#line 155
##### end init_reload_services(amazon_ssm_agent_t) depth: 1
#line 155
 	
#line 155
     	 	
#line 155
##### begin systemd_read_fifo_file_passwd_run(amazon_ssm_agent_t) depth: 2
#line 155
 	
#line 155
    
#line 155
	
#line 155
		require {
#line 155
			
#line 155
        type systemd_passwd_var_run_t;
#line 155
    
#line 155
		} # end require
#line 155
	
#line 155

#line 155

#line 155
     	 	
#line 155
##### begin init_search_pid_dirs(amazon_ssm_agent_t) depth: 3
#line 155
 	
#line 155
    
#line 155
	
#line 155
		require {
#line 155
			
#line 155
        type init_var_run_t;
#line 155
    
#line 155
		} # end require
#line 155
	
#line 155

#line 155

#line 155
    allow amazon_ssm_agent_t init_var_run_t:dir { getattr search open };
#line 155

#line 155
	 	
#line 155
##### end init_search_pid_dirs(amazon_ssm_agent_t) depth: 2
#line 155
 	
#line 155
    
#line 155
	allow amazon_ssm_agent_t systemd_passwd_var_run_t:dir { getattr search open };
#line 155
	allow amazon_ssm_agent_t systemd_passwd_var_run_t:sock_file { getattr open read };
#line 155

#line 155

#line 155
	 	
#line 155
##### end systemd_read_fifo_file_passwd_run(amazon_ssm_agent_t) depth: 1
#line 155
 	
#line 155
	allow amazon_ssm_agent_t lsmd_unit_file_t:file { open { getattr read ioctl lock } };
#line 155
	allow amazon_ssm_agent_t lsmd_unit_file_t:service { start stop status reload enable disable } ;
#line 155

#line 155
	
#line 155
	allow amazon_ssm_agent_t lsmd_t:dir { getattr search open read lock ioctl };
#line 155
	allow amazon_ssm_agent_t lsmd_t:file { open { getattr read ioctl lock } };
#line 155
	allow amazon_ssm_agent_t lsmd_t:lnk_file { getattr read };
#line 155
	allow amazon_ssm_agent_t lsmd_t:process getattr;
#line 155

#line 155

#line 155
	 	
#line 155
##### end lsmd_systemctl(amazon_ssm_agent_t) depth: 0
#line 155
 	

 	 	
#line 157
##### begin kernel_read_system_state(amazon_ssm_agent_t) depth: 1
#line 157
 	
#line 157
	
#line 157
	
#line 157
		require {
#line 157
			
#line 157
		attribute kernel_system_state_reader;
#line 157
	
#line 157
		} # end require
#line 157
	
#line 157

#line 157

#line 157
	typeattribute amazon_ssm_agent_t kernel_system_state_reader;
#line 157

#line 157
	 	
#line 157
##### end kernel_read_system_state(amazon_ssm_agent_t) depth: 0
#line 157
 	

 	 	
#line 159
##### begin kernel_read_state(amazon_ssm_agent_t) depth: 1
#line 159
 	
#line 159
	
#line 159
	
#line 159
		require {
#line 159
			
#line 159
		type kernel_t;
#line 159
	
#line 159
		} # end require
#line 159
	
#line 159

#line 159

#line 159
	allow amazon_ssm_agent_t kernel_t:dir { getattr search open };
#line 159
	allow amazon_ssm_agent_t kernel_t:file { open { getattr read ioctl lock } };
#line 159
	allow amazon_ssm_agent_t kernel_t:lnk_file { getattr read };
#line 159

#line 159
	 	
#line 159
##### end kernel_read_state(amazon_ssm_agent_t) depth: 0
#line 159
 	

 	 	
#line 161
##### begin kernel_list_proc(amazon_ssm_agent_t) depth: 1
#line 161
 	
#line 161
	
#line 161
	
#line 161
		require {
#line 161
			
#line 161
		type proc_t;
#line 161
	
#line 161
		} # end require
#line 161
	
#line 161

#line 161

#line 161
	
#line 161
	allow amazon_ssm_agent_t proc_t:dir { getattr search open };
#line 161
	allow amazon_ssm_agent_t proc_t:dir { getattr search open read lock ioctl };
#line 161

#line 161

#line 161
	 	
#line 161
##### end kernel_list_proc(amazon_ssm_agent_t) depth: 0
#line 161
 	

 	 	
#line 163
##### begin logging_admin_syslog(amazon_ssm_agent_t,system_r) depth: 1
#line 163
 	
#line 163
	
#line 163
	
#line 163
		require {
#line 163
			
#line 163
		type syslogd_t, klogd_t, syslog_conf_t;
#line 163
		type syslogd_tmp_t, syslogd_var_lib_t;
#line 163
		type syslogd_var_run_t, klogd_var_run_t;
#line 163
		type klogd_tmp_t, var_log_t;
#line 163
		type syslogd_initrc_exec_t;
#line 163
	
#line 163
		} # end require
#line 163
	
#line 163

#line 163

#line 163
	allow amazon_ssm_agent_t self:capability2 syslog;
#line 163
	allow amazon_ssm_agent_t syslogd_t:process { sigchld sigkill sigstop signull signal };
#line 163
	allow amazon_ssm_agent_t klogd_t:process { sigchld sigkill sigstop signull signal };
#line 163
	
#line 163
	allow amazon_ssm_agent_t syslogd_t:dir { getattr search open read lock ioctl };
#line 163
	allow amazon_ssm_agent_t syslogd_t:file { open { getattr read ioctl lock } };
#line 163
	allow amazon_ssm_agent_t syslogd_t:lnk_file { getattr read };
#line 163
	allow amazon_ssm_agent_t syslogd_t:process getattr;
#line 163

#line 163
	
#line 163
	allow amazon_ssm_agent_t klogd_t:dir { getattr search open read lock ioctl };
#line 163
	allow amazon_ssm_agent_t klogd_t:file { open { getattr read ioctl lock } };
#line 163
	allow amazon_ssm_agent_t klogd_t:lnk_file { getattr read };
#line 163
	allow amazon_ssm_agent_t klogd_t:process getattr;
#line 163

#line 163
	
#line 163
	
#line 163
	
#line 163
		require {
#line 163
			
#line 163
		
#line 163
bool deny_ptrace;
#line 163

#line 163
  
#line 163
	
#line 163
		} # end require
#line 163
	
#line 163

#line 163
	if (deny_ptrace) {
#line 163
		
#line 163
	} else {
#line 163
		
#line 163
		allow amazon_ssm_agent_t syslogd_t:process ptrace;
#line 163
		allow amazon_ssm_agent_t klogd_t:process ptrace;
#line 163
	
#line 163
	}
#line 163

#line 163

#line 163
	
#line 163
	allow amazon_ssm_agent_t klogd_var_run_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 163
	allow amazon_ssm_agent_t klogd_var_run_t:dir { create open getattr setattr read write link unlink rename search add_name remove_name reparent rmdir lock ioctl };
#line 163

#line 163
	
#line 163
	allow amazon_ssm_agent_t klogd_var_run_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 163
	allow amazon_ssm_agent_t klogd_var_run_t:file { create open getattr setattr read write append rename link unlink ioctl lock };
#line 163

#line 163

#line 163
	
#line 163
	allow amazon_ssm_agent_t klogd_tmp_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 163
	allow amazon_ssm_agent_t klogd_tmp_t:dir { create open getattr setattr read write link unlink rename search add_name remove_name reparent rmdir lock ioctl };
#line 163

#line 163
	
#line 163
	allow amazon_ssm_agent_t klogd_tmp_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 163
	allow amazon_ssm_agent_t klogd_tmp_t:file { create open getattr setattr read write append rename link unlink ioctl lock };
#line 163

#line 163

#line 163
	
#line 163
	allow amazon_ssm_agent_t syslogd_tmp_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 163
	allow amazon_ssm_agent_t syslogd_tmp_t:dir { create open getattr setattr read write link unlink rename search add_name remove_name reparent rmdir lock ioctl };
#line 163

#line 163
	
#line 163
	allow amazon_ssm_agent_t syslogd_tmp_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 163
	allow amazon_ssm_agent_t syslogd_tmp_t:file { create open getattr setattr read write append rename link unlink ioctl lock };
#line 163

#line 163

#line 163
	
#line 163
	allow amazon_ssm_agent_t syslog_conf_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 163
	allow amazon_ssm_agent_t syslog_conf_t:dir { create open getattr setattr read write link unlink rename search add_name remove_name reparent rmdir lock ioctl };
#line 163

#line 163
	
#line 163
	allow amazon_ssm_agent_t syslog_conf_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 163
	allow amazon_ssm_agent_t syslog_conf_t:file { create open getattr setattr read write append rename link unlink ioctl lock };
#line 163

#line 163
	 	 	
#line 163
##### begin files_etc_filetrans(amazon_ssm_agent_t,syslog_conf_t,file) depth: 2
#line 163
 	
#line 163
	
#line 163
	
#line 163
		require {
#line 163
			
#line 163
		type etc_t;
#line 163
	
#line 163
		} # end require
#line 163
	
#line 163

#line 163

#line 163
	
#line 163
	allow amazon_ssm_agent_t etc_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 163
	type_transition amazon_ssm_agent_t etc_t:file syslog_conf_t ;
#line 163

#line 163

#line 163
	 	
#line 163
##### end files_etc_filetrans(amazon_ssm_agent_t,syslog_conf_t,file) depth: 1
#line 163
 	
#line 163

#line 163
	
#line 163
	allow amazon_ssm_agent_t syslogd_var_lib_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 163
	allow amazon_ssm_agent_t syslogd_var_lib_t:dir { create open getattr setattr read write link unlink rename search add_name remove_name reparent rmdir lock ioctl };
#line 163

#line 163
	
#line 163
	allow amazon_ssm_agent_t syslogd_var_lib_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 163
	allow amazon_ssm_agent_t syslogd_var_lib_t:file { create open getattr setattr read write append rename link unlink ioctl lock };
#line 163

#line 163

#line 163
	
#line 163
	allow amazon_ssm_agent_t syslogd_var_run_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 163
	allow amazon_ssm_agent_t syslogd_var_run_t:dir { create open getattr setattr read write link unlink rename search add_name remove_name reparent rmdir lock ioctl };
#line 163

#line 163
	
#line 163
	allow amazon_ssm_agent_t syslogd_var_run_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 163
	allow amazon_ssm_agent_t syslogd_var_run_t:file { create open getattr setattr read write append rename link unlink ioctl lock };
#line 163

#line 163

#line 163
	 	 	
#line 163
##### begin logging_manage_all_logs(amazon_ssm_agent_t) depth: 2
#line 163
 	
#line 163
	
#line 163
	
#line 163
		require {
#line 163
			
#line 163
		attribute logfile;
#line 163
	
#line 163
		} # end require
#line 163
	
#line 163

#line 163

#line 163
	 	 	
#line 163
##### begin files_search_var(amazon_ssm_agent_t) depth: 3
#line 163
 	
#line 163
	
#line 163
	
#line 163
		require {
#line 163
			
#line 163
		type var_t;
#line 163
	
#line 163
		} # end require
#line 163
	
#line 163

#line 163

#line 163
	allow amazon_ssm_agent_t var_t:dir { getattr search open };
#line 163

#line 163
	 	
#line 163
##### end files_search_var(amazon_ssm_agent_t) depth: 2
#line 163
 	
#line 163
	
#line 163
	allow amazon_ssm_agent_t logfile:dir { open read getattr lock search ioctl add_name remove_name write };
#line 163
	allow amazon_ssm_agent_t logfile:dir { create open getattr setattr read write link unlink rename search add_name remove_name reparent rmdir lock ioctl };
#line 163

#line 163
	
#line 163
	allow amazon_ssm_agent_t logfile:dir { open read getattr lock search ioctl add_name remove_name write };
#line 163
	allow amazon_ssm_agent_t logfile:file { create open getattr setattr read write append rename link unlink ioctl lock };
#line 163

#line 163
	
#line 163
	allow amazon_ssm_agent_t logfile:dir { open read getattr lock search ioctl add_name remove_name write };
#line 163
	allow amazon_ssm_agent_t logfile:lnk_file { create getattr setattr read write append rename link unlink ioctl lock };
#line 163

#line 163

#line 163
	 	
#line 163
##### end logging_manage_all_logs(amazon_ssm_agent_t) depth: 1
#line 163
 	
#line 163
	allow amazon_ssm_agent_t logfile:dir { getattr relabelfrom relabelto };
#line 163
	allow amazon_ssm_agent_t logfile:file { getattr relabelfrom relabelto };
#line 163

#line 163
	 	 	
#line 163
##### begin init_labeled_script_domtrans(amazon_ssm_agent_t,syslogd_initrc_exec_t) depth: 2
#line 163
 	
#line 163
	
#line 163
	
#line 163
		require {
#line 163
			
#line 163
		type initrc_t;
#line 163
		attribute initrc_transition_domain;
#line 163
	
#line 163
		} # end require
#line 163
	
#line 163

#line 163

#line 163
	typeattribute amazon_ssm_agent_t initrc_transition_domain;
#line 163
	# service script searches all filesystems via mountpoint
#line 163
	 	 	
#line 163
##### begin fs_search_all(amazon_ssm_agent_t) depth: 3
#line 163
 	
#line 163
	
#line 163
	
#line 163
		require {
#line 163
			
#line 163
		attribute filesystem_type;
#line 163
	
#line 163
		} # end require
#line 163
	
#line 163

#line 163

#line 163
	allow amazon_ssm_agent_t filesystem_type:dir { getattr search open };
#line 163

#line 163
	 	
#line 163
##### end fs_search_all(amazon_ssm_agent_t) depth: 2
#line 163
 	
#line 163
	
#line 163
	
#line 163
	
#line 163
	allow amazon_ssm_agent_t syslogd_initrc_exec_t:file { getattr open read execute };
#line 163
	allow amazon_ssm_agent_t initrc_t:process transition;
#line 163
#	dontaudit amazon_ssm_agent_t initrc_t:process { noatsecure siginh rlimitinh };
#line 163

#line 163
	type_transition amazon_ssm_agent_t syslogd_initrc_exec_t:process initrc_t;
#line 163

#line 163

#line 163
	allow initrc_t amazon_ssm_agent_t:fd use;
#line 163
	allow initrc_t amazon_ssm_agent_t:fifo_file { getattr read write append ioctl lock };
#line 163
	allow initrc_t amazon_ssm_agent_t:process sigchld;
#line 163

#line 163
	allow amazon_ssm_agent_t syslogd_initrc_exec_t:file ioctl;
#line 163
	 	 	
#line 163
##### begin files_search_etc(amazon_ssm_agent_t) depth: 3
#line 163
 	
#line 163
	
#line 163
	
#line 163
		require {
#line 163
			
#line 163
		type etc_t;
#line 163
	
#line 163
		} # end require
#line 163
	
#line 163

#line 163

#line 163
	allow amazon_ssm_agent_t etc_t:dir { getattr search open };
#line 163

#line 163
	 	
#line 163
##### end files_search_etc(amazon_ssm_agent_t) depth: 2
#line 163
 	
#line 163

#line 163
	 	
#line 163
##### end init_labeled_script_domtrans(amazon_ssm_agent_t,syslogd_initrc_exec_t) depth: 1
#line 163
 	
#line 163
	 	 	
#line 163
##### begin domain_system_change_exemption(amazon_ssm_agent_t) depth: 2
#line 163
 	
#line 163
	
#line 163
	
#line 163
		require {
#line 163
			
#line 163
		attribute can_system_change;
#line 163
	
#line 163
		} # end require
#line 163
	
#line 163

#line 163

#line 163
	typeattribute amazon_ssm_agent_t can_system_change;
#line 163

#line 163
	 	
#line 163
##### end domain_system_change_exemption(amazon_ssm_agent_t) depth: 1
#line 163
 	
#line 163
	role_transition system_r syslogd_initrc_exec_t system_r;
#line 163
	allow system_r system_r;
#line 163

#line 163
	 	
#line 163
##### end logging_admin_syslog(amazon_ssm_agent_t,system_r) depth: 0
#line 163
 	

 	 	
#line 165
##### begin gssproxy_systemctl(amazon_ssm_agent_t) depth: 1
#line 165
 	
#line 165
	
#line 165
	
#line 165
		require {
#line 165
			
#line 165
		type gssproxy_t;
#line 165
		type gssproxy_unit_file_t;
#line 165
	
#line 165
		} # end require
#line 165
	
#line 165

#line 165

#line 165
	 	 	
#line 165
##### begin systemd_exec_systemctl(amazon_ssm_agent_t) depth: 2
#line 165
 	
#line 165
        
#line 165
	
#line 165
		require {
#line 165
			
#line 165
                type systemd_systemctl_exec_t;
#line 165
        
#line 165
		} # end require
#line 165
	
#line 165

#line 165

#line 165
	 	 	
#line 165
##### begin corecmd_search_bin(amazon_ssm_agent_t) depth: 3
#line 165
 	
#line 165
	
#line 165
	
#line 165
		require {
#line 165
			
#line 165
		type bin_t;
#line 165
	
#line 165
		} # end require
#line 165
	
#line 165

#line 165

#line 165
	 	 	
#line 165
##### begin corecmd_read_bin_symlinks(amazon_ssm_agent_t) depth: 4
#line 165
 	
#line 165
	
#line 165
	
#line 165
		require {
#line 165
			
#line 165
		type bin_t;
#line 165
	
#line 165
		} # end require
#line 165
	
#line 165

#line 165

#line 165
	
#line 165
	allow amazon_ssm_agent_t bin_t:dir { getattr search open };
#line 165
	allow amazon_ssm_agent_t bin_t:lnk_file { getattr read };
#line 165

#line 165

#line 165
	 	
#line 165
##### end corecmd_read_bin_symlinks(amazon_ssm_agent_t) depth: 3
#line 165
 	
#line 165
	
#line 165
	allow amazon_ssm_agent_t bin_t:dir { getattr search open };
#line 165
	allow amazon_ssm_agent_t bin_t:dir { getattr search open };
#line 165

#line 165

#line 165
	 	
#line 165
##### end corecmd_search_bin(amazon_ssm_agent_t) depth: 2
#line 165
 	
#line 165
	allow amazon_ssm_agent_t systemd_systemctl_exec_t:file { { getattr open read execute ioctl } ioctl lock execute_no_trans };
#line 165

#line 165
	 	 	
#line 165
##### begin fs_list_cgroup_dirs(amazon_ssm_agent_t) depth: 3
#line 165
 	
#line 165
	
#line 165
	
#line 165
		require {
#line 165
			
#line 165
		type cgroup_t;
#line 165
	
#line 165
		} # end require
#line 165
	
#line 165

#line 165

#line 165
	
#line 165
	allow amazon_ssm_agent_t cgroup_t:dir { getattr search open };
#line 165
	allow amazon_ssm_agent_t cgroup_t:dir { getattr search open read lock ioctl };
#line 165

#line 165
	 	 	
#line 165
##### begin fs_search_tmpfs(amazon_ssm_agent_t) depth: 4
#line 165
 	
#line 165
	
#line 165
	
#line 165
		require {
#line 165
			
#line 165
		type tmpfs_t;
#line 165
	
#line 165
		} # end require
#line 165
	
#line 165

#line 165

#line 165
	allow amazon_ssm_agent_t tmpfs_t:dir { getattr search open };
#line 165

#line 165
	 	
#line 165
##### end fs_search_tmpfs(amazon_ssm_agent_t) depth: 3
#line 165
 	
#line 165
	 	 	
#line 165
##### begin dev_search_sysfs(amazon_ssm_agent_t) depth: 4
#line 165
 	
#line 165
	
#line 165
	
#line 165
		require {
#line 165
			
#line 165
		type sysfs_t;
#line 165
	
#line 165
		} # end require
#line 165
	
#line 165

#line 165

#line 165
	
#line 165
	allow amazon_ssm_agent_t sysfs_t:dir { getattr search open };
#line 165
	allow amazon_ssm_agent_t sysfs_t:dir { getattr search open };
#line 165

#line 165

#line 165
	 	
#line 165
##### end dev_search_sysfs(amazon_ssm_agent_t) depth: 3
#line 165
 	
#line 165

#line 165
	 	
#line 165
##### end fs_list_cgroup_dirs(amazon_ssm_agent_t) depth: 2
#line 165
 	
#line 165
	 	 	
#line 165
##### begin fs_read_cgroup_files(amazon_ssm_agent_t) depth: 3
#line 165
 	
#line 165
	
#line 165
	
#line 165
		require {
#line 165
			
#line 165
		type cgroup_t;
#line 165

#line 165
	
#line 165
		} # end require
#line 165
	
#line 165

#line 165

#line 165
	
#line 165
	allow amazon_ssm_agent_t cgroup_t:dir { getattr search open };
#line 165
	allow amazon_ssm_agent_t cgroup_t:file { open { getattr read ioctl lock } };
#line 165

#line 165
	
#line 165
	allow amazon_ssm_agent_t cgroup_t:dir { getattr search open };
#line 165
	allow amazon_ssm_agent_t cgroup_t:lnk_file { getattr read };
#line 165

#line 165
	 	 	
#line 165
##### begin fs_search_tmpfs(amazon_ssm_agent_t) depth: 4
#line 165
 	
#line 165
	
#line 165
	
#line 165
		require {
#line 165
			
#line 165
		type tmpfs_t;
#line 165
	
#line 165
		} # end require
#line 165
	
#line 165

#line 165

#line 165
	allow amazon_ssm_agent_t tmpfs_t:dir { getattr search open };
#line 165

#line 165
	 	
#line 165
##### end fs_search_tmpfs(amazon_ssm_agent_t) depth: 3
#line 165
 	
#line 165
	 	 	
#line 165
##### begin dev_search_sysfs(amazon_ssm_agent_t) depth: 4
#line 165
 	
#line 165
	
#line 165
	
#line 165
		require {
#line 165
			
#line 165
		type sysfs_t;
#line 165
	
#line 165
		} # end require
#line 165
	
#line 165

#line 165

#line 165
	
#line 165
	allow amazon_ssm_agent_t sysfs_t:dir { getattr search open };
#line 165
	allow amazon_ssm_agent_t sysfs_t:dir { getattr search open };
#line 165

#line 165

#line 165
	 	
#line 165
##### end dev_search_sysfs(amazon_ssm_agent_t) depth: 3
#line 165
 	
#line 165

#line 165
	 	
#line 165
##### end fs_read_cgroup_files(amazon_ssm_agent_t) depth: 2
#line 165
 	
#line 165
	 	 	
#line 165
##### begin systemd_list_unit_dirs(amazon_ssm_agent_t) depth: 3
#line 165
 	
#line 165
        
#line 165
	
#line 165
		require {
#line 165
			
#line 165
                attribute systemd_unit_file_type;
#line 165
        
#line 165
		} # end require
#line 165
	
#line 165

#line 165
	
#line 165
	 	 	
#line 165
##### begin files_search_var_lib(amazon_ssm_agent_t) depth: 4
#line 165
 	
#line 165
	
#line 165
	
#line 165
		require {
#line 165
			
#line 165
		type var_t, var_lib_t;
#line 165
	
#line 165
		} # end require
#line 165
	
#line 165

#line 165

#line 165
	
#line 165
	allow amazon_ssm_agent_t var_t:dir { getattr search open };
#line 165
	allow amazon_ssm_agent_t var_lib_t:dir { getattr search open };
#line 165

#line 165

#line 165
	 	
#line 165
##### end files_search_var_lib(amazon_ssm_agent_t) depth: 3
#line 165
 	
#line 165
	allow amazon_ssm_agent_t systemd_unit_file_type:dir { getattr search open read lock ioctl };
#line 165

#line 165
	 	
#line 165
##### end systemd_list_unit_dirs(amazon_ssm_agent_t) depth: 2
#line 165
 	
#line 165
	 	 	
#line 165
##### begin init_list_pid_dirs(amazon_ssm_agent_t) depth: 3
#line 165
 	
#line 165
    
#line 165
	
#line 165
		require {
#line 165
			
#line 165
        type init_var_run_t;
#line 165
    
#line 165
		} # end require
#line 165
	
#line 165

#line 165

#line 165
    allow amazon_ssm_agent_t init_var_run_t:dir { getattr search open read lock ioctl };
#line 165

#line 165
	 	
#line 165
##### end init_list_pid_dirs(amazon_ssm_agent_t) depth: 2
#line 165
 	
#line 165
	 	 	
#line 165
##### begin init_read_state(amazon_ssm_agent_t) depth: 3
#line 165
 	
#line 165
	
#line 165
	
#line 165
		require {
#line 165
			
#line 165
		type init_t;
#line 165
	
#line 165
		} # end require
#line 165
	
#line 165

#line 165

#line 165
	allow amazon_ssm_agent_t init_t:dir { getattr search open };
#line 165
	allow amazon_ssm_agent_t init_t:file { open { getattr read ioctl lock } };
#line 165
	allow amazon_ssm_agent_t init_t:lnk_file { getattr read };
#line 165

#line 165
	 	
#line 165
##### end init_read_state(amazon_ssm_agent_t) depth: 2
#line 165
 	
#line 165
	 	 	
#line 165
##### begin init_stream_send(amazon_ssm_agent_t) depth: 3
#line 165
 	
#line 165
	
#line 165
	
#line 165
		require {
#line 165
			
#line 165
		type init_t;
#line 165
	
#line 165
		} # end require
#line 165
	
#line 165

#line 165

#line 165
	allow amazon_ssm_agent_t init_t:unix_stream_socket sendto;
#line 165

#line 165
	 	
#line 165
##### end init_stream_send(amazon_ssm_agent_t) depth: 2
#line 165
 	
#line 165
	 	 	
#line 165
##### begin init_stream_connect(amazon_ssm_agent_t) depth: 3
#line 165
 	
#line 165
	
#line 165
	
#line 165
		require {
#line 165
			
#line 165
		type init_t, init_var_run_t;
#line 165
	
#line 165
		} # end require
#line 165
	
#line 165

#line 165

#line 165
	 	 	
#line 165
##### begin files_search_pids(amazon_ssm_agent_t) depth: 4
#line 165
 	
#line 165
	
#line 165
	
#line 165
		require {
#line 165
			
#line 165
		type var_t, var_run_t;
#line 165
	
#line 165
		} # end require
#line 165
	
#line 165

#line 165

#line 165
	allow amazon_ssm_agent_t var_t:lnk_file { getattr read };
#line 165
	allow amazon_ssm_agent_t var_run_t:lnk_file { getattr read };
#line 165
	
#line 165
	allow amazon_ssm_agent_t var_t:dir { getattr search open };
#line 165
	allow amazon_ssm_agent_t var_run_t:dir { getattr search open };
#line 165

#line 165

#line 165
	 	
#line 165
##### end files_search_pids(amazon_ssm_agent_t) depth: 3
#line 165
 	
#line 165
	
#line 165
	allow amazon_ssm_agent_t init_var_run_t:dir { getattr search open };
#line 165
	allow amazon_ssm_agent_t init_var_run_t:sock_file { getattr write open append };
#line 165
	allow amazon_ssm_agent_t init_t:unix_stream_socket connectto;
#line 165
    
#line 165
	allow amazon_ssm_agent_t init_t:unix_stream_socket getattr;
#line 165

#line 165
	 	
#line 165
##### end init_stream_connect(amazon_ssm_agent_t) depth: 2
#line 165
 	
#line 165

#line 165
	 	 	
#line 165
##### begin systemd_login_list_pid_dirs(amazon_ssm_agent_t) depth: 3
#line 165
 	
#line 165
	
#line 165
	
#line 165
		require {
#line 165
			
#line 165
		type systemd_logind_var_run_t;
#line 165
	
#line 165
		} # end require
#line 165
	
#line 165

#line 165

#line 165
	 	 	
#line 165
##### begin files_search_pids(amazon_ssm_agent_t) depth: 4
#line 165
 	
#line 165
	
#line 165
	
#line 165
		require {
#line 165
			
#line 165
		type var_t, var_run_t;
#line 165
	
#line 165
		} # end require
#line 165
	
#line 165

#line 165

#line 165
	allow amazon_ssm_agent_t var_t:lnk_file { getattr read };
#line 165
	allow amazon_ssm_agent_t var_run_t:lnk_file { getattr read };
#line 165
	
#line 165
	allow amazon_ssm_agent_t var_t:dir { getattr search open };
#line 165
	allow amazon_ssm_agent_t var_run_t:dir { getattr search open };
#line 165

#line 165

#line 165
	 	
#line 165
##### end files_search_pids(amazon_ssm_agent_t) depth: 3
#line 165
 	
#line 165
	
#line 165
	allow amazon_ssm_agent_t systemd_logind_var_run_t:dir { getattr search open };
#line 165
	allow amazon_ssm_agent_t systemd_logind_var_run_t:dir { getattr search open read lock ioctl };
#line 165

#line 165

#line 165
	 	
#line 165
##### end systemd_login_list_pid_dirs(amazon_ssm_agent_t) depth: 2
#line 165
 	
#line 165
	 	 	
#line 165
##### begin systemd_login_read_pid_files(amazon_ssm_agent_t) depth: 3
#line 165
 	
#line 165
	
#line 165
	
#line 165
		require {
#line 165
			
#line 165
		type systemd_logind_var_run_t;
#line 165
	
#line 165
		} # end require
#line 165
	
#line 165

#line 165

#line 165
	 	 	
#line 165
##### begin files_search_pids(amazon_ssm_agent_t) depth: 4
#line 165
 	
#line 165
	
#line 165
	
#line 165
		require {
#line 165
			
#line 165
		type var_t, var_run_t;
#line 165
	
#line 165
		} # end require
#line 165
	
#line 165

#line 165

#line 165
	allow amazon_ssm_agent_t var_t:lnk_file { getattr read };
#line 165
	allow amazon_ssm_agent_t var_run_t:lnk_file { getattr read };
#line 165
	
#line 165
	allow amazon_ssm_agent_t var_t:dir { getattr search open };
#line 165
	allow amazon_ssm_agent_t var_run_t:dir { getattr search open };
#line 165

#line 165

#line 165
	 	
#line 165
##### end files_search_pids(amazon_ssm_agent_t) depth: 3
#line 165
 	
#line 165
	
#line 165
	allow amazon_ssm_agent_t systemd_logind_var_run_t:dir { getattr search open };
#line 165
	allow amazon_ssm_agent_t systemd_logind_var_run_t:file { open { getattr read ioctl lock } };
#line 165

#line 165

#line 165
	 	
#line 165
##### end systemd_login_read_pid_files(amazon_ssm_agent_t) depth: 2
#line 165
 	
#line 165
	 	 	
#line 165
##### begin systemd_passwd_agent_exec(amazon_ssm_agent_t) depth: 3
#line 165
 	
#line 165
	
#line 165
	
#line 165
		require {
#line 165
			
#line 165
		type systemd_passwd_agent_t, systemd_passwd_agent_exec_t;
#line 165
	
#line 165
		} # end require
#line 165
	
#line 165

#line 165

#line 165
	allow amazon_ssm_agent_t systemd_passwd_agent_exec_t:file { { getattr open read execute ioctl } ioctl lock execute_no_trans };
#line 165
	 	 	
#line 165
##### begin systemd_manage_passwd_run(amazon_ssm_agent_t) depth: 4
#line 165
 	
#line 165
	
#line 165
	
#line 165
		require {
#line 165
			
#line 165
		type systemd_passwd_agent_t;	
#line 165
		type systemd_passwd_var_run_t;
#line 165
	
#line 165
		} # end require
#line 165
	
#line 165

#line 165

#line 165
	 	 	
#line 165
##### begin init_search_pid_dirs(amazon_ssm_agent_t) depth: 5
#line 165
 	
#line 165
    
#line 165
	
#line 165
		require {
#line 165
			
#line 165
        type init_var_run_t;
#line 165
    
#line 165
		} # end require
#line 165
	
#line 165

#line 165

#line 165
    allow amazon_ssm_agent_t init_var_run_t:dir { getattr search open };
#line 165

#line 165
	 	
#line 165
##### end init_search_pid_dirs(amazon_ssm_agent_t) depth: 4
#line 165
 	
#line 165
	
#line 165
	allow amazon_ssm_agent_t systemd_passwd_var_run_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 165
	allow amazon_ssm_agent_t systemd_passwd_var_run_t:file { create open getattr setattr read write append rename link unlink ioctl lock };
#line 165

#line 165
	
#line 165
	allow amazon_ssm_agent_t systemd_passwd_var_run_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 165
	allow amazon_ssm_agent_t systemd_passwd_var_run_t:sock_file { create open getattr setattr read write rename link unlink ioctl lock append };
#line 165

#line 165
	
#line 165
	allow amazon_ssm_agent_t systemd_passwd_var_run_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 165
	allow amazon_ssm_agent_t systemd_passwd_var_run_t:fifo_file { create open getattr setattr read write append rename link unlink ioctl lock };
#line 165

#line 165

#line 165
	allow systemd_passwd_agent_t amazon_ssm_agent_t:process signull;
#line 165
	allow systemd_passwd_agent_t amazon_ssm_agent_t:unix_dgram_socket sendto;
#line 165

#line 165
	 	
#line 165
##### end systemd_manage_passwd_run(amazon_ssm_agent_t) depth: 3
#line 165
 	
#line 165

#line 165
	 	
#line 165
##### end systemd_passwd_agent_exec(amazon_ssm_agent_t) depth: 2
#line 165
 	
#line 165

#line 165
	dontaudit amazon_ssm_agent_t self:capability net_admin;
#line 165

#line 165
	 	
#line 165
##### end systemd_exec_systemctl(amazon_ssm_agent_t) depth: 1
#line 165
 	
#line 165
	 	 	
#line 165
##### begin init_reload_services(amazon_ssm_agent_t) depth: 2
#line 165
 	
#line 165
	
#line 165
	
#line 165
		require {
#line 165
			
#line 165
		type init_t;
#line 165
	
#line 165
		} # end require
#line 165
	
#line 165

#line 165

#line 165
	allow amazon_ssm_agent_t init_t:system reload;
#line 165

#line 165
	 	
#line 165
##### end init_reload_services(amazon_ssm_agent_t) depth: 1
#line 165
 	
#line 165
	allow amazon_ssm_agent_t gssproxy_unit_file_t:file { open { getattr read ioctl lock } };
#line 165
	allow amazon_ssm_agent_t gssproxy_unit_file_t:service { start stop status reload enable disable } ;
#line 165

#line 165
	
#line 165
	allow amazon_ssm_agent_t gssproxy_t:dir { getattr search open read lock ioctl };
#line 165
	allow amazon_ssm_agent_t gssproxy_t:file { open { getattr read ioctl lock } };
#line 165
	allow amazon_ssm_agent_t gssproxy_t:lnk_file { getattr read };
#line 165
	allow amazon_ssm_agent_t gssproxy_t:process getattr;
#line 165

#line 165

#line 165
	 	
#line 165
##### end gssproxy_systemctl(amazon_ssm_agent_t) depth: 0
#line 165
 	

 	 	
#line 167
##### begin chronyd_systemctl(amazon_ssm_agent_t) depth: 1
#line 167
 	
#line 167
	
#line 167
	
#line 167
		require {
#line 167
			
#line 167
		type chronyd_t;
#line 167
		type chronyd_unit_file_t;
#line 167
	
#line 167
		} # end require
#line 167
	
#line 167

#line 167

#line 167
	 	 	
#line 167
##### begin systemd_exec_systemctl(amazon_ssm_agent_t) depth: 2
#line 167
 	
#line 167
        
#line 167
	
#line 167
		require {
#line 167
			
#line 167
                type systemd_systemctl_exec_t;
#line 167
        
#line 167
		} # end require
#line 167
	
#line 167

#line 167

#line 167
	 	 	
#line 167
##### begin corecmd_search_bin(amazon_ssm_agent_t) depth: 3
#line 167
 	
#line 167
	
#line 167
	
#line 167
		require {
#line 167
			
#line 167
		type bin_t;
#line 167
	
#line 167
		} # end require
#line 167
	
#line 167

#line 167

#line 167
	 	 	
#line 167
##### begin corecmd_read_bin_symlinks(amazon_ssm_agent_t) depth: 4
#line 167
 	
#line 167
	
#line 167
	
#line 167
		require {
#line 167
			
#line 167
		type bin_t;
#line 167
	
#line 167
		} # end require
#line 167
	
#line 167

#line 167

#line 167
	
#line 167
	allow amazon_ssm_agent_t bin_t:dir { getattr search open };
#line 167
	allow amazon_ssm_agent_t bin_t:lnk_file { getattr read };
#line 167

#line 167

#line 167
	 	
#line 167
##### end corecmd_read_bin_symlinks(amazon_ssm_agent_t) depth: 3
#line 167
 	
#line 167
	
#line 167
	allow amazon_ssm_agent_t bin_t:dir { getattr search open };
#line 167
	allow amazon_ssm_agent_t bin_t:dir { getattr search open };
#line 167

#line 167

#line 167
	 	
#line 167
##### end corecmd_search_bin(amazon_ssm_agent_t) depth: 2
#line 167
 	
#line 167
	allow amazon_ssm_agent_t systemd_systemctl_exec_t:file { { getattr open read execute ioctl } ioctl lock execute_no_trans };
#line 167

#line 167
	 	 	
#line 167
##### begin fs_list_cgroup_dirs(amazon_ssm_agent_t) depth: 3
#line 167
 	
#line 167
	
#line 167
	
#line 167
		require {
#line 167
			
#line 167
		type cgroup_t;
#line 167
	
#line 167
		} # end require
#line 167
	
#line 167

#line 167

#line 167
	
#line 167
	allow amazon_ssm_agent_t cgroup_t:dir { getattr search open };
#line 167
	allow amazon_ssm_agent_t cgroup_t:dir { getattr search open read lock ioctl };
#line 167

#line 167
	 	 	
#line 167
##### begin fs_search_tmpfs(amazon_ssm_agent_t) depth: 4
#line 167
 	
#line 167
	
#line 167
	
#line 167
		require {
#line 167
			
#line 167
		type tmpfs_t;
#line 167
	
#line 167
		} # end require
#line 167
	
#line 167

#line 167

#line 167
	allow amazon_ssm_agent_t tmpfs_t:dir { getattr search open };
#line 167

#line 167
	 	
#line 167
##### end fs_search_tmpfs(amazon_ssm_agent_t) depth: 3
#line 167
 	
#line 167
	 	 	
#line 167
##### begin dev_search_sysfs(amazon_ssm_agent_t) depth: 4
#line 167
 	
#line 167
	
#line 167
	
#line 167
		require {
#line 167
			
#line 167
		type sysfs_t;
#line 167
	
#line 167
		} # end require
#line 167
	
#line 167

#line 167

#line 167
	
#line 167
	allow amazon_ssm_agent_t sysfs_t:dir { getattr search open };
#line 167
	allow amazon_ssm_agent_t sysfs_t:dir { getattr search open };
#line 167

#line 167

#line 167
	 	
#line 167
##### end dev_search_sysfs(amazon_ssm_agent_t) depth: 3
#line 167
 	
#line 167

#line 167
	 	
#line 167
##### end fs_list_cgroup_dirs(amazon_ssm_agent_t) depth: 2
#line 167
 	
#line 167
	 	 	
#line 167
##### begin fs_read_cgroup_files(amazon_ssm_agent_t) depth: 3
#line 167
 	
#line 167
	
#line 167
	
#line 167
		require {
#line 167
			
#line 167
		type cgroup_t;
#line 167

#line 167
	
#line 167
		} # end require
#line 167
	
#line 167

#line 167

#line 167
	
#line 167
	allow amazon_ssm_agent_t cgroup_t:dir { getattr search open };
#line 167
	allow amazon_ssm_agent_t cgroup_t:file { open { getattr read ioctl lock } };
#line 167

#line 167
	
#line 167
	allow amazon_ssm_agent_t cgroup_t:dir { getattr search open };
#line 167
	allow amazon_ssm_agent_t cgroup_t:lnk_file { getattr read };
#line 167

#line 167
	 	 	
#line 167
##### begin fs_search_tmpfs(amazon_ssm_agent_t) depth: 4
#line 167
 	
#line 167
	
#line 167
	
#line 167
		require {
#line 167
			
#line 167
		type tmpfs_t;
#line 167
	
#line 167
		} # end require
#line 167
	
#line 167

#line 167

#line 167
	allow amazon_ssm_agent_t tmpfs_t:dir { getattr search open };
#line 167

#line 167
	 	
#line 167
##### end fs_search_tmpfs(amazon_ssm_agent_t) depth: 3
#line 167
 	
#line 167
	 	 	
#line 167
##### begin dev_search_sysfs(amazon_ssm_agent_t) depth: 4
#line 167
 	
#line 167
	
#line 167
	
#line 167
		require {
#line 167
			
#line 167
		type sysfs_t;
#line 167
	
#line 167
		} # end require
#line 167
	
#line 167

#line 167

#line 167
	
#line 167
	allow amazon_ssm_agent_t sysfs_t:dir { getattr search open };
#line 167
	allow amazon_ssm_agent_t sysfs_t:dir { getattr search open };
#line 167

#line 167

#line 167
	 	
#line 167
##### end dev_search_sysfs(amazon_ssm_agent_t) depth: 3
#line 167
 	
#line 167

#line 167
	 	
#line 167
##### end fs_read_cgroup_files(amazon_ssm_agent_t) depth: 2
#line 167
 	
#line 167
	 	 	
#line 167
##### begin systemd_list_unit_dirs(amazon_ssm_agent_t) depth: 3
#line 167
 	
#line 167
        
#line 167
	
#line 167
		require {
#line 167
			
#line 167
                attribute systemd_unit_file_type;
#line 167
        
#line 167
		} # end require
#line 167
	
#line 167

#line 167
	
#line 167
	 	 	
#line 167
##### begin files_search_var_lib(amazon_ssm_agent_t) depth: 4
#line 167
 	
#line 167
	
#line 167
	
#line 167
		require {
#line 167
			
#line 167
		type var_t, var_lib_t;
#line 167
	
#line 167
		} # end require
#line 167
	
#line 167

#line 167

#line 167
	
#line 167
	allow amazon_ssm_agent_t var_t:dir { getattr search open };
#line 167
	allow amazon_ssm_agent_t var_lib_t:dir { getattr search open };
#line 167

#line 167

#line 167
	 	
#line 167
##### end files_search_var_lib(amazon_ssm_agent_t) depth: 3
#line 167
 	
#line 167
	allow amazon_ssm_agent_t systemd_unit_file_type:dir { getattr search open read lock ioctl };
#line 167

#line 167
	 	
#line 167
##### end systemd_list_unit_dirs(amazon_ssm_agent_t) depth: 2
#line 167
 	
#line 167
	 	 	
#line 167
##### begin init_list_pid_dirs(amazon_ssm_agent_t) depth: 3
#line 167
 	
#line 167
    
#line 167
	
#line 167
		require {
#line 167
			
#line 167
        type init_var_run_t;
#line 167
    
#line 167
		} # end require
#line 167
	
#line 167

#line 167

#line 167
    allow amazon_ssm_agent_t init_var_run_t:dir { getattr search open read lock ioctl };
#line 167

#line 167
	 	
#line 167
##### end init_list_pid_dirs(amazon_ssm_agent_t) depth: 2
#line 167
 	
#line 167
	 	 	
#line 167
##### begin init_read_state(amazon_ssm_agent_t) depth: 3
#line 167
 	
#line 167
	
#line 167
	
#line 167
		require {
#line 167
			
#line 167
		type init_t;
#line 167
	
#line 167
		} # end require
#line 167
	
#line 167

#line 167

#line 167
	allow amazon_ssm_agent_t init_t:dir { getattr search open };
#line 167
	allow amazon_ssm_agent_t init_t:file { open { getattr read ioctl lock } };
#line 167
	allow amazon_ssm_agent_t init_t:lnk_file { getattr read };
#line 167

#line 167
	 	
#line 167
##### end init_read_state(amazon_ssm_agent_t) depth: 2
#line 167
 	
#line 167
	 	 	
#line 167
##### begin init_stream_send(amazon_ssm_agent_t) depth: 3
#line 167
 	
#line 167
	
#line 167
	
#line 167
		require {
#line 167
			
#line 167
		type init_t;
#line 167
	
#line 167
		} # end require
#line 167
	
#line 167

#line 167

#line 167
	allow amazon_ssm_agent_t init_t:unix_stream_socket sendto;
#line 167

#line 167
	 	
#line 167
##### end init_stream_send(amazon_ssm_agent_t) depth: 2
#line 167
 	
#line 167
	 	 	
#line 167
##### begin init_stream_connect(amazon_ssm_agent_t) depth: 3
#line 167
 	
#line 167
	
#line 167
	
#line 167
		require {
#line 167
			
#line 167
		type init_t, init_var_run_t;
#line 167
	
#line 167
		} # end require
#line 167
	
#line 167

#line 167

#line 167
	 	 	
#line 167
##### begin files_search_pids(amazon_ssm_agent_t) depth: 4
#line 167
 	
#line 167
	
#line 167
	
#line 167
		require {
#line 167
			
#line 167
		type var_t, var_run_t;
#line 167
	
#line 167
		} # end require
#line 167
	
#line 167

#line 167

#line 167
	allow amazon_ssm_agent_t var_t:lnk_file { getattr read };
#line 167
	allow amazon_ssm_agent_t var_run_t:lnk_file { getattr read };
#line 167
	
#line 167
	allow amazon_ssm_agent_t var_t:dir { getattr search open };
#line 167
	allow amazon_ssm_agent_t var_run_t:dir { getattr search open };
#line 167

#line 167

#line 167
	 	
#line 167
##### end files_search_pids(amazon_ssm_agent_t) depth: 3
#line 167
 	
#line 167
	
#line 167
	allow amazon_ssm_agent_t init_var_run_t:dir { getattr search open };
#line 167
	allow amazon_ssm_agent_t init_var_run_t:sock_file { getattr write open append };
#line 167
	allow amazon_ssm_agent_t init_t:unix_stream_socket connectto;
#line 167
    
#line 167
	allow amazon_ssm_agent_t init_t:unix_stream_socket getattr;
#line 167

#line 167
	 	
#line 167
##### end init_stream_connect(amazon_ssm_agent_t) depth: 2
#line 167
 	
#line 167

#line 167
	 	 	
#line 167
##### begin systemd_login_list_pid_dirs(amazon_ssm_agent_t) depth: 3
#line 167
 	
#line 167
	
#line 167
	
#line 167
		require {
#line 167
			
#line 167
		type systemd_logind_var_run_t;
#line 167
	
#line 167
		} # end require
#line 167
	
#line 167

#line 167

#line 167
	 	 	
#line 167
##### begin files_search_pids(amazon_ssm_agent_t) depth: 4
#line 167
 	
#line 167
	
#line 167
	
#line 167
		require {
#line 167
			
#line 167
		type var_t, var_run_t;
#line 167
	
#line 167
		} # end require
#line 167
	
#line 167

#line 167

#line 167
	allow amazon_ssm_agent_t var_t:lnk_file { getattr read };
#line 167
	allow amazon_ssm_agent_t var_run_t:lnk_file { getattr read };
#line 167
	
#line 167
	allow amazon_ssm_agent_t var_t:dir { getattr search open };
#line 167
	allow amazon_ssm_agent_t var_run_t:dir { getattr search open };
#line 167

#line 167

#line 167
	 	
#line 167
##### end files_search_pids(amazon_ssm_agent_t) depth: 3
#line 167
 	
#line 167
	
#line 167
	allow amazon_ssm_agent_t systemd_logind_var_run_t:dir { getattr search open };
#line 167
	allow amazon_ssm_agent_t systemd_logind_var_run_t:dir { getattr search open read lock ioctl };
#line 167

#line 167

#line 167
	 	
#line 167
##### end systemd_login_list_pid_dirs(amazon_ssm_agent_t) depth: 2
#line 167
 	
#line 167
	 	 	
#line 167
##### begin systemd_login_read_pid_files(amazon_ssm_agent_t) depth: 3
#line 167
 	
#line 167
	
#line 167
	
#line 167
		require {
#line 167
			
#line 167
		type systemd_logind_var_run_t;
#line 167
	
#line 167
		} # end require
#line 167
	
#line 167

#line 167

#line 167
	 	 	
#line 167
##### begin files_search_pids(amazon_ssm_agent_t) depth: 4
#line 167
 	
#line 167
	
#line 167
	
#line 167
		require {
#line 167
			
#line 167
		type var_t, var_run_t;
#line 167
	
#line 167
		} # end require
#line 167
	
#line 167

#line 167

#line 167
	allow amazon_ssm_agent_t var_t:lnk_file { getattr read };
#line 167
	allow amazon_ssm_agent_t var_run_t:lnk_file { getattr read };
#line 167
	
#line 167
	allow amazon_ssm_agent_t var_t:dir { getattr search open };
#line 167
	allow amazon_ssm_agent_t var_run_t:dir { getattr search open };
#line 167

#line 167

#line 167
	 	
#line 167
##### end files_search_pids(amazon_ssm_agent_t) depth: 3
#line 167
 	
#line 167
	
#line 167
	allow amazon_ssm_agent_t systemd_logind_var_run_t:dir { getattr search open };
#line 167
	allow amazon_ssm_agent_t systemd_logind_var_run_t:file { open { getattr read ioctl lock } };
#line 167

#line 167

#line 167
	 	
#line 167
##### end systemd_login_read_pid_files(amazon_ssm_agent_t) depth: 2
#line 167
 	
#line 167
	 	 	
#line 167
##### begin systemd_passwd_agent_exec(amazon_ssm_agent_t) depth: 3
#line 167
 	
#line 167
	
#line 167
	
#line 167
		require {
#line 167
			
#line 167
		type systemd_passwd_agent_t, systemd_passwd_agent_exec_t;
#line 167
	
#line 167
		} # end require
#line 167
	
#line 167

#line 167

#line 167
	allow amazon_ssm_agent_t systemd_passwd_agent_exec_t:file { { getattr open read execute ioctl } ioctl lock execute_no_trans };
#line 167
	 	 	
#line 167
##### begin systemd_manage_passwd_run(amazon_ssm_agent_t) depth: 4
#line 167
 	
#line 167
	
#line 167
	
#line 167
		require {
#line 167
			
#line 167
		type systemd_passwd_agent_t;	
#line 167
		type systemd_passwd_var_run_t;
#line 167
	
#line 167
		} # end require
#line 167
	
#line 167

#line 167

#line 167
	 	 	
#line 167
##### begin init_search_pid_dirs(amazon_ssm_agent_t) depth: 5
#line 167
 	
#line 167
    
#line 167
	
#line 167
		require {
#line 167
			
#line 167
        type init_var_run_t;
#line 167
    
#line 167
		} # end require
#line 167
	
#line 167

#line 167

#line 167
    allow amazon_ssm_agent_t init_var_run_t:dir { getattr search open };
#line 167

#line 167
	 	
#line 167
##### end init_search_pid_dirs(amazon_ssm_agent_t) depth: 4
#line 167
 	
#line 167
	
#line 167
	allow amazon_ssm_agent_t systemd_passwd_var_run_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 167
	allow amazon_ssm_agent_t systemd_passwd_var_run_t:file { create open getattr setattr read write append rename link unlink ioctl lock };
#line 167

#line 167
	
#line 167
	allow amazon_ssm_agent_t systemd_passwd_var_run_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 167
	allow amazon_ssm_agent_t systemd_passwd_var_run_t:sock_file { create open getattr setattr read write rename link unlink ioctl lock append };
#line 167

#line 167
	
#line 167
	allow amazon_ssm_agent_t systemd_passwd_var_run_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 167
	allow amazon_ssm_agent_t systemd_passwd_var_run_t:fifo_file { create open getattr setattr read write append rename link unlink ioctl lock };
#line 167

#line 167

#line 167
	allow systemd_passwd_agent_t amazon_ssm_agent_t:process signull;
#line 167
	allow systemd_passwd_agent_t amazon_ssm_agent_t:unix_dgram_socket sendto;
#line 167

#line 167
	 	
#line 167
##### end systemd_manage_passwd_run(amazon_ssm_agent_t) depth: 3
#line 167
 	
#line 167

#line 167
	 	
#line 167
##### end systemd_passwd_agent_exec(amazon_ssm_agent_t) depth: 2
#line 167
 	
#line 167

#line 167
	dontaudit amazon_ssm_agent_t self:capability net_admin;
#line 167

#line 167
	 	
#line 167
##### end systemd_exec_systemctl(amazon_ssm_agent_t) depth: 1
#line 167
 	
#line 167
	 	 	
#line 167
##### begin init_reload_services(amazon_ssm_agent_t) depth: 2
#line 167
 	
#line 167
	
#line 167
	
#line 167
		require {
#line 167
			
#line 167
		type init_t;
#line 167
	
#line 167
		} # end require
#line 167
	
#line 167

#line 167

#line 167
	allow amazon_ssm_agent_t init_t:system reload;
#line 167

#line 167
	 	
#line 167
##### end init_reload_services(amazon_ssm_agent_t) depth: 1
#line 167
 	
#line 167
	allow amazon_ssm_agent_t chronyd_unit_file_t:file { open { getattr read ioctl lock } };
#line 167
	allow amazon_ssm_agent_t chronyd_unit_file_t:service { start stop status reload enable disable } ;
#line 167

#line 167
	
#line 167
	allow amazon_ssm_agent_t chronyd_t:dir { getattr search open read lock ioctl };
#line 167
	allow amazon_ssm_agent_t chronyd_t:file { open { getattr read ioctl lock } };
#line 167
	allow amazon_ssm_agent_t chronyd_t:lnk_file { getattr read };
#line 167
	allow amazon_ssm_agent_t chronyd_t:process getattr;
#line 167

#line 167

#line 167
	 	
#line 167
##### end chronyd_systemctl(amazon_ssm_agent_t) depth: 0
#line 167
 	

 	 	
#line 169
##### begin getty_systemctl(amazon_ssm_agent_t) depth: 1
#line 169
 	
#line 169
	
#line 169
	
#line 169
		require {
#line 169
			
#line 169
		type getty_unit_file_t;
#line 169
		type getty_t;
#line 169
	
#line 169
		} # end require
#line 169
	
#line 169

#line 169

#line 169
	 	 	
#line 169
##### begin systemd_exec_systemctl(amazon_ssm_agent_t) depth: 2
#line 169
 	
#line 169
        
#line 169
	
#line 169
		require {
#line 169
			
#line 169
                type systemd_systemctl_exec_t;
#line 169
        
#line 169
		} # end require
#line 169
	
#line 169

#line 169

#line 169
	 	 	
#line 169
##### begin corecmd_search_bin(amazon_ssm_agent_t) depth: 3
#line 169
 	
#line 169
	
#line 169
	
#line 169
		require {
#line 169
			
#line 169
		type bin_t;
#line 169
	
#line 169
		} # end require
#line 169
	
#line 169

#line 169

#line 169
	 	 	
#line 169
##### begin corecmd_read_bin_symlinks(amazon_ssm_agent_t) depth: 4
#line 169
 	
#line 169
	
#line 169
	
#line 169
		require {
#line 169
			
#line 169
		type bin_t;
#line 169
	
#line 169
		} # end require
#line 169
	
#line 169

#line 169

#line 169
	
#line 169
	allow amazon_ssm_agent_t bin_t:dir { getattr search open };
#line 169
	allow amazon_ssm_agent_t bin_t:lnk_file { getattr read };
#line 169

#line 169

#line 169
	 	
#line 169
##### end corecmd_read_bin_symlinks(amazon_ssm_agent_t) depth: 3
#line 169
 	
#line 169
	
#line 169
	allow amazon_ssm_agent_t bin_t:dir { getattr search open };
#line 169
	allow amazon_ssm_agent_t bin_t:dir { getattr search open };
#line 169

#line 169

#line 169
	 	
#line 169
##### end corecmd_search_bin(amazon_ssm_agent_t) depth: 2
#line 169
 	
#line 169
	allow amazon_ssm_agent_t systemd_systemctl_exec_t:file { { getattr open read execute ioctl } ioctl lock execute_no_trans };
#line 169

#line 169
	 	 	
#line 169
##### begin fs_list_cgroup_dirs(amazon_ssm_agent_t) depth: 3
#line 169
 	
#line 169
	
#line 169
	
#line 169
		require {
#line 169
			
#line 169
		type cgroup_t;
#line 169
	
#line 169
		} # end require
#line 169
	
#line 169

#line 169

#line 169
	
#line 169
	allow amazon_ssm_agent_t cgroup_t:dir { getattr search open };
#line 169
	allow amazon_ssm_agent_t cgroup_t:dir { getattr search open read lock ioctl };
#line 169

#line 169
	 	 	
#line 169
##### begin fs_search_tmpfs(amazon_ssm_agent_t) depth: 4
#line 169
 	
#line 169
	
#line 169
	
#line 169
		require {
#line 169
			
#line 169
		type tmpfs_t;
#line 169
	
#line 169
		} # end require
#line 169
	
#line 169

#line 169

#line 169
	allow amazon_ssm_agent_t tmpfs_t:dir { getattr search open };
#line 169

#line 169
	 	
#line 169
##### end fs_search_tmpfs(amazon_ssm_agent_t) depth: 3
#line 169
 	
#line 169
	 	 	
#line 169
##### begin dev_search_sysfs(amazon_ssm_agent_t) depth: 4
#line 169
 	
#line 169
	
#line 169
	
#line 169
		require {
#line 169
			
#line 169
		type sysfs_t;
#line 169
	
#line 169
		} # end require
#line 169
	
#line 169

#line 169

#line 169
	
#line 169
	allow amazon_ssm_agent_t sysfs_t:dir { getattr search open };
#line 169
	allow amazon_ssm_agent_t sysfs_t:dir { getattr search open };
#line 169

#line 169

#line 169
	 	
#line 169
##### end dev_search_sysfs(amazon_ssm_agent_t) depth: 3
#line 169
 	
#line 169

#line 169
	 	
#line 169
##### end fs_list_cgroup_dirs(amazon_ssm_agent_t) depth: 2
#line 169
 	
#line 169
	 	 	
#line 169
##### begin fs_read_cgroup_files(amazon_ssm_agent_t) depth: 3
#line 169
 	
#line 169
	
#line 169
	
#line 169
		require {
#line 169
			
#line 169
		type cgroup_t;
#line 169

#line 169
	
#line 169
		} # end require
#line 169
	
#line 169

#line 169

#line 169
	
#line 169
	allow amazon_ssm_agent_t cgroup_t:dir { getattr search open };
#line 169
	allow amazon_ssm_agent_t cgroup_t:file { open { getattr read ioctl lock } };
#line 169

#line 169
	
#line 169
	allow amazon_ssm_agent_t cgroup_t:dir { getattr search open };
#line 169
	allow amazon_ssm_agent_t cgroup_t:lnk_file { getattr read };
#line 169

#line 169
	 	 	
#line 169
##### begin fs_search_tmpfs(amazon_ssm_agent_t) depth: 4
#line 169
 	
#line 169
	
#line 169
	
#line 169
		require {
#line 169
			
#line 169
		type tmpfs_t;
#line 169
	
#line 169
		} # end require
#line 169
	
#line 169

#line 169

#line 169
	allow amazon_ssm_agent_t tmpfs_t:dir { getattr search open };
#line 169

#line 169
	 	
#line 169
##### end fs_search_tmpfs(amazon_ssm_agent_t) depth: 3
#line 169
 	
#line 169
	 	 	
#line 169
##### begin dev_search_sysfs(amazon_ssm_agent_t) depth: 4
#line 169
 	
#line 169
	
#line 169
	
#line 169
		require {
#line 169
			
#line 169
		type sysfs_t;
#line 169
	
#line 169
		} # end require
#line 169
	
#line 169

#line 169

#line 169
	
#line 169
	allow amazon_ssm_agent_t sysfs_t:dir { getattr search open };
#line 169
	allow amazon_ssm_agent_t sysfs_t:dir { getattr search open };
#line 169

#line 169

#line 169
	 	
#line 169
##### end dev_search_sysfs(amazon_ssm_agent_t) depth: 3
#line 169
 	
#line 169

#line 169
	 	
#line 169
##### end fs_read_cgroup_files(amazon_ssm_agent_t) depth: 2
#line 169
 	
#line 169
	 	 	
#line 169
##### begin systemd_list_unit_dirs(amazon_ssm_agent_t) depth: 3
#line 169
 	
#line 169
        
#line 169
	
#line 169
		require {
#line 169
			
#line 169
                attribute systemd_unit_file_type;
#line 169
        
#line 169
		} # end require
#line 169
	
#line 169

#line 169
	
#line 169
	 	 	
#line 169
##### begin files_search_var_lib(amazon_ssm_agent_t) depth: 4
#line 169
 	
#line 169
	
#line 169
	
#line 169
		require {
#line 169
			
#line 169
		type var_t, var_lib_t;
#line 169
	
#line 169
		} # end require
#line 169
	
#line 169

#line 169

#line 169
	
#line 169
	allow amazon_ssm_agent_t var_t:dir { getattr search open };
#line 169
	allow amazon_ssm_agent_t var_lib_t:dir { getattr search open };
#line 169

#line 169

#line 169
	 	
#line 169
##### end files_search_var_lib(amazon_ssm_agent_t) depth: 3
#line 169
 	
#line 169
	allow amazon_ssm_agent_t systemd_unit_file_type:dir { getattr search open read lock ioctl };
#line 169

#line 169
	 	
#line 169
##### end systemd_list_unit_dirs(amazon_ssm_agent_t) depth: 2
#line 169
 	
#line 169
	 	 	
#line 169
##### begin init_list_pid_dirs(amazon_ssm_agent_t) depth: 3
#line 169
 	
#line 169
    
#line 169
	
#line 169
		require {
#line 169
			
#line 169
        type init_var_run_t;
#line 169
    
#line 169
		} # end require
#line 169
	
#line 169

#line 169

#line 169
    allow amazon_ssm_agent_t init_var_run_t:dir { getattr search open read lock ioctl };
#line 169

#line 169
	 	
#line 169
##### end init_list_pid_dirs(amazon_ssm_agent_t) depth: 2
#line 169
 	
#line 169
	 	 	
#line 169
##### begin init_read_state(amazon_ssm_agent_t) depth: 3
#line 169
 	
#line 169
	
#line 169
	
#line 169
		require {
#line 169
			
#line 169
		type init_t;
#line 169
	
#line 169
		} # end require
#line 169
	
#line 169

#line 169

#line 169
	allow amazon_ssm_agent_t init_t:dir { getattr search open };
#line 169
	allow amazon_ssm_agent_t init_t:file { open { getattr read ioctl lock } };
#line 169
	allow amazon_ssm_agent_t init_t:lnk_file { getattr read };
#line 169

#line 169
	 	
#line 169
##### end init_read_state(amazon_ssm_agent_t) depth: 2
#line 169
 	
#line 169
	 	 	
#line 169
##### begin init_stream_send(amazon_ssm_agent_t) depth: 3
#line 169
 	
#line 169
	
#line 169
	
#line 169
		require {
#line 169
			
#line 169
		type init_t;
#line 169
	
#line 169
		} # end require
#line 169
	
#line 169

#line 169

#line 169
	allow amazon_ssm_agent_t init_t:unix_stream_socket sendto;
#line 169

#line 169
	 	
#line 169
##### end init_stream_send(amazon_ssm_agent_t) depth: 2
#line 169
 	
#line 169
	 	 	
#line 169
##### begin init_stream_connect(amazon_ssm_agent_t) depth: 3
#line 169
 	
#line 169
	
#line 169
	
#line 169
		require {
#line 169
			
#line 169
		type init_t, init_var_run_t;
#line 169
	
#line 169
		} # end require
#line 169
	
#line 169

#line 169

#line 169
	 	 	
#line 169
##### begin files_search_pids(amazon_ssm_agent_t) depth: 4
#line 169
 	
#line 169
	
#line 169
	
#line 169
		require {
#line 169
			
#line 169
		type var_t, var_run_t;
#line 169
	
#line 169
		} # end require
#line 169
	
#line 169

#line 169

#line 169
	allow amazon_ssm_agent_t var_t:lnk_file { getattr read };
#line 169
	allow amazon_ssm_agent_t var_run_t:lnk_file { getattr read };
#line 169
	
#line 169
	allow amazon_ssm_agent_t var_t:dir { getattr search open };
#line 169
	allow amazon_ssm_agent_t var_run_t:dir { getattr search open };
#line 169

#line 169

#line 169
	 	
#line 169
##### end files_search_pids(amazon_ssm_agent_t) depth: 3
#line 169
 	
#line 169
	
#line 169
	allow amazon_ssm_agent_t init_var_run_t:dir { getattr search open };
#line 169
	allow amazon_ssm_agent_t init_var_run_t:sock_file { getattr write open append };
#line 169
	allow amazon_ssm_agent_t init_t:unix_stream_socket connectto;
#line 169
    
#line 169
	allow amazon_ssm_agent_t init_t:unix_stream_socket getattr;
#line 169

#line 169
	 	
#line 169
##### end init_stream_connect(amazon_ssm_agent_t) depth: 2
#line 169
 	
#line 169

#line 169
	 	 	
#line 169
##### begin systemd_login_list_pid_dirs(amazon_ssm_agent_t) depth: 3
#line 169
 	
#line 169
	
#line 169
	
#line 169
		require {
#line 169
			
#line 169
		type systemd_logind_var_run_t;
#line 169
	
#line 169
		} # end require
#line 169
	
#line 169

#line 169

#line 169
	 	 	
#line 169
##### begin files_search_pids(amazon_ssm_agent_t) depth: 4
#line 169
 	
#line 169
	
#line 169
	
#line 169
		require {
#line 169
			
#line 169
		type var_t, var_run_t;
#line 169
	
#line 169
		} # end require
#line 169
	
#line 169

#line 169

#line 169
	allow amazon_ssm_agent_t var_t:lnk_file { getattr read };
#line 169
	allow amazon_ssm_agent_t var_run_t:lnk_file { getattr read };
#line 169
	
#line 169
	allow amazon_ssm_agent_t var_t:dir { getattr search open };
#line 169
	allow amazon_ssm_agent_t var_run_t:dir { getattr search open };
#line 169

#line 169

#line 169
	 	
#line 169
##### end files_search_pids(amazon_ssm_agent_t) depth: 3
#line 169
 	
#line 169
	
#line 169
	allow amazon_ssm_agent_t systemd_logind_var_run_t:dir { getattr search open };
#line 169
	allow amazon_ssm_agent_t systemd_logind_var_run_t:dir { getattr search open read lock ioctl };
#line 169

#line 169

#line 169
	 	
#line 169
##### end systemd_login_list_pid_dirs(amazon_ssm_agent_t) depth: 2
#line 169
 	
#line 169
	 	 	
#line 169
##### begin systemd_login_read_pid_files(amazon_ssm_agent_t) depth: 3
#line 169
 	
#line 169
	
#line 169
	
#line 169
		require {
#line 169
			
#line 169
		type systemd_logind_var_run_t;
#line 169
	
#line 169
		} # end require
#line 169
	
#line 169

#line 169

#line 169
	 	 	
#line 169
##### begin files_search_pids(amazon_ssm_agent_t) depth: 4
#line 169
 	
#line 169
	
#line 169
	
#line 169
		require {
#line 169
			
#line 169
		type var_t, var_run_t;
#line 169
	
#line 169
		} # end require
#line 169
	
#line 169

#line 169

#line 169
	allow amazon_ssm_agent_t var_t:lnk_file { getattr read };
#line 169
	allow amazon_ssm_agent_t var_run_t:lnk_file { getattr read };
#line 169
	
#line 169
	allow amazon_ssm_agent_t var_t:dir { getattr search open };
#line 169
	allow amazon_ssm_agent_t var_run_t:dir { getattr search open };
#line 169

#line 169

#line 169
	 	
#line 169
##### end files_search_pids(amazon_ssm_agent_t) depth: 3
#line 169
 	
#line 169
	
#line 169
	allow amazon_ssm_agent_t systemd_logind_var_run_t:dir { getattr search open };
#line 169
	allow amazon_ssm_agent_t systemd_logind_var_run_t:file { open { getattr read ioctl lock } };
#line 169

#line 169

#line 169
	 	
#line 169
##### end systemd_login_read_pid_files(amazon_ssm_agent_t) depth: 2
#line 169
 	
#line 169
	 	 	
#line 169
##### begin systemd_passwd_agent_exec(amazon_ssm_agent_t) depth: 3
#line 169
 	
#line 169
	
#line 169
	
#line 169
		require {
#line 169
			
#line 169
		type systemd_passwd_agent_t, systemd_passwd_agent_exec_t;
#line 169
	
#line 169
		} # end require
#line 169
	
#line 169

#line 169

#line 169
	allow amazon_ssm_agent_t systemd_passwd_agent_exec_t:file { { getattr open read execute ioctl } ioctl lock execute_no_trans };
#line 169
	 	 	
#line 169
##### begin systemd_manage_passwd_run(amazon_ssm_agent_t) depth: 4
#line 169
 	
#line 169
	
#line 169
	
#line 169
		require {
#line 169
			
#line 169
		type systemd_passwd_agent_t;	
#line 169
		type systemd_passwd_var_run_t;
#line 169
	
#line 169
		} # end require
#line 169
	
#line 169

#line 169

#line 169
	 	 	
#line 169
##### begin init_search_pid_dirs(amazon_ssm_agent_t) depth: 5
#line 169
 	
#line 169
    
#line 169
	
#line 169
		require {
#line 169
			
#line 169
        type init_var_run_t;
#line 169
    
#line 169
		} # end require
#line 169
	
#line 169

#line 169

#line 169
    allow amazon_ssm_agent_t init_var_run_t:dir { getattr search open };
#line 169

#line 169
	 	
#line 169
##### end init_search_pid_dirs(amazon_ssm_agent_t) depth: 4
#line 169
 	
#line 169
	
#line 169
	allow amazon_ssm_agent_t systemd_passwd_var_run_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 169
	allow amazon_ssm_agent_t systemd_passwd_var_run_t:file { create open getattr setattr read write append rename link unlink ioctl lock };
#line 169

#line 169
	
#line 169
	allow amazon_ssm_agent_t systemd_passwd_var_run_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 169
	allow amazon_ssm_agent_t systemd_passwd_var_run_t:sock_file { create open getattr setattr read write rename link unlink ioctl lock append };
#line 169

#line 169
	
#line 169
	allow amazon_ssm_agent_t systemd_passwd_var_run_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 169
	allow amazon_ssm_agent_t systemd_passwd_var_run_t:fifo_file { create open getattr setattr read write append rename link unlink ioctl lock };
#line 169

#line 169

#line 169
	allow systemd_passwd_agent_t amazon_ssm_agent_t:process signull;
#line 169
	allow systemd_passwd_agent_t amazon_ssm_agent_t:unix_dgram_socket sendto;
#line 169

#line 169
	 	
#line 169
##### end systemd_manage_passwd_run(amazon_ssm_agent_t) depth: 3
#line 169
 	
#line 169

#line 169
	 	
#line 169
##### end systemd_passwd_agent_exec(amazon_ssm_agent_t) depth: 2
#line 169
 	
#line 169

#line 169
	dontaudit amazon_ssm_agent_t self:capability net_admin;
#line 169

#line 169
	 	
#line 169
##### end systemd_exec_systemctl(amazon_ssm_agent_t) depth: 1
#line 169
 	
#line 169
	allow amazon_ssm_agent_t getty_unit_file_t:file { open { getattr read ioctl lock } };
#line 169
	allow amazon_ssm_agent_t getty_unit_file_t:service { start stop status reload enable disable } ;
#line 169

#line 169
	
#line 169
	allow amazon_ssm_agent_t getty_t:dir { getattr search open read lock ioctl };
#line 169
	allow amazon_ssm_agent_t getty_t:file { open { getattr read ioctl lock } };
#line 169
	allow amazon_ssm_agent_t getty_t:lnk_file { getattr read };
#line 169
	allow amazon_ssm_agent_t getty_t:process getattr;
#line 169

#line 169

#line 169
	 	
#line 169
##### end getty_systemctl(amazon_ssm_agent_t) depth: 0
#line 169
 	

 	 	
#line 171
##### begin apmd_systemctl(amazon_ssm_agent_t) depth: 1
#line 171
 	
#line 171
	
#line 171
	
#line 171
		require {
#line 171
			
#line 171
		type apmd_t;
#line 171
		type apmd_unit_file_t;
#line 171
	
#line 171
		} # end require
#line 171
	
#line 171

#line 171

#line 171
	 	 	
#line 171
##### begin systemd_exec_systemctl(amazon_ssm_agent_t) depth: 2
#line 171
 	
#line 171
        
#line 171
	
#line 171
		require {
#line 171
			
#line 171
                type systemd_systemctl_exec_t;
#line 171
        
#line 171
		} # end require
#line 171
	
#line 171

#line 171

#line 171
	 	 	
#line 171
##### begin corecmd_search_bin(amazon_ssm_agent_t) depth: 3
#line 171
 	
#line 171
	
#line 171
	
#line 171
		require {
#line 171
			
#line 171
		type bin_t;
#line 171
	
#line 171
		} # end require
#line 171
	
#line 171

#line 171

#line 171
	 	 	
#line 171
##### begin corecmd_read_bin_symlinks(amazon_ssm_agent_t) depth: 4
#line 171
 	
#line 171
	
#line 171
	
#line 171
		require {
#line 171
			
#line 171
		type bin_t;
#line 171
	
#line 171
		} # end require
#line 171
	
#line 171

#line 171

#line 171
	
#line 171
	allow amazon_ssm_agent_t bin_t:dir { getattr search open };
#line 171
	allow amazon_ssm_agent_t bin_t:lnk_file { getattr read };
#line 171

#line 171

#line 171
	 	
#line 171
##### end corecmd_read_bin_symlinks(amazon_ssm_agent_t) depth: 3
#line 171
 	
#line 171
	
#line 171
	allow amazon_ssm_agent_t bin_t:dir { getattr search open };
#line 171
	allow amazon_ssm_agent_t bin_t:dir { getattr search open };
#line 171

#line 171

#line 171
	 	
#line 171
##### end corecmd_search_bin(amazon_ssm_agent_t) depth: 2
#line 171
 	
#line 171
	allow amazon_ssm_agent_t systemd_systemctl_exec_t:file { { getattr open read execute ioctl } ioctl lock execute_no_trans };
#line 171

#line 171
	 	 	
#line 171
##### begin fs_list_cgroup_dirs(amazon_ssm_agent_t) depth: 3
#line 171
 	
#line 171
	
#line 171
	
#line 171
		require {
#line 171
			
#line 171
		type cgroup_t;
#line 171
	
#line 171
		} # end require
#line 171
	
#line 171

#line 171

#line 171
	
#line 171
	allow amazon_ssm_agent_t cgroup_t:dir { getattr search open };
#line 171
	allow amazon_ssm_agent_t cgroup_t:dir { getattr search open read lock ioctl };
#line 171

#line 171
	 	 	
#line 171
##### begin fs_search_tmpfs(amazon_ssm_agent_t) depth: 4
#line 171
 	
#line 171
	
#line 171
	
#line 171
		require {
#line 171
			
#line 171
		type tmpfs_t;
#line 171
	
#line 171
		} # end require
#line 171
	
#line 171

#line 171

#line 171
	allow amazon_ssm_agent_t tmpfs_t:dir { getattr search open };
#line 171

#line 171
	 	
#line 171
##### end fs_search_tmpfs(amazon_ssm_agent_t) depth: 3
#line 171
 	
#line 171
	 	 	
#line 171
##### begin dev_search_sysfs(amazon_ssm_agent_t) depth: 4
#line 171
 	
#line 171
	
#line 171
	
#line 171
		require {
#line 171
			
#line 171
		type sysfs_t;
#line 171
	
#line 171
		} # end require
#line 171
	
#line 171

#line 171

#line 171
	
#line 171
	allow amazon_ssm_agent_t sysfs_t:dir { getattr search open };
#line 171
	allow amazon_ssm_agent_t sysfs_t:dir { getattr search open };
#line 171

#line 171

#line 171
	 	
#line 171
##### end dev_search_sysfs(amazon_ssm_agent_t) depth: 3
#line 171
 	
#line 171

#line 171
	 	
#line 171
##### end fs_list_cgroup_dirs(amazon_ssm_agent_t) depth: 2
#line 171
 	
#line 171
	 	 	
#line 171
##### begin fs_read_cgroup_files(amazon_ssm_agent_t) depth: 3
#line 171
 	
#line 171
	
#line 171
	
#line 171
		require {
#line 171
			
#line 171
		type cgroup_t;
#line 171

#line 171
	
#line 171
		} # end require
#line 171
	
#line 171

#line 171

#line 171
	
#line 171
	allow amazon_ssm_agent_t cgroup_t:dir { getattr search open };
#line 171
	allow amazon_ssm_agent_t cgroup_t:file { open { getattr read ioctl lock } };
#line 171

#line 171
	
#line 171
	allow amazon_ssm_agent_t cgroup_t:dir { getattr search open };
#line 171
	allow amazon_ssm_agent_t cgroup_t:lnk_file { getattr read };
#line 171

#line 171
	 	 	
#line 171
##### begin fs_search_tmpfs(amazon_ssm_agent_t) depth: 4
#line 171
 	
#line 171
	
#line 171
	
#line 171
		require {
#line 171
			
#line 171
		type tmpfs_t;
#line 171
	
#line 171
		} # end require
#line 171
	
#line 171

#line 171

#line 171
	allow amazon_ssm_agent_t tmpfs_t:dir { getattr search open };
#line 171

#line 171
	 	
#line 171
##### end fs_search_tmpfs(amazon_ssm_agent_t) depth: 3
#line 171
 	
#line 171
	 	 	
#line 171
##### begin dev_search_sysfs(amazon_ssm_agent_t) depth: 4
#line 171
 	
#line 171
	
#line 171
	
#line 171
		require {
#line 171
			
#line 171
		type sysfs_t;
#line 171
	
#line 171
		} # end require
#line 171
	
#line 171

#line 171

#line 171
	
#line 171
	allow amazon_ssm_agent_t sysfs_t:dir { getattr search open };
#line 171
	allow amazon_ssm_agent_t sysfs_t:dir { getattr search open };
#line 171

#line 171

#line 171
	 	
#line 171
##### end dev_search_sysfs(amazon_ssm_agent_t) depth: 3
#line 171
 	
#line 171

#line 171
	 	
#line 171
##### end fs_read_cgroup_files(amazon_ssm_agent_t) depth: 2
#line 171
 	
#line 171
	 	 	
#line 171
##### begin systemd_list_unit_dirs(amazon_ssm_agent_t) depth: 3
#line 171
 	
#line 171
        
#line 171
	
#line 171
		require {
#line 171
			
#line 171
                attribute systemd_unit_file_type;
#line 171
        
#line 171
		} # end require
#line 171
	
#line 171

#line 171
	
#line 171
	 	 	
#line 171
##### begin files_search_var_lib(amazon_ssm_agent_t) depth: 4
#line 171
 	
#line 171
	
#line 171
	
#line 171
		require {
#line 171
			
#line 171
		type var_t, var_lib_t;
#line 171
	
#line 171
		} # end require
#line 171
	
#line 171

#line 171

#line 171
	
#line 171
	allow amazon_ssm_agent_t var_t:dir { getattr search open };
#line 171
	allow amazon_ssm_agent_t var_lib_t:dir { getattr search open };
#line 171

#line 171

#line 171
	 	
#line 171
##### end files_search_var_lib(amazon_ssm_agent_t) depth: 3
#line 171
 	
#line 171
	allow amazon_ssm_agent_t systemd_unit_file_type:dir { getattr search open read lock ioctl };
#line 171

#line 171
	 	
#line 171
##### end systemd_list_unit_dirs(amazon_ssm_agent_t) depth: 2
#line 171
 	
#line 171
	 	 	
#line 171
##### begin init_list_pid_dirs(amazon_ssm_agent_t) depth: 3
#line 171
 	
#line 171
    
#line 171
	
#line 171
		require {
#line 171
			
#line 171
        type init_var_run_t;
#line 171
    
#line 171
		} # end require
#line 171
	
#line 171

#line 171

#line 171
    allow amazon_ssm_agent_t init_var_run_t:dir { getattr search open read lock ioctl };
#line 171

#line 171
	 	
#line 171
##### end init_list_pid_dirs(amazon_ssm_agent_t) depth: 2
#line 171
 	
#line 171
	 	 	
#line 171
##### begin init_read_state(amazon_ssm_agent_t) depth: 3
#line 171
 	
#line 171
	
#line 171
	
#line 171
		require {
#line 171
			
#line 171
		type init_t;
#line 171
	
#line 171
		} # end require
#line 171
	
#line 171

#line 171

#line 171
	allow amazon_ssm_agent_t init_t:dir { getattr search open };
#line 171
	allow amazon_ssm_agent_t init_t:file { open { getattr read ioctl lock } };
#line 171
	allow amazon_ssm_agent_t init_t:lnk_file { getattr read };
#line 171

#line 171
	 	
#line 171
##### end init_read_state(amazon_ssm_agent_t) depth: 2
#line 171
 	
#line 171
	 	 	
#line 171
##### begin init_stream_send(amazon_ssm_agent_t) depth: 3
#line 171
 	
#line 171
	
#line 171
	
#line 171
		require {
#line 171
			
#line 171
		type init_t;
#line 171
	
#line 171
		} # end require
#line 171
	
#line 171

#line 171

#line 171
	allow amazon_ssm_agent_t init_t:unix_stream_socket sendto;
#line 171

#line 171
	 	
#line 171
##### end init_stream_send(amazon_ssm_agent_t) depth: 2
#line 171
 	
#line 171
	 	 	
#line 171
##### begin init_stream_connect(amazon_ssm_agent_t) depth: 3
#line 171
 	
#line 171
	
#line 171
	
#line 171
		require {
#line 171
			
#line 171
		type init_t, init_var_run_t;
#line 171
	
#line 171
		} # end require
#line 171
	
#line 171

#line 171

#line 171
	 	 	
#line 171
##### begin files_search_pids(amazon_ssm_agent_t) depth: 4
#line 171
 	
#line 171
	
#line 171
	
#line 171
		require {
#line 171
			
#line 171
		type var_t, var_run_t;
#line 171
	
#line 171
		} # end require
#line 171
	
#line 171

#line 171

#line 171
	allow amazon_ssm_agent_t var_t:lnk_file { getattr read };
#line 171
	allow amazon_ssm_agent_t var_run_t:lnk_file { getattr read };
#line 171
	
#line 171
	allow amazon_ssm_agent_t var_t:dir { getattr search open };
#line 171
	allow amazon_ssm_agent_t var_run_t:dir { getattr search open };
#line 171

#line 171

#line 171
	 	
#line 171
##### end files_search_pids(amazon_ssm_agent_t) depth: 3
#line 171
 	
#line 171
	
#line 171
	allow amazon_ssm_agent_t init_var_run_t:dir { getattr search open };
#line 171
	allow amazon_ssm_agent_t init_var_run_t:sock_file { getattr write open append };
#line 171
	allow amazon_ssm_agent_t init_t:unix_stream_socket connectto;
#line 171
    
#line 171
	allow amazon_ssm_agent_t init_t:unix_stream_socket getattr;
#line 171

#line 171
	 	
#line 171
##### end init_stream_connect(amazon_ssm_agent_t) depth: 2
#line 171
 	
#line 171

#line 171
	 	 	
#line 171
##### begin systemd_login_list_pid_dirs(amazon_ssm_agent_t) depth: 3
#line 171
 	
#line 171
	
#line 171
	
#line 171
		require {
#line 171
			
#line 171
		type systemd_logind_var_run_t;
#line 171
	
#line 171
		} # end require
#line 171
	
#line 171

#line 171

#line 171
	 	 	
#line 171
##### begin files_search_pids(amazon_ssm_agent_t) depth: 4
#line 171
 	
#line 171
	
#line 171
	
#line 171
		require {
#line 171
			
#line 171
		type var_t, var_run_t;
#line 171
	
#line 171
		} # end require
#line 171
	
#line 171

#line 171

#line 171
	allow amazon_ssm_agent_t var_t:lnk_file { getattr read };
#line 171
	allow amazon_ssm_agent_t var_run_t:lnk_file { getattr read };
#line 171
	
#line 171
	allow amazon_ssm_agent_t var_t:dir { getattr search open };
#line 171
	allow amazon_ssm_agent_t var_run_t:dir { getattr search open };
#line 171

#line 171

#line 171
	 	
#line 171
##### end files_search_pids(amazon_ssm_agent_t) depth: 3
#line 171
 	
#line 171
	
#line 171
	allow amazon_ssm_agent_t systemd_logind_var_run_t:dir { getattr search open };
#line 171
	allow amazon_ssm_agent_t systemd_logind_var_run_t:dir { getattr search open read lock ioctl };
#line 171

#line 171

#line 171
	 	
#line 171
##### end systemd_login_list_pid_dirs(amazon_ssm_agent_t) depth: 2
#line 171
 	
#line 171
	 	 	
#line 171
##### begin systemd_login_read_pid_files(amazon_ssm_agent_t) depth: 3
#line 171
 	
#line 171
	
#line 171
	
#line 171
		require {
#line 171
			
#line 171
		type systemd_logind_var_run_t;
#line 171
	
#line 171
		} # end require
#line 171
	
#line 171

#line 171

#line 171
	 	 	
#line 171
##### begin files_search_pids(amazon_ssm_agent_t) depth: 4
#line 171
 	
#line 171
	
#line 171
	
#line 171
		require {
#line 171
			
#line 171
		type var_t, var_run_t;
#line 171
	
#line 171
		} # end require
#line 171
	
#line 171

#line 171

#line 171
	allow amazon_ssm_agent_t var_t:lnk_file { getattr read };
#line 171
	allow amazon_ssm_agent_t var_run_t:lnk_file { getattr read };
#line 171
	
#line 171
	allow amazon_ssm_agent_t var_t:dir { getattr search open };
#line 171
	allow amazon_ssm_agent_t var_run_t:dir { getattr search open };
#line 171

#line 171

#line 171
	 	
#line 171
##### end files_search_pids(amazon_ssm_agent_t) depth: 3
#line 171
 	
#line 171
	
#line 171
	allow amazon_ssm_agent_t systemd_logind_var_run_t:dir { getattr search open };
#line 171
	allow amazon_ssm_agent_t systemd_logind_var_run_t:file { open { getattr read ioctl lock } };
#line 171

#line 171

#line 171
	 	
#line 171
##### end systemd_login_read_pid_files(amazon_ssm_agent_t) depth: 2
#line 171
 	
#line 171
	 	 	
#line 171
##### begin systemd_passwd_agent_exec(amazon_ssm_agent_t) depth: 3
#line 171
 	
#line 171
	
#line 171
	
#line 171
		require {
#line 171
			
#line 171
		type systemd_passwd_agent_t, systemd_passwd_agent_exec_t;
#line 171
	
#line 171
		} # end require
#line 171
	
#line 171

#line 171

#line 171
	allow amazon_ssm_agent_t systemd_passwd_agent_exec_t:file { { getattr open read execute ioctl } ioctl lock execute_no_trans };
#line 171
	 	 	
#line 171
##### begin systemd_manage_passwd_run(amazon_ssm_agent_t) depth: 4
#line 171
 	
#line 171
	
#line 171
	
#line 171
		require {
#line 171
			
#line 171
		type systemd_passwd_agent_t;	
#line 171
		type systemd_passwd_var_run_t;
#line 171
	
#line 171
		} # end require
#line 171
	
#line 171

#line 171

#line 171
	 	 	
#line 171
##### begin init_search_pid_dirs(amazon_ssm_agent_t) depth: 5
#line 171
 	
#line 171
    
#line 171
	
#line 171
		require {
#line 171
			
#line 171
        type init_var_run_t;
#line 171
    
#line 171
		} # end require
#line 171
	
#line 171

#line 171

#line 171
    allow amazon_ssm_agent_t init_var_run_t:dir { getattr search open };
#line 171

#line 171
	 	
#line 171
##### end init_search_pid_dirs(amazon_ssm_agent_t) depth: 4
#line 171
 	
#line 171
	
#line 171
	allow amazon_ssm_agent_t systemd_passwd_var_run_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 171
	allow amazon_ssm_agent_t systemd_passwd_var_run_t:file { create open getattr setattr read write append rename link unlink ioctl lock };
#line 171

#line 171
	
#line 171
	allow amazon_ssm_agent_t systemd_passwd_var_run_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 171
	allow amazon_ssm_agent_t systemd_passwd_var_run_t:sock_file { create open getattr setattr read write rename link unlink ioctl lock append };
#line 171

#line 171
	
#line 171
	allow amazon_ssm_agent_t systemd_passwd_var_run_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 171
	allow amazon_ssm_agent_t systemd_passwd_var_run_t:fifo_file { create open getattr setattr read write append rename link unlink ioctl lock };
#line 171

#line 171

#line 171
	allow systemd_passwd_agent_t amazon_ssm_agent_t:process signull;
#line 171
	allow systemd_passwd_agent_t amazon_ssm_agent_t:unix_dgram_socket sendto;
#line 171

#line 171
	 	
#line 171
##### end systemd_manage_passwd_run(amazon_ssm_agent_t) depth: 3
#line 171
 	
#line 171

#line 171
	 	
#line 171
##### end systemd_passwd_agent_exec(amazon_ssm_agent_t) depth: 2
#line 171
 	
#line 171

#line 171
	dontaudit amazon_ssm_agent_t self:capability net_admin;
#line 171

#line 171
	 	
#line 171
##### end systemd_exec_systemctl(amazon_ssm_agent_t) depth: 1
#line 171
 	
#line 171
	 	 	
#line 171
##### begin init_reload_services(amazon_ssm_agent_t) depth: 2
#line 171
 	
#line 171
	
#line 171
	
#line 171
		require {
#line 171
			
#line 171
		type init_t;
#line 171
	
#line 171
		} # end require
#line 171
	
#line 171

#line 171

#line 171
	allow amazon_ssm_agent_t init_t:system reload;
#line 171

#line 171
	 	
#line 171
##### end init_reload_services(amazon_ssm_agent_t) depth: 1
#line 171
 	
#line 171
	allow amazon_ssm_agent_t apmd_unit_file_t:file { open { getattr read ioctl lock } };
#line 171
	allow amazon_ssm_agent_t apmd_unit_file_t:service { start stop status reload enable disable } ;
#line 171

#line 171
	
#line 171
	allow amazon_ssm_agent_t apmd_t:dir { getattr search open read lock ioctl };
#line 171
	allow amazon_ssm_agent_t apmd_t:file { open { getattr read ioctl lock } };
#line 171
	allow amazon_ssm_agent_t apmd_t:lnk_file { getattr read };
#line 171
	allow amazon_ssm_agent_t apmd_t:process getattr;
#line 171

#line 171

#line 171
	 	
#line 171
##### end apmd_systemctl(amazon_ssm_agent_t) depth: 0
#line 171
 	

 	 	
#line 173
##### begin postfix_read_master_state(amazon_ssm_agent_t) depth: 1
#line 173
 	
#line 173
	
#line 173
	
#line 173
		require {
#line 173
			
#line 173
		type postfix_master_t;
#line 173
	
#line 173
		} # end require
#line 173
	
#line 173

#line 173

#line 173
	 	 	
#line 173
##### begin kernel_search_proc(amazon_ssm_agent_t) depth: 2
#line 173
 	
#line 173
	
#line 173
	
#line 173
		require {
#line 173
			
#line 173
		type proc_t;
#line 173
	
#line 173
		} # end require
#line 173
	
#line 173

#line 173

#line 173
	
#line 173
	allow amazon_ssm_agent_t proc_t:dir { getattr search open };
#line 173
	allow amazon_ssm_agent_t proc_t:dir { getattr search open };
#line 173

#line 173

#line 173
	 	
#line 173
##### end kernel_search_proc(amazon_ssm_agent_t) depth: 1
#line 173
 	
#line 173
	
#line 173
	allow amazon_ssm_agent_t postfix_master_t:dir { getattr search open read lock ioctl };
#line 173
	allow amazon_ssm_agent_t postfix_master_t:file { open { getattr read ioctl lock } };
#line 173
	allow amazon_ssm_agent_t postfix_master_t:lnk_file { getattr read };
#line 173
	allow amazon_ssm_agent_t postfix_master_t:process getattr;
#line 173

#line 173

#line 173
	 	
#line 173
##### end postfix_read_master_state(amazon_ssm_agent_t) depth: 0
#line 173
 	

 	 	
#line 175
##### begin rng_systemctl_rngd(amazon_ssm_agent_t) depth: 1
#line 175
 	
#line 175
	
#line 175
	
#line 175
		require {
#line 175
			
#line 175
		type rngd_t, rngd_unit_file_t;
#line 175
	
#line 175
		} # end require
#line 175
	
#line 175

#line 175

#line 175
	 	 	
#line 175
##### begin systemd_exec_systemctl(amazon_ssm_agent_t) depth: 2
#line 175
 	
#line 175
        
#line 175
	
#line 175
		require {
#line 175
			
#line 175
                type systemd_systemctl_exec_t;
#line 175
        
#line 175
		} # end require
#line 175
	
#line 175

#line 175

#line 175
	 	 	
#line 175
##### begin corecmd_search_bin(amazon_ssm_agent_t) depth: 3
#line 175
 	
#line 175
	
#line 175
	
#line 175
		require {
#line 175
			
#line 175
		type bin_t;
#line 175
	
#line 175
		} # end require
#line 175
	
#line 175

#line 175

#line 175
	 	 	
#line 175
##### begin corecmd_read_bin_symlinks(amazon_ssm_agent_t) depth: 4
#line 175
 	
#line 175
	
#line 175
	
#line 175
		require {
#line 175
			
#line 175
		type bin_t;
#line 175
	
#line 175
		} # end require
#line 175
	
#line 175

#line 175

#line 175
	
#line 175
	allow amazon_ssm_agent_t bin_t:dir { getattr search open };
#line 175
	allow amazon_ssm_agent_t bin_t:lnk_file { getattr read };
#line 175

#line 175

#line 175
	 	
#line 175
##### end corecmd_read_bin_symlinks(amazon_ssm_agent_t) depth: 3
#line 175
 	
#line 175
	
#line 175
	allow amazon_ssm_agent_t bin_t:dir { getattr search open };
#line 175
	allow amazon_ssm_agent_t bin_t:dir { getattr search open };
#line 175

#line 175

#line 175
	 	
#line 175
##### end corecmd_search_bin(amazon_ssm_agent_t) depth: 2
#line 175
 	
#line 175
	allow amazon_ssm_agent_t systemd_systemctl_exec_t:file { { getattr open read execute ioctl } ioctl lock execute_no_trans };
#line 175

#line 175
	 	 	
#line 175
##### begin fs_list_cgroup_dirs(amazon_ssm_agent_t) depth: 3
#line 175
 	
#line 175
	
#line 175
	
#line 175
		require {
#line 175
			
#line 175
		type cgroup_t;
#line 175
	
#line 175
		} # end require
#line 175
	
#line 175

#line 175

#line 175
	
#line 175
	allow amazon_ssm_agent_t cgroup_t:dir { getattr search open };
#line 175
	allow amazon_ssm_agent_t cgroup_t:dir { getattr search open read lock ioctl };
#line 175

#line 175
	 	 	
#line 175
##### begin fs_search_tmpfs(amazon_ssm_agent_t) depth: 4
#line 175
 	
#line 175
	
#line 175
	
#line 175
		require {
#line 175
			
#line 175
		type tmpfs_t;
#line 175
	
#line 175
		} # end require
#line 175
	
#line 175

#line 175

#line 175
	allow amazon_ssm_agent_t tmpfs_t:dir { getattr search open };
#line 175

#line 175
	 	
#line 175
##### end fs_search_tmpfs(amazon_ssm_agent_t) depth: 3
#line 175
 	
#line 175
	 	 	
#line 175
##### begin dev_search_sysfs(amazon_ssm_agent_t) depth: 4
#line 175
 	
#line 175
	
#line 175
	
#line 175
		require {
#line 175
			
#line 175
		type sysfs_t;
#line 175
	
#line 175
		} # end require
#line 175
	
#line 175

#line 175

#line 175
	
#line 175
	allow amazon_ssm_agent_t sysfs_t:dir { getattr search open };
#line 175
	allow amazon_ssm_agent_t sysfs_t:dir { getattr search open };
#line 175

#line 175

#line 175
	 	
#line 175
##### end dev_search_sysfs(amazon_ssm_agent_t) depth: 3
#line 175
 	
#line 175

#line 175
	 	
#line 175
##### end fs_list_cgroup_dirs(amazon_ssm_agent_t) depth: 2
#line 175
 	
#line 175
	 	 	
#line 175
##### begin fs_read_cgroup_files(amazon_ssm_agent_t) depth: 3
#line 175
 	
#line 175
	
#line 175
	
#line 175
		require {
#line 175
			
#line 175
		type cgroup_t;
#line 175

#line 175
	
#line 175
		} # end require
#line 175
	
#line 175

#line 175

#line 175
	
#line 175
	allow amazon_ssm_agent_t cgroup_t:dir { getattr search open };
#line 175
	allow amazon_ssm_agent_t cgroup_t:file { open { getattr read ioctl lock } };
#line 175

#line 175
	
#line 175
	allow amazon_ssm_agent_t cgroup_t:dir { getattr search open };
#line 175
	allow amazon_ssm_agent_t cgroup_t:lnk_file { getattr read };
#line 175

#line 175
	 	 	
#line 175
##### begin fs_search_tmpfs(amazon_ssm_agent_t) depth: 4
#line 175
 	
#line 175
	
#line 175
	
#line 175
		require {
#line 175
			
#line 175
		type tmpfs_t;
#line 175
	
#line 175
		} # end require
#line 175
	
#line 175

#line 175

#line 175
	allow amazon_ssm_agent_t tmpfs_t:dir { getattr search open };
#line 175

#line 175
	 	
#line 175
##### end fs_search_tmpfs(amazon_ssm_agent_t) depth: 3
#line 175
 	
#line 175
	 	 	
#line 175
##### begin dev_search_sysfs(amazon_ssm_agent_t) depth: 4
#line 175
 	
#line 175
	
#line 175
	
#line 175
		require {
#line 175
			
#line 175
		type sysfs_t;
#line 175
	
#line 175
		} # end require
#line 175
	
#line 175

#line 175

#line 175
	
#line 175
	allow amazon_ssm_agent_t sysfs_t:dir { getattr search open };
#line 175
	allow amazon_ssm_agent_t sysfs_t:dir { getattr search open };
#line 175

#line 175

#line 175
	 	
#line 175
##### end dev_search_sysfs(amazon_ssm_agent_t) depth: 3
#line 175
 	
#line 175

#line 175
	 	
#line 175
##### end fs_read_cgroup_files(amazon_ssm_agent_t) depth: 2
#line 175
 	
#line 175
	 	 	
#line 175
##### begin systemd_list_unit_dirs(amazon_ssm_agent_t) depth: 3
#line 175
 	
#line 175
        
#line 175
	
#line 175
		require {
#line 175
			
#line 175
                attribute systemd_unit_file_type;
#line 175
        
#line 175
		} # end require
#line 175
	
#line 175

#line 175
	
#line 175
	 	 	
#line 175
##### begin files_search_var_lib(amazon_ssm_agent_t) depth: 4
#line 175
 	
#line 175
	
#line 175
	
#line 175
		require {
#line 175
			
#line 175
		type var_t, var_lib_t;
#line 175
	
#line 175
		} # end require
#line 175
	
#line 175

#line 175

#line 175
	
#line 175
	allow amazon_ssm_agent_t var_t:dir { getattr search open };
#line 175
	allow amazon_ssm_agent_t var_lib_t:dir { getattr search open };
#line 175

#line 175

#line 175
	 	
#line 175
##### end files_search_var_lib(amazon_ssm_agent_t) depth: 3
#line 175
 	
#line 175
	allow amazon_ssm_agent_t systemd_unit_file_type:dir { getattr search open read lock ioctl };
#line 175

#line 175
	 	
#line 175
##### end systemd_list_unit_dirs(amazon_ssm_agent_t) depth: 2
#line 175
 	
#line 175
	 	 	
#line 175
##### begin init_list_pid_dirs(amazon_ssm_agent_t) depth: 3
#line 175
 	
#line 175
    
#line 175
	
#line 175
		require {
#line 175
			
#line 175
        type init_var_run_t;
#line 175
    
#line 175
		} # end require
#line 175
	
#line 175

#line 175

#line 175
    allow amazon_ssm_agent_t init_var_run_t:dir { getattr search open read lock ioctl };
#line 175

#line 175
	 	
#line 175
##### end init_list_pid_dirs(amazon_ssm_agent_t) depth: 2
#line 175
 	
#line 175
	 	 	
#line 175
##### begin init_read_state(amazon_ssm_agent_t) depth: 3
#line 175
 	
#line 175
	
#line 175
	
#line 175
		require {
#line 175
			
#line 175
		type init_t;
#line 175
	
#line 175
		} # end require
#line 175
	
#line 175

#line 175

#line 175
	allow amazon_ssm_agent_t init_t:dir { getattr search open };
#line 175
	allow amazon_ssm_agent_t init_t:file { open { getattr read ioctl lock } };
#line 175
	allow amazon_ssm_agent_t init_t:lnk_file { getattr read };
#line 175

#line 175
	 	
#line 175
##### end init_read_state(amazon_ssm_agent_t) depth: 2
#line 175
 	
#line 175
	 	 	
#line 175
##### begin init_stream_send(amazon_ssm_agent_t) depth: 3
#line 175
 	
#line 175
	
#line 175
	
#line 175
		require {
#line 175
			
#line 175
		type init_t;
#line 175
	
#line 175
		} # end require
#line 175
	
#line 175

#line 175

#line 175
	allow amazon_ssm_agent_t init_t:unix_stream_socket sendto;
#line 175

#line 175
	 	
#line 175
##### end init_stream_send(amazon_ssm_agent_t) depth: 2
#line 175
 	
#line 175
	 	 	
#line 175
##### begin init_stream_connect(amazon_ssm_agent_t) depth: 3
#line 175
 	
#line 175
	
#line 175
	
#line 175
		require {
#line 175
			
#line 175
		type init_t, init_var_run_t;
#line 175
	
#line 175
		} # end require
#line 175
	
#line 175

#line 175

#line 175
	 	 	
#line 175
##### begin files_search_pids(amazon_ssm_agent_t) depth: 4
#line 175
 	
#line 175
	
#line 175
	
#line 175
		require {
#line 175
			
#line 175
		type var_t, var_run_t;
#line 175
	
#line 175
		} # end require
#line 175
	
#line 175

#line 175

#line 175
	allow amazon_ssm_agent_t var_t:lnk_file { getattr read };
#line 175
	allow amazon_ssm_agent_t var_run_t:lnk_file { getattr read };
#line 175
	
#line 175
	allow amazon_ssm_agent_t var_t:dir { getattr search open };
#line 175
	allow amazon_ssm_agent_t var_run_t:dir { getattr search open };
#line 175

#line 175

#line 175
	 	
#line 175
##### end files_search_pids(amazon_ssm_agent_t) depth: 3
#line 175
 	
#line 175
	
#line 175
	allow amazon_ssm_agent_t init_var_run_t:dir { getattr search open };
#line 175
	allow amazon_ssm_agent_t init_var_run_t:sock_file { getattr write open append };
#line 175
	allow amazon_ssm_agent_t init_t:unix_stream_socket connectto;
#line 175
    
#line 175
	allow amazon_ssm_agent_t init_t:unix_stream_socket getattr;
#line 175

#line 175
	 	
#line 175
##### end init_stream_connect(amazon_ssm_agent_t) depth: 2
#line 175
 	
#line 175

#line 175
	 	 	
#line 175
##### begin systemd_login_list_pid_dirs(amazon_ssm_agent_t) depth: 3
#line 175
 	
#line 175
	
#line 175
	
#line 175
		require {
#line 175
			
#line 175
		type systemd_logind_var_run_t;
#line 175
	
#line 175
		} # end require
#line 175
	
#line 175

#line 175

#line 175
	 	 	
#line 175
##### begin files_search_pids(amazon_ssm_agent_t) depth: 4
#line 175
 	
#line 175
	
#line 175
	
#line 175
		require {
#line 175
			
#line 175
		type var_t, var_run_t;
#line 175
	
#line 175
		} # end require
#line 175
	
#line 175

#line 175

#line 175
	allow amazon_ssm_agent_t var_t:lnk_file { getattr read };
#line 175
	allow amazon_ssm_agent_t var_run_t:lnk_file { getattr read };
#line 175
	
#line 175
	allow amazon_ssm_agent_t var_t:dir { getattr search open };
#line 175
	allow amazon_ssm_agent_t var_run_t:dir { getattr search open };
#line 175

#line 175

#line 175
	 	
#line 175
##### end files_search_pids(amazon_ssm_agent_t) depth: 3
#line 175
 	
#line 175
	
#line 175
	allow amazon_ssm_agent_t systemd_logind_var_run_t:dir { getattr search open };
#line 175
	allow amazon_ssm_agent_t systemd_logind_var_run_t:dir { getattr search open read lock ioctl };
#line 175

#line 175

#line 175
	 	
#line 175
##### end systemd_login_list_pid_dirs(amazon_ssm_agent_t) depth: 2
#line 175
 	
#line 175
	 	 	
#line 175
##### begin systemd_login_read_pid_files(amazon_ssm_agent_t) depth: 3
#line 175
 	
#line 175
	
#line 175
	
#line 175
		require {
#line 175
			
#line 175
		type systemd_logind_var_run_t;
#line 175
	
#line 175
		} # end require
#line 175
	
#line 175

#line 175

#line 175
	 	 	
#line 175
##### begin files_search_pids(amazon_ssm_agent_t) depth: 4
#line 175
 	
#line 175
	
#line 175
	
#line 175
		require {
#line 175
			
#line 175
		type var_t, var_run_t;
#line 175
	
#line 175
		} # end require
#line 175
	
#line 175

#line 175

#line 175
	allow amazon_ssm_agent_t var_t:lnk_file { getattr read };
#line 175
	allow amazon_ssm_agent_t var_run_t:lnk_file { getattr read };
#line 175
	
#line 175
	allow amazon_ssm_agent_t var_t:dir { getattr search open };
#line 175
	allow amazon_ssm_agent_t var_run_t:dir { getattr search open };
#line 175

#line 175

#line 175
	 	
#line 175
##### end files_search_pids(amazon_ssm_agent_t) depth: 3
#line 175
 	
#line 175
	
#line 175
	allow amazon_ssm_agent_t systemd_logind_var_run_t:dir { getattr search open };
#line 175
	allow amazon_ssm_agent_t systemd_logind_var_run_t:file { open { getattr read ioctl lock } };
#line 175

#line 175

#line 175
	 	
#line 175
##### end systemd_login_read_pid_files(amazon_ssm_agent_t) depth: 2
#line 175
 	
#line 175
	 	 	
#line 175
##### begin systemd_passwd_agent_exec(amazon_ssm_agent_t) depth: 3
#line 175
 	
#line 175
	
#line 175
	
#line 175
		require {
#line 175
			
#line 175
		type systemd_passwd_agent_t, systemd_passwd_agent_exec_t;
#line 175
	
#line 175
		} # end require
#line 175
	
#line 175

#line 175

#line 175
	allow amazon_ssm_agent_t systemd_passwd_agent_exec_t:file { { getattr open read execute ioctl } ioctl lock execute_no_trans };
#line 175
	 	 	
#line 175
##### begin systemd_manage_passwd_run(amazon_ssm_agent_t) depth: 4
#line 175
 	
#line 175
	
#line 175
	
#line 175
		require {
#line 175
			
#line 175
		type systemd_passwd_agent_t;	
#line 175
		type systemd_passwd_var_run_t;
#line 175
	
#line 175
		} # end require
#line 175
	
#line 175

#line 175

#line 175
	 	 	
#line 175
##### begin init_search_pid_dirs(amazon_ssm_agent_t) depth: 5
#line 175
 	
#line 175
    
#line 175
	
#line 175
		require {
#line 175
			
#line 175
        type init_var_run_t;
#line 175
    
#line 175
		} # end require
#line 175
	
#line 175

#line 175

#line 175
    allow amazon_ssm_agent_t init_var_run_t:dir { getattr search open };
#line 175

#line 175
	 	
#line 175
##### end init_search_pid_dirs(amazon_ssm_agent_t) depth: 4
#line 175
 	
#line 175
	
#line 175
	allow amazon_ssm_agent_t systemd_passwd_var_run_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 175
	allow amazon_ssm_agent_t systemd_passwd_var_run_t:file { create open getattr setattr read write append rename link unlink ioctl lock };
#line 175

#line 175
	
#line 175
	allow amazon_ssm_agent_t systemd_passwd_var_run_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 175
	allow amazon_ssm_agent_t systemd_passwd_var_run_t:sock_file { create open getattr setattr read write rename link unlink ioctl lock append };
#line 175

#line 175
	
#line 175
	allow amazon_ssm_agent_t systemd_passwd_var_run_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 175
	allow amazon_ssm_agent_t systemd_passwd_var_run_t:fifo_file { create open getattr setattr read write append rename link unlink ioctl lock };
#line 175

#line 175

#line 175
	allow systemd_passwd_agent_t amazon_ssm_agent_t:process signull;
#line 175
	allow systemd_passwd_agent_t amazon_ssm_agent_t:unix_dgram_socket sendto;
#line 175

#line 175
	 	
#line 175
##### end systemd_manage_passwd_run(amazon_ssm_agent_t) depth: 3
#line 175
 	
#line 175

#line 175
	 	
#line 175
##### end systemd_passwd_agent_exec(amazon_ssm_agent_t) depth: 2
#line 175
 	
#line 175

#line 175
	dontaudit amazon_ssm_agent_t self:capability net_admin;
#line 175

#line 175
	 	
#line 175
##### end systemd_exec_systemctl(amazon_ssm_agent_t) depth: 1
#line 175
 	
#line 175
	 	 	
#line 175
##### begin init_reload_services(amazon_ssm_agent_t) depth: 2
#line 175
 	
#line 175
	
#line 175
	
#line 175
		require {
#line 175
			
#line 175
		type init_t;
#line 175
	
#line 175
		} # end require
#line 175
	
#line 175

#line 175

#line 175
	allow amazon_ssm_agent_t init_t:system reload;
#line 175

#line 175
	 	
#line 175
##### end init_reload_services(amazon_ssm_agent_t) depth: 1
#line 175
 	
#line 175
	allow amazon_ssm_agent_t rngd_unit_file_t:file { open { getattr read ioctl lock } };
#line 175
	allow amazon_ssm_agent_t rngd_unit_file_t:service { start stop status reload enable disable } ;
#line 175

#line 175
	
#line 175
	allow amazon_ssm_agent_t rngd_t:dir { getattr search open read lock ioctl };
#line 175
	allow amazon_ssm_agent_t rngd_t:file { open { getattr read ioctl lock } };
#line 175
	allow amazon_ssm_agent_t rngd_t:lnk_file { getattr read };
#line 175
	allow amazon_ssm_agent_t rngd_t:process getattr;
#line 175

#line 175

#line 175
	 	
#line 175
##### end rng_systemctl_rngd(amazon_ssm_agent_t) depth: 0
#line 175
 	

 	 	
#line 177
##### begin cron_read_state_crond(amazon_ssm_agent_t) depth: 1
#line 177
 	
#line 177
	
#line 177
	
#line 177
		require {
#line 177
			
#line 177
		type crond_t;
#line 177
	
#line 177
		} # end require
#line 177
	
#line 177

#line 177

#line 177
	 	 	
#line 177
##### begin kernel_search_proc(amazon_ssm_agent_t) depth: 2
#line 177
 	
#line 177
	
#line 177
	
#line 177
		require {
#line 177
			
#line 177
		type proc_t;
#line 177
	
#line 177
		} # end require
#line 177
	
#line 177

#line 177

#line 177
	
#line 177
	allow amazon_ssm_agent_t proc_t:dir { getattr search open };
#line 177
	allow amazon_ssm_agent_t proc_t:dir { getattr search open };
#line 177

#line 177

#line 177
	 	
#line 177
##### end kernel_search_proc(amazon_ssm_agent_t) depth: 1
#line 177
 	
#line 177
	
#line 177
	allow amazon_ssm_agent_t crond_t:dir { getattr search open read lock ioctl };
#line 177
	allow amazon_ssm_agent_t crond_t:file { open { getattr read ioctl lock } };
#line 177
	allow amazon_ssm_agent_t crond_t:lnk_file { getattr read };
#line 177
	allow amazon_ssm_agent_t crond_t:process getattr;
#line 177

#line 177

#line 177
	 	
#line 177
##### end cron_read_state_crond(amazon_ssm_agent_t) depth: 0
#line 177
 	

 	 	
#line 179
##### begin logging_systemctl_audit(amazon_ssm_agent_t) depth: 1
#line 179
 	
#line 179
	
#line 179
	
#line 179
		require {
#line 179
			
#line 179
		type auditd_t;
#line 179
		type auditd_unit_file_t;
#line 179
	
#line 179
		} # end require
#line 179
	
#line 179

#line 179

#line 179
	 	 	
#line 179
##### begin systemd_exec_systemctl(amazon_ssm_agent_t) depth: 2
#line 179
 	
#line 179
        
#line 179
	
#line 179
		require {
#line 179
			
#line 179
                type systemd_systemctl_exec_t;
#line 179
        
#line 179
		} # end require
#line 179
	
#line 179

#line 179

#line 179
	 	 	
#line 179
##### begin corecmd_search_bin(amazon_ssm_agent_t) depth: 3
#line 179
 	
#line 179
	
#line 179
	
#line 179
		require {
#line 179
			
#line 179
		type bin_t;
#line 179
	
#line 179
		} # end require
#line 179
	
#line 179

#line 179

#line 179
	 	 	
#line 179
##### begin corecmd_read_bin_symlinks(amazon_ssm_agent_t) depth: 4
#line 179
 	
#line 179
	
#line 179
	
#line 179
		require {
#line 179
			
#line 179
		type bin_t;
#line 179
	
#line 179
		} # end require
#line 179
	
#line 179

#line 179

#line 179
	
#line 179
	allow amazon_ssm_agent_t bin_t:dir { getattr search open };
#line 179
	allow amazon_ssm_agent_t bin_t:lnk_file { getattr read };
#line 179

#line 179

#line 179
	 	
#line 179
##### end corecmd_read_bin_symlinks(amazon_ssm_agent_t) depth: 3
#line 179
 	
#line 179
	
#line 179
	allow amazon_ssm_agent_t bin_t:dir { getattr search open };
#line 179
	allow amazon_ssm_agent_t bin_t:dir { getattr search open };
#line 179

#line 179

#line 179
	 	
#line 179
##### end corecmd_search_bin(amazon_ssm_agent_t) depth: 2
#line 179
 	
#line 179
	allow amazon_ssm_agent_t systemd_systemctl_exec_t:file { { getattr open read execute ioctl } ioctl lock execute_no_trans };
#line 179

#line 179
	 	 	
#line 179
##### begin fs_list_cgroup_dirs(amazon_ssm_agent_t) depth: 3
#line 179
 	
#line 179
	
#line 179
	
#line 179
		require {
#line 179
			
#line 179
		type cgroup_t;
#line 179
	
#line 179
		} # end require
#line 179
	
#line 179

#line 179

#line 179
	
#line 179
	allow amazon_ssm_agent_t cgroup_t:dir { getattr search open };
#line 179
	allow amazon_ssm_agent_t cgroup_t:dir { getattr search open read lock ioctl };
#line 179

#line 179
	 	 	
#line 179
##### begin fs_search_tmpfs(amazon_ssm_agent_t) depth: 4
#line 179
 	
#line 179
	
#line 179
	
#line 179
		require {
#line 179
			
#line 179
		type tmpfs_t;
#line 179
	
#line 179
		} # end require
#line 179
	
#line 179

#line 179

#line 179
	allow amazon_ssm_agent_t tmpfs_t:dir { getattr search open };
#line 179

#line 179
	 	
#line 179
##### end fs_search_tmpfs(amazon_ssm_agent_t) depth: 3
#line 179
 	
#line 179
	 	 	
#line 179
##### begin dev_search_sysfs(amazon_ssm_agent_t) depth: 4
#line 179
 	
#line 179
	
#line 179
	
#line 179
		require {
#line 179
			
#line 179
		type sysfs_t;
#line 179
	
#line 179
		} # end require
#line 179
	
#line 179

#line 179

#line 179
	
#line 179
	allow amazon_ssm_agent_t sysfs_t:dir { getattr search open };
#line 179
	allow amazon_ssm_agent_t sysfs_t:dir { getattr search open };
#line 179

#line 179

#line 179
	 	
#line 179
##### end dev_search_sysfs(amazon_ssm_agent_t) depth: 3
#line 179
 	
#line 179

#line 179
	 	
#line 179
##### end fs_list_cgroup_dirs(amazon_ssm_agent_t) depth: 2
#line 179
 	
#line 179
	 	 	
#line 179
##### begin fs_read_cgroup_files(amazon_ssm_agent_t) depth: 3
#line 179
 	
#line 179
	
#line 179
	
#line 179
		require {
#line 179
			
#line 179
		type cgroup_t;
#line 179

#line 179
	
#line 179
		} # end require
#line 179
	
#line 179

#line 179

#line 179
	
#line 179
	allow amazon_ssm_agent_t cgroup_t:dir { getattr search open };
#line 179
	allow amazon_ssm_agent_t cgroup_t:file { open { getattr read ioctl lock } };
#line 179

#line 179
	
#line 179
	allow amazon_ssm_agent_t cgroup_t:dir { getattr search open };
#line 179
	allow amazon_ssm_agent_t cgroup_t:lnk_file { getattr read };
#line 179

#line 179
	 	 	
#line 179
##### begin fs_search_tmpfs(amazon_ssm_agent_t) depth: 4
#line 179
 	
#line 179
	
#line 179
	
#line 179
		require {
#line 179
			
#line 179
		type tmpfs_t;
#line 179
	
#line 179
		} # end require
#line 179
	
#line 179

#line 179

#line 179
	allow amazon_ssm_agent_t tmpfs_t:dir { getattr search open };
#line 179

#line 179
	 	
#line 179
##### end fs_search_tmpfs(amazon_ssm_agent_t) depth: 3
#line 179
 	
#line 179
	 	 	
#line 179
##### begin dev_search_sysfs(amazon_ssm_agent_t) depth: 4
#line 179
 	
#line 179
	
#line 179
	
#line 179
		require {
#line 179
			
#line 179
		type sysfs_t;
#line 179
	
#line 179
		} # end require
#line 179
	
#line 179

#line 179

#line 179
	
#line 179
	allow amazon_ssm_agent_t sysfs_t:dir { getattr search open };
#line 179
	allow amazon_ssm_agent_t sysfs_t:dir { getattr search open };
#line 179

#line 179

#line 179
	 	
#line 179
##### end dev_search_sysfs(amazon_ssm_agent_t) depth: 3
#line 179
 	
#line 179

#line 179
	 	
#line 179
##### end fs_read_cgroup_files(amazon_ssm_agent_t) depth: 2
#line 179
 	
#line 179
	 	 	
#line 179
##### begin systemd_list_unit_dirs(amazon_ssm_agent_t) depth: 3
#line 179
 	
#line 179
        
#line 179
	
#line 179
		require {
#line 179
			
#line 179
                attribute systemd_unit_file_type;
#line 179
        
#line 179
		} # end require
#line 179
	
#line 179

#line 179
	
#line 179
	 	 	
#line 179
##### begin files_search_var_lib(amazon_ssm_agent_t) depth: 4
#line 179
 	
#line 179
	
#line 179
	
#line 179
		require {
#line 179
			
#line 179
		type var_t, var_lib_t;
#line 179
	
#line 179
		} # end require
#line 179
	
#line 179

#line 179

#line 179
	
#line 179
	allow amazon_ssm_agent_t var_t:dir { getattr search open };
#line 179
	allow amazon_ssm_agent_t var_lib_t:dir { getattr search open };
#line 179

#line 179

#line 179
	 	
#line 179
##### end files_search_var_lib(amazon_ssm_agent_t) depth: 3
#line 179
 	
#line 179
	allow amazon_ssm_agent_t systemd_unit_file_type:dir { getattr search open read lock ioctl };
#line 179

#line 179
	 	
#line 179
##### end systemd_list_unit_dirs(amazon_ssm_agent_t) depth: 2
#line 179
 	
#line 179
	 	 	
#line 179
##### begin init_list_pid_dirs(amazon_ssm_agent_t) depth: 3
#line 179
 	
#line 179
    
#line 179
	
#line 179
		require {
#line 179
			
#line 179
        type init_var_run_t;
#line 179
    
#line 179
		} # end require
#line 179
	
#line 179

#line 179

#line 179
    allow amazon_ssm_agent_t init_var_run_t:dir { getattr search open read lock ioctl };
#line 179

#line 179
	 	
#line 179
##### end init_list_pid_dirs(amazon_ssm_agent_t) depth: 2
#line 179
 	
#line 179
	 	 	
#line 179
##### begin init_read_state(amazon_ssm_agent_t) depth: 3
#line 179
 	
#line 179
	
#line 179
	
#line 179
		require {
#line 179
			
#line 179
		type init_t;
#line 179
	
#line 179
		} # end require
#line 179
	
#line 179

#line 179

#line 179
	allow amazon_ssm_agent_t init_t:dir { getattr search open };
#line 179
	allow amazon_ssm_agent_t init_t:file { open { getattr read ioctl lock } };
#line 179
	allow amazon_ssm_agent_t init_t:lnk_file { getattr read };
#line 179

#line 179
	 	
#line 179
##### end init_read_state(amazon_ssm_agent_t) depth: 2
#line 179
 	
#line 179
	 	 	
#line 179
##### begin init_stream_send(amazon_ssm_agent_t) depth: 3
#line 179
 	
#line 179
	
#line 179
	
#line 179
		require {
#line 179
			
#line 179
		type init_t;
#line 179
	
#line 179
		} # end require
#line 179
	
#line 179

#line 179

#line 179
	allow amazon_ssm_agent_t init_t:unix_stream_socket sendto;
#line 179

#line 179
	 	
#line 179
##### end init_stream_send(amazon_ssm_agent_t) depth: 2
#line 179
 	
#line 179
	 	 	
#line 179
##### begin init_stream_connect(amazon_ssm_agent_t) depth: 3
#line 179
 	
#line 179
	
#line 179
	
#line 179
		require {
#line 179
			
#line 179
		type init_t, init_var_run_t;
#line 179
	
#line 179
		} # end require
#line 179
	
#line 179

#line 179

#line 179
	 	 	
#line 179
##### begin files_search_pids(amazon_ssm_agent_t) depth: 4
#line 179
 	
#line 179
	
#line 179
	
#line 179
		require {
#line 179
			
#line 179
		type var_t, var_run_t;
#line 179
	
#line 179
		} # end require
#line 179
	
#line 179

#line 179

#line 179
	allow amazon_ssm_agent_t var_t:lnk_file { getattr read };
#line 179
	allow amazon_ssm_agent_t var_run_t:lnk_file { getattr read };
#line 179
	
#line 179
	allow amazon_ssm_agent_t var_t:dir { getattr search open };
#line 179
	allow amazon_ssm_agent_t var_run_t:dir { getattr search open };
#line 179

#line 179

#line 179
	 	
#line 179
##### end files_search_pids(amazon_ssm_agent_t) depth: 3
#line 179
 	
#line 179
	
#line 179
	allow amazon_ssm_agent_t init_var_run_t:dir { getattr search open };
#line 179
	allow amazon_ssm_agent_t init_var_run_t:sock_file { getattr write open append };
#line 179
	allow amazon_ssm_agent_t init_t:unix_stream_socket connectto;
#line 179
    
#line 179
	allow amazon_ssm_agent_t init_t:unix_stream_socket getattr;
#line 179

#line 179
	 	
#line 179
##### end init_stream_connect(amazon_ssm_agent_t) depth: 2
#line 179
 	
#line 179

#line 179
	 	 	
#line 179
##### begin systemd_login_list_pid_dirs(amazon_ssm_agent_t) depth: 3
#line 179
 	
#line 179
	
#line 179
	
#line 179
		require {
#line 179
			
#line 179
		type systemd_logind_var_run_t;
#line 179
	
#line 179
		} # end require
#line 179
	
#line 179

#line 179

#line 179
	 	 	
#line 179
##### begin files_search_pids(amazon_ssm_agent_t) depth: 4
#line 179
 	
#line 179
	
#line 179
	
#line 179
		require {
#line 179
			
#line 179
		type var_t, var_run_t;
#line 179
	
#line 179
		} # end require
#line 179
	
#line 179

#line 179

#line 179
	allow amazon_ssm_agent_t var_t:lnk_file { getattr read };
#line 179
	allow amazon_ssm_agent_t var_run_t:lnk_file { getattr read };
#line 179
	
#line 179
	allow amazon_ssm_agent_t var_t:dir { getattr search open };
#line 179
	allow amazon_ssm_agent_t var_run_t:dir { getattr search open };
#line 179

#line 179

#line 179
	 	
#line 179
##### end files_search_pids(amazon_ssm_agent_t) depth: 3
#line 179
 	
#line 179
	
#line 179
	allow amazon_ssm_agent_t systemd_logind_var_run_t:dir { getattr search open };
#line 179
	allow amazon_ssm_agent_t systemd_logind_var_run_t:dir { getattr search open read lock ioctl };
#line 179

#line 179

#line 179
	 	
#line 179
##### end systemd_login_list_pid_dirs(amazon_ssm_agent_t) depth: 2
#line 179
 	
#line 179
	 	 	
#line 179
##### begin systemd_login_read_pid_files(amazon_ssm_agent_t) depth: 3
#line 179
 	
#line 179
	
#line 179
	
#line 179
		require {
#line 179
			
#line 179
		type systemd_logind_var_run_t;
#line 179
	
#line 179
		} # end require
#line 179
	
#line 179

#line 179

#line 179
	 	 	
#line 179
##### begin files_search_pids(amazon_ssm_agent_t) depth: 4
#line 179
 	
#line 179
	
#line 179
	
#line 179
		require {
#line 179
			
#line 179
		type var_t, var_run_t;
#line 179
	
#line 179
		} # end require
#line 179
	
#line 179

#line 179

#line 179
	allow amazon_ssm_agent_t var_t:lnk_file { getattr read };
#line 179
	allow amazon_ssm_agent_t var_run_t:lnk_file { getattr read };
#line 179
	
#line 179
	allow amazon_ssm_agent_t var_t:dir { getattr search open };
#line 179
	allow amazon_ssm_agent_t var_run_t:dir { getattr search open };
#line 179

#line 179

#line 179
	 	
#line 179
##### end files_search_pids(amazon_ssm_agent_t) depth: 3
#line 179
 	
#line 179
	
#line 179
	allow amazon_ssm_agent_t systemd_logind_var_run_t:dir { getattr search open };
#line 179
	allow amazon_ssm_agent_t systemd_logind_var_run_t:file { open { getattr read ioctl lock } };
#line 179

#line 179

#line 179
	 	
#line 179
##### end systemd_login_read_pid_files(amazon_ssm_agent_t) depth: 2
#line 179
 	
#line 179
	 	 	
#line 179
##### begin systemd_passwd_agent_exec(amazon_ssm_agent_t) depth: 3
#line 179
 	
#line 179
	
#line 179
	
#line 179
		require {
#line 179
			
#line 179
		type systemd_passwd_agent_t, systemd_passwd_agent_exec_t;
#line 179
	
#line 179
		} # end require
#line 179
	
#line 179

#line 179

#line 179
	allow amazon_ssm_agent_t systemd_passwd_agent_exec_t:file { { getattr open read execute ioctl } ioctl lock execute_no_trans };
#line 179
	 	 	
#line 179
##### begin systemd_manage_passwd_run(amazon_ssm_agent_t) depth: 4
#line 179
 	
#line 179
	
#line 179
	
#line 179
		require {
#line 179
			
#line 179
		type systemd_passwd_agent_t;	
#line 179
		type systemd_passwd_var_run_t;
#line 179
	
#line 179
		} # end require
#line 179
	
#line 179

#line 179

#line 179
	 	 	
#line 179
##### begin init_search_pid_dirs(amazon_ssm_agent_t) depth: 5
#line 179
 	
#line 179
    
#line 179
	
#line 179
		require {
#line 179
			
#line 179
        type init_var_run_t;
#line 179
    
#line 179
		} # end require
#line 179
	
#line 179

#line 179

#line 179
    allow amazon_ssm_agent_t init_var_run_t:dir { getattr search open };
#line 179

#line 179
	 	
#line 179
##### end init_search_pid_dirs(amazon_ssm_agent_t) depth: 4
#line 179
 	
#line 179
	
#line 179
	allow amazon_ssm_agent_t systemd_passwd_var_run_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 179
	allow amazon_ssm_agent_t systemd_passwd_var_run_t:file { create open getattr setattr read write append rename link unlink ioctl lock };
#line 179

#line 179
	
#line 179
	allow amazon_ssm_agent_t systemd_passwd_var_run_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 179
	allow amazon_ssm_agent_t systemd_passwd_var_run_t:sock_file { create open getattr setattr read write rename link unlink ioctl lock append };
#line 179

#line 179
	
#line 179
	allow amazon_ssm_agent_t systemd_passwd_var_run_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 179
	allow amazon_ssm_agent_t systemd_passwd_var_run_t:fifo_file { create open getattr setattr read write append rename link unlink ioctl lock };
#line 179

#line 179

#line 179
	allow systemd_passwd_agent_t amazon_ssm_agent_t:process signull;
#line 179
	allow systemd_passwd_agent_t amazon_ssm_agent_t:unix_dgram_socket sendto;
#line 179

#line 179
	 	
#line 179
##### end systemd_manage_passwd_run(amazon_ssm_agent_t) depth: 3
#line 179
 	
#line 179

#line 179
	 	
#line 179
##### end systemd_passwd_agent_exec(amazon_ssm_agent_t) depth: 2
#line 179
 	
#line 179

#line 179
	dontaudit amazon_ssm_agent_t self:capability net_admin;
#line 179

#line 179
	 	
#line 179
##### end systemd_exec_systemctl(amazon_ssm_agent_t) depth: 1
#line 179
 	
#line 179
	allow amazon_ssm_agent_t auditd_unit_file_t:file { open { getattr read ioctl lock } };
#line 179
	allow amazon_ssm_agent_t auditd_unit_file_t:service { start stop status reload enable disable } ;
#line 179

#line 179
	
#line 179
	allow amazon_ssm_agent_t auditd_t:dir { getattr search open read lock ioctl };
#line 179
	allow amazon_ssm_agent_t auditd_t:file { open { getattr read ioctl lock } };
#line 179
	allow amazon_ssm_agent_t auditd_t:lnk_file { getattr read };
#line 179
	allow amazon_ssm_agent_t auditd_t:process getattr;
#line 179

#line 179

#line 179
	 	
#line 179
##### end logging_systemctl_audit(amazon_ssm_agent_t) depth: 0
#line 179
 	

 	 	
#line 181
##### begin corenet_tcp_bind_generic_node(amazon_ssm_agent_t) depth: 1
#line 181
 	
#line 181
	
#line 181
	
#line 181
		require {
#line 181
			
#line 181
		type node_t;
#line 181
	
#line 181
		} # end require
#line 181
	
#line 181

#line 181

#line 181
	allow amazon_ssm_agent_t node_t:tcp_socket node_bind;
#line 181

#line 181
	 	
#line 181
##### end corenet_tcp_bind_generic_node(amazon_ssm_agent_t) depth: 0
#line 181
 	

 	 	
#line 183
##### begin files_rw_pid_dirs(amazon_ssm_agent_t) depth: 1
#line 183
 	
#line 183
    
#line 183
	
#line 183
		require {
#line 183
			
#line 183
        type var_run_t;
#line 183
    
#line 183
		} # end require
#line 183
	
#line 183

#line 183

#line 183
    allow amazon_ssm_agent_t var_run_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 183

#line 183
	 	
#line 183
##### end files_rw_pid_dirs(amazon_ssm_agent_t) depth: 0
#line 183
 	

 	 	
#line 185
##### begin kernel_dgram_send(amazon_ssm_agent_t) depth: 1
#line 185
 	
#line 185
	
#line 185
	
#line 185
		require {
#line 185
			
#line 185
		type kernel_t;
#line 185
	
#line 185
		} # end require
#line 185
	
#line 185

#line 185

#line 185
	allow amazon_ssm_agent_t kernel_t:unix_dgram_socket sendto;
#line 185

#line 185
	 	
#line 185
##### end kernel_dgram_send(amazon_ssm_agent_t) depth: 0
#line 185
 	

 	 	
#line 187
##### begin libs_exec_ldconfig(amazon_ssm_agent_t) depth: 1
#line 187
 	
#line 187
	
#line 187
	
#line 187
		require {
#line 187
			
#line 187
		type ldconfig_exec_t;
#line 187
	
#line 187
		} # end require
#line 187
	
#line 187

#line 187

#line 187
	 	 	
#line 187
##### begin corecmd_search_bin(amazon_ssm_agent_t) depth: 2
#line 187
 	
#line 187
	
#line 187
	
#line 187
		require {
#line 187
			
#line 187
		type bin_t;
#line 187
	
#line 187
		} # end require
#line 187
	
#line 187

#line 187

#line 187
	 	 	
#line 187
##### begin corecmd_read_bin_symlinks(amazon_ssm_agent_t) depth: 3
#line 187
 	
#line 187
	
#line 187
	
#line 187
		require {
#line 187
			
#line 187
		type bin_t;
#line 187
	
#line 187
		} # end require
#line 187
	
#line 187

#line 187

#line 187
	
#line 187
	allow amazon_ssm_agent_t bin_t:dir { getattr search open };
#line 187
	allow amazon_ssm_agent_t bin_t:lnk_file { getattr read };
#line 187

#line 187

#line 187
	 	
#line 187
##### end corecmd_read_bin_symlinks(amazon_ssm_agent_t) depth: 2
#line 187
 	
#line 187
	
#line 187
	allow amazon_ssm_agent_t bin_t:dir { getattr search open };
#line 187
	allow amazon_ssm_agent_t bin_t:dir { getattr search open };
#line 187

#line 187

#line 187
	 	
#line 187
##### end corecmd_search_bin(amazon_ssm_agent_t) depth: 1
#line 187
 	
#line 187
	allow amazon_ssm_agent_t ldconfig_exec_t:file { { getattr open read execute ioctl } ioctl lock execute_no_trans };
#line 187

#line 187
	 	
#line 187
##### end libs_exec_ldconfig(amazon_ssm_agent_t) depth: 0
#line 187
 	

 	 	
#line 189
##### begin logging_create_devlog_dev(amazon_ssm_agent_t) depth: 1
#line 189
 	
#line 189
	
#line 189
	
#line 189
		require {
#line 189
			
#line 189
		type devlog_t;
#line 189
	
#line 189
		} # end require
#line 189
	
#line 189

#line 189

#line 189
	allow amazon_ssm_agent_t devlog_t:sock_file { create open getattr setattr read write rename link unlink ioctl lock append };
#line 189
	 	 	
#line 189
##### begin dev_filetrans(amazon_ssm_agent_t,devlog_t,sock_file) depth: 2
#line 189
 	
#line 189
	
#line 189
	
#line 189
		require {
#line 189
			
#line 189
		type device_t;
#line 189
	
#line 189
		} # end require
#line 189
	
#line 189

#line 189

#line 189
	
#line 189
	allow amazon_ssm_agent_t device_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 189
	type_transition amazon_ssm_agent_t device_t:sock_file devlog_t ;
#line 189

#line 189

#line 189
	 	 	
#line 189
##### begin dev_associate(devlog_t) depth: 3
#line 189
 	
#line 189
	
#line 189
	
#line 189
		require {
#line 189
			
#line 189
		type device_t;
#line 189
	
#line 189
		} # end require
#line 189
	
#line 189

#line 189

#line 189
	allow devlog_t device_t:filesystem associate;
#line 189
	 	 	
#line 189
##### begin fs_associate_tmpfs(devlog_t) depth: 4
#line 189
 	
#line 189
	
#line 189
	
#line 189
		require {
#line 189
			
#line 189
		type tmpfs_t;
#line 189
	
#line 189
		} # end require
#line 189
	
#line 189

#line 189

#line 189
	allow devlog_t tmpfs_t:filesystem associate;
#line 189

#line 189
	 	
#line 189
##### end fs_associate_tmpfs(devlog_t) depth: 3
#line 189
 		#For backwards compatibility
#line 189

#line 189
	 	
#line 189
##### end dev_associate(devlog_t) depth: 2
#line 189
 	
#line 189
	 	 	
#line 189
##### begin files_associate_tmp(devlog_t) depth: 3
#line 189
 	
#line 189
	
#line 189
	
#line 189
		require {
#line 189
			
#line 189
		type tmp_t;
#line 189
	
#line 189
		} # end require
#line 189
	
#line 189

#line 189

#line 189
	allow devlog_t tmp_t:filesystem associate;
#line 189

#line 189
	 	
#line 189
##### end files_associate_tmp(devlog_t) depth: 2
#line 189
 	
#line 189

#line 189
	 	
#line 189
##### end dev_filetrans(amazon_ssm_agent_t,devlog_t,sock_file) depth: 1
#line 189
 	
#line 189
	 	 	
#line 189
##### begin init_pid_filetrans(amazon_ssm_agent_t,devlog_t,sock_file,"syslog") depth: 2
#line 189
 	
#line 189
    
#line 189
	
#line 189
		require {
#line 189
			
#line 189
        type init_var_run_t;
#line 189
    
#line 189
		} # end require
#line 189
	
#line 189

#line 189

#line 189
	 	 	
#line 189
##### begin files_search_pids(amazon_ssm_agent_t) depth: 3
#line 189
 	
#line 189
	
#line 189
	
#line 189
		require {
#line 189
			
#line 189
		type var_t, var_run_t;
#line 189
	
#line 189
		} # end require
#line 189
	
#line 189

#line 189

#line 189
	allow amazon_ssm_agent_t var_t:lnk_file { getattr read };
#line 189
	allow amazon_ssm_agent_t var_run_t:lnk_file { getattr read };
#line 189
	
#line 189
	allow amazon_ssm_agent_t var_t:dir { getattr search open };
#line 189
	allow amazon_ssm_agent_t var_run_t:dir { getattr search open };
#line 189

#line 189

#line 189
	 	
#line 189
##### end files_search_pids(amazon_ssm_agent_t) depth: 2
#line 189
 	
#line 189
	
#line 189
	allow amazon_ssm_agent_t init_var_run_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 189
	type_transition amazon_ssm_agent_t init_var_run_t:sock_file devlog_t "syslog";
#line 189

#line 189

#line 189
	 	
#line 189
##### end init_pid_filetrans(amazon_ssm_agent_t,devlog_t,sock_file,"syslog") depth: 1
#line 189
 	
#line 189
     	 	
#line 189
##### begin logging_syslogd_pid_filetrans(amazon_ssm_agent_t,devlog_t,sock_file,"dev-log") depth: 2
#line 189
 	
#line 189
	
#line 189
	
#line 189
		require {
#line 189
			
#line 189
		type syslogd_var_run_t;
#line 189
	
#line 189
		} # end require
#line 189
	
#line 189

#line 189

#line 189
	 	 	
#line 189
##### begin files_search_pids(amazon_ssm_agent_t) depth: 3
#line 189
 	
#line 189
	
#line 189
	
#line 189
		require {
#line 189
			
#line 189
		type var_t, var_run_t;
#line 189
	
#line 189
		} # end require
#line 189
	
#line 189

#line 189

#line 189
	allow amazon_ssm_agent_t var_t:lnk_file { getattr read };
#line 189
	allow amazon_ssm_agent_t var_run_t:lnk_file { getattr read };
#line 189
	
#line 189
	allow amazon_ssm_agent_t var_t:dir { getattr search open };
#line 189
	allow amazon_ssm_agent_t var_run_t:dir { getattr search open };
#line 189

#line 189

#line 189
	 	
#line 189
##### end files_search_pids(amazon_ssm_agent_t) depth: 2
#line 189
 	
#line 189
	
#line 189
	allow amazon_ssm_agent_t syslogd_var_run_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 189
	type_transition amazon_ssm_agent_t syslogd_var_run_t:sock_file devlog_t "dev-log";
#line 189

#line 189

#line 189
	 	
#line 189
##### end logging_syslogd_pid_filetrans(amazon_ssm_agent_t,devlog_t,sock_file,"dev-log") depth: 1
#line 189
 	
#line 189

#line 189
	 	
#line 189
##### end logging_create_devlog_dev(amazon_ssm_agent_t) depth: 0
#line 189
 	

 	 	
#line 191
##### begin fs_getattr_xattr_fs(amazon_ssm_agent_t) depth: 1
#line 191
 	
#line 191
	
#line 191
	
#line 191
		require {
#line 191
			
#line 191
		type fs_t;
#line 191
	
#line 191
		} # end require
#line 191
	
#line 191

#line 191

#line 191
	allow amazon_ssm_agent_t fs_t:filesystem getattr;
#line 191

#line 191
	 	
#line 191
##### end fs_getattr_xattr_fs(amazon_ssm_agent_t) depth: 0
#line 191
 	

 	 	
#line 193
##### begin files_list_tmp(amazon_ssm_agent_t) depth: 1
#line 193
 	
#line 193
	
#line 193
	
#line 193
		require {
#line 193
			
#line 193
		type tmp_t;
#line 193
	
#line 193
		} # end require
#line 193
	
#line 193

#line 193

#line 193
	
#line 193
	allow amazon_ssm_agent_t tmp_t:dir { getattr search open };
#line 193
	allow amazon_ssm_agent_t tmp_t:lnk_file { getattr read };
#line 193

#line 193
	allow amazon_ssm_agent_t tmp_t:dir { getattr search open read lock ioctl };
#line 193

#line 193
	 	
#line 193
##### end files_list_tmp(amazon_ssm_agent_t) depth: 0
#line 193
 	

 	 	
#line 195
##### begin userdom_manage_user_home_content_files(amazon_ssm_agent_t) depth: 1
#line 195
 	
#line 195
	
#line 195
	
#line 195
		require {
#line 195
			
#line 195
		type user_home_dir_t, user_home_t;
#line 195
	
#line 195
		} # end require
#line 195
	
#line 195

#line 195

#line 195
	
#line 195
	allow amazon_ssm_agent_t user_home_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 195
	allow amazon_ssm_agent_t user_home_t:file { create open getattr setattr read write append rename link unlink ioctl lock };
#line 195

#line 195
	allow amazon_ssm_agent_t user_home_dir_t:dir { getattr search open };
#line 195
	 	 	
#line 195
##### begin files_search_home(amazon_ssm_agent_t) depth: 2
#line 195
 	
#line 195
	
#line 195
	
#line 195
		require {
#line 195
			
#line 195
		type home_root_t;
#line 195
	
#line 195
		} # end require
#line 195
	
#line 195

#line 195

#line 195
	allow amazon_ssm_agent_t home_root_t:dir { getattr search open };
#line 195
	allow amazon_ssm_agent_t home_root_t:lnk_file { getattr read };
#line 195

#line 195
	 	
#line 195
##### end files_search_home(amazon_ssm_agent_t) depth: 1
#line 195
 	
#line 195

#line 195
	 	
#line 195
##### end userdom_manage_user_home_content_files(amazon_ssm_agent_t) depth: 0
#line 195
 	

 	 	
#line 197
##### begin userdom_manage_user_home_dirs(amazon_ssm_agent_t) depth: 1
#line 197
 	
#line 197
	
#line 197
	
#line 197
		require {
#line 197
			
#line 197
		type user_home_dir_t;
#line 197
	
#line 197
		} # end require
#line 197
	
#line 197

#line 197

#line 197
	allow amazon_ssm_agent_t user_home_dir_t:dir { create open getattr setattr read write link unlink rename search add_name remove_name reparent rmdir lock ioctl };
#line 197

#line 197
	 	
#line 197
##### end userdom_manage_user_home_dirs(amazon_ssm_agent_t) depth: 0
#line 197
 	

 	 	
#line 199
##### begin init_exec_script_files(amazon_ssm_agent_t) depth: 1
#line 199
 	
#line 199
	
#line 199
	
#line 199
		require {
#line 199
			
#line 199
		type initrc_exec_t;
#line 199
	
#line 199
		} # end require
#line 199
	
#line 199

#line 199

#line 199
	 	 	
#line 199
##### begin files_list_etc(amazon_ssm_agent_t) depth: 2
#line 199
 	
#line 199
	
#line 199
	
#line 199
		require {
#line 199
			
#line 199
		type etc_t;
#line 199
	
#line 199
		} # end require
#line 199
	
#line 199

#line 199

#line 199
	allow amazon_ssm_agent_t etc_t:dir { getattr search open read lock ioctl };
#line 199

#line 199
	 	
#line 199
##### end files_list_etc(amazon_ssm_agent_t) depth: 1
#line 199
 	
#line 199
	allow amazon_ssm_agent_t initrc_exec_t:file { { getattr open read execute ioctl } ioctl lock execute_no_trans };
#line 199

#line 199
	 	
#line 199
##### end init_exec_script_files(amazon_ssm_agent_t) depth: 0
#line 199
 	

 	 	
#line 201
##### begin init_read_utmp(amazon_ssm_agent_t) depth: 1
#line 201
 	
#line 201
	
#line 201
	
#line 201
		require {
#line 201
			
#line 201
		type initrc_var_run_t;
#line 201
	
#line 201
		} # end require
#line 201
	
#line 201

#line 201

#line 201
	 	 	
#line 201
##### begin files_list_pids(amazon_ssm_agent_t) depth: 2
#line 201
 	
#line 201
	
#line 201
	
#line 201
		require {
#line 201
			
#line 201
		type var_t, var_run_t;
#line 201
	
#line 201
		} # end require
#line 201
	
#line 201

#line 201

#line 201
	 	 	
#line 201
##### begin files_search_pids(amazon_ssm_agent_t) depth: 3
#line 201
 	
#line 201
	
#line 201
	
#line 201
		require {
#line 201
			
#line 201
		type var_t, var_run_t;
#line 201
	
#line 201
		} # end require
#line 201
	
#line 201

#line 201

#line 201
	allow amazon_ssm_agent_t var_t:lnk_file { getattr read };
#line 201
	allow amazon_ssm_agent_t var_run_t:lnk_file { getattr read };
#line 201
	
#line 201
	allow amazon_ssm_agent_t var_t:dir { getattr search open };
#line 201
	allow amazon_ssm_agent_t var_run_t:dir { getattr search open };
#line 201

#line 201

#line 201
	 	
#line 201
##### end files_search_pids(amazon_ssm_agent_t) depth: 2
#line 201
 	
#line 201
	
#line 201
	allow amazon_ssm_agent_t var_t:dir { getattr search open };
#line 201
	allow amazon_ssm_agent_t var_run_t:dir { getattr search open read lock ioctl };
#line 201

#line 201

#line 201
	 	
#line 201
##### end files_list_pids(amazon_ssm_agent_t) depth: 1
#line 201
 	
#line 201
	allow amazon_ssm_agent_t initrc_var_run_t:file { open { getattr read ioctl lock } };
#line 201

#line 201
	 	
#line 201
##### end init_read_utmp(amazon_ssm_agent_t) depth: 0
#line 201
 	

 	 	
#line 203
##### begin sudo_exec(amazon_ssm_agent_t) depth: 1
#line 203
 	
#line 203
    
#line 203
	
#line 203
		require {
#line 203
			
#line 203
        type sudo_exec_t;
#line 203
    
#line 203
		} # end require
#line 203
	
#line 203

#line 203

#line 203
	allow amazon_ssm_agent_t sudo_exec_t:file { { getattr open read execute ioctl } ioctl lock execute_no_trans };
#line 203

#line 203
	 	
#line 203
##### end sudo_exec(amazon_ssm_agent_t) depth: 0
#line 203
 	

 	 	
#line 205
##### begin userdom_read_admin_home_files(amazon_ssm_agent_t) depth: 1
#line 205
 	
#line 205
	
#line 205
	
#line 205
		require {
#line 205
			
#line 205
		type admin_home_t;
#line 205
	
#line 205
		} # end require
#line 205
	
#line 205

#line 205

#line 205
	allow amazon_ssm_agent_t admin_home_t:lnk_file { getattr read };
#line 205
	
#line 205
	allow amazon_ssm_agent_t admin_home_t:dir { getattr search open };
#line 205
	allow amazon_ssm_agent_t admin_home_t:file { open { getattr read ioctl lock } };
#line 205

#line 205

#line 205
	 	
#line 205
##### end userdom_read_admin_home_files(amazon_ssm_agent_t) depth: 0
#line 205
 	

 	 	
#line 207
##### begin usermanage_check_exec_passwd(amazon_ssm_agent_t) depth: 1
#line 207
 	
#line 207
	
#line 207
	
#line 207
		require {
#line 207
			
#line 207
		type passwd_exec_t;
#line 207
	
#line 207
		} # end require
#line 207
	
#line 207

#line 207

#line 207
	allow amazon_ssm_agent_t passwd_exec_t:file { execute { getattr } };
#line 207

#line 207
	 	
#line 207
##### end usermanage_check_exec_passwd(amazon_ssm_agent_t) depth: 0
#line 207
 	

 	 	
#line 209
##### begin usermanage_access_check_groupadd(amazon_ssm_agent_t) depth: 1
#line 209
 	
#line 209
	
#line 209
	
#line 209
		require {
#line 209
			
#line 209
		type groupadd_exec_t;
#line 209
	
#line 209
		} # end require
#line 209
	
#line 209

#line 209

#line 209
	 	 	
#line 209
##### begin corecmd_search_bin(amazon_ssm_agent_t) depth: 2
#line 209
 	
#line 209
	
#line 209
	
#line 209
		require {
#line 209
			
#line 209
		type bin_t;
#line 209
	
#line 209
		} # end require
#line 209
	
#line 209

#line 209

#line 209
	 	 	
#line 209
##### begin corecmd_read_bin_symlinks(amazon_ssm_agent_t) depth: 3
#line 209
 	
#line 209
	
#line 209
	
#line 209
		require {
#line 209
			
#line 209
		type bin_t;
#line 209
	
#line 209
		} # end require
#line 209
	
#line 209

#line 209

#line 209
	
#line 209
	allow amazon_ssm_agent_t bin_t:dir { getattr search open };
#line 209
	allow amazon_ssm_agent_t bin_t:lnk_file { getattr read };
#line 209

#line 209

#line 209
	 	
#line 209
##### end corecmd_read_bin_symlinks(amazon_ssm_agent_t) depth: 2
#line 209
 	
#line 209
	
#line 209
	allow amazon_ssm_agent_t bin_t:dir { getattr search open };
#line 209
	allow amazon_ssm_agent_t bin_t:dir { getattr search open };
#line 209

#line 209

#line 209
	 	
#line 209
##### end corecmd_search_bin(amazon_ssm_agent_t) depth: 1
#line 209
 	
#line 209
	allow amazon_ssm_agent_t groupadd_exec_t:file { { getattr } execute };
#line 209

#line 209
	 	
#line 209
##### end usermanage_access_check_groupadd(amazon_ssm_agent_t) depth: 0
#line 209
 	

 	 	
#line 211
##### begin userdom_create_user_pty(amazon_ssm_agent_t) depth: 1
#line 211
 	
#line 211
	
#line 211
	
#line 211
		require {
#line 211
			
#line 211
		type user_devpts_t;
#line 211
	
#line 211
		} # end require
#line 211
	
#line 211

#line 211

#line 211
	 	 	
#line 211
##### begin term_create_pty(amazon_ssm_agent_t,user_devpts_t) depth: 2
#line 211
 	
#line 211
	
#line 211
	
#line 211
		require {
#line 211
			
#line 211
		type bsdpty_device_t, devpts_t, ptmx_t;
#line 211
	
#line 211
		} # end require
#line 211
	
#line 211

#line 211

#line 211
	 	 	
#line 211
##### begin dev_list_all_dev_nodes(amazon_ssm_agent_t) depth: 3
#line 211
 	
#line 211
	
#line 211
	
#line 211
		require {
#line 211
			
#line 211
		type device_t;
#line 211
	
#line 211
		} # end require
#line 211
	
#line 211

#line 211

#line 211
	
#line 211
	allow amazon_ssm_agent_t device_t:dir { getattr search open };
#line 211
	allow amazon_ssm_agent_t device_t:dir { getattr search open read lock ioctl };
#line 211

#line 211
	
#line 211
	allow amazon_ssm_agent_t device_t:dir { getattr search open };
#line 211
	allow amazon_ssm_agent_t device_t:lnk_file { getattr read };
#line 211

#line 211

#line 211
	 	
#line 211
##### end dev_list_all_dev_nodes(amazon_ssm_agent_t) depth: 2
#line 211
 	
#line 211
	allow amazon_ssm_agent_t ptmx_t:chr_file { open { getattr read write append ioctl lock } };
#line 211

#line 211
	allow amazon_ssm_agent_t devpts_t:dir { getattr search open read lock ioctl };
#line 211
	allow amazon_ssm_agent_t devpts_t:filesystem getattr;
#line 211
	dontaudit amazon_ssm_agent_t bsdpty_device_t:chr_file { getattr read write };
#line 211
	type_transition amazon_ssm_agent_t devpts_t:chr_file user_devpts_t;
#line 211

#line 211
	 	
#line 211
##### end term_create_pty(amazon_ssm_agent_t,user_devpts_t) depth: 1
#line 211
 	
#line 211

#line 211
	 	
#line 211
##### end userdom_create_user_pty(amazon_ssm_agent_t) depth: 0
#line 211
 	

 	 	
#line 213
##### begin userdom_use_user_ptys(amazon_ssm_agent_t) depth: 1
#line 213
 	
#line 213
	
#line 213
	
#line 213
		require {
#line 213
			
#line 213
		type user_devpts_t;
#line 213
	
#line 213
		} # end require
#line 213
	
#line 213

#line 213

#line 213
	allow amazon_ssm_agent_t user_devpts_t:chr_file { { getattr lock read write append ioctl } open };
#line 213

#line 213
	 	
#line 213
##### end userdom_use_user_ptys(amazon_ssm_agent_t) depth: 0
#line 213
 	

 	 	
#line 215
##### begin sssd_systemctl(amazon_ssm_agent_t) depth: 1
#line 215
 	
#line 215
       
#line 215
	
#line 215
		require {
#line 215
			
#line 215
               type sssd_t;
#line 215
               type sssd_unit_file_t;
#line 215
       
#line 215
		} # end require
#line 215
	
#line 215

#line 215

#line 215
        	 	
#line 215
##### begin systemd_exec_systemctl(amazon_ssm_agent_t) depth: 2
#line 215
 	
#line 215
        
#line 215
	
#line 215
		require {
#line 215
			
#line 215
                type systemd_systemctl_exec_t;
#line 215
        
#line 215
		} # end require
#line 215
	
#line 215

#line 215

#line 215
	 	 	
#line 215
##### begin corecmd_search_bin(amazon_ssm_agent_t) depth: 3
#line 215
 	
#line 215
	
#line 215
	
#line 215
		require {
#line 215
			
#line 215
		type bin_t;
#line 215
	
#line 215
		} # end require
#line 215
	
#line 215

#line 215

#line 215
	 	 	
#line 215
##### begin corecmd_read_bin_symlinks(amazon_ssm_agent_t) depth: 4
#line 215
 	
#line 215
	
#line 215
	
#line 215
		require {
#line 215
			
#line 215
		type bin_t;
#line 215
	
#line 215
		} # end require
#line 215
	
#line 215

#line 215

#line 215
	
#line 215
	allow amazon_ssm_agent_t bin_t:dir { getattr search open };
#line 215
	allow amazon_ssm_agent_t bin_t:lnk_file { getattr read };
#line 215

#line 215

#line 215
	 	
#line 215
##### end corecmd_read_bin_symlinks(amazon_ssm_agent_t) depth: 3
#line 215
 	
#line 215
	
#line 215
	allow amazon_ssm_agent_t bin_t:dir { getattr search open };
#line 215
	allow amazon_ssm_agent_t bin_t:dir { getattr search open };
#line 215

#line 215

#line 215
	 	
#line 215
##### end corecmd_search_bin(amazon_ssm_agent_t) depth: 2
#line 215
 	
#line 215
	allow amazon_ssm_agent_t systemd_systemctl_exec_t:file { { getattr open read execute ioctl } ioctl lock execute_no_trans };
#line 215

#line 215
	 	 	
#line 215
##### begin fs_list_cgroup_dirs(amazon_ssm_agent_t) depth: 3
#line 215
 	
#line 215
	
#line 215
	
#line 215
		require {
#line 215
			
#line 215
		type cgroup_t;
#line 215
	
#line 215
		} # end require
#line 215
	
#line 215

#line 215

#line 215
	
#line 215
	allow amazon_ssm_agent_t cgroup_t:dir { getattr search open };
#line 215
	allow amazon_ssm_agent_t cgroup_t:dir { getattr search open read lock ioctl };
#line 215

#line 215
	 	 	
#line 215
##### begin fs_search_tmpfs(amazon_ssm_agent_t) depth: 4
#line 215
 	
#line 215
	
#line 215
	
#line 215
		require {
#line 215
			
#line 215
		type tmpfs_t;
#line 215
	
#line 215
		} # end require
#line 215
	
#line 215

#line 215

#line 215
	allow amazon_ssm_agent_t tmpfs_t:dir { getattr search open };
#line 215

#line 215
	 	
#line 215
##### end fs_search_tmpfs(amazon_ssm_agent_t) depth: 3
#line 215
 	
#line 215
	 	 	
#line 215
##### begin dev_search_sysfs(amazon_ssm_agent_t) depth: 4
#line 215
 	
#line 215
	
#line 215
	
#line 215
		require {
#line 215
			
#line 215
		type sysfs_t;
#line 215
	
#line 215
		} # end require
#line 215
	
#line 215

#line 215

#line 215
	
#line 215
	allow amazon_ssm_agent_t sysfs_t:dir { getattr search open };
#line 215
	allow amazon_ssm_agent_t sysfs_t:dir { getattr search open };
#line 215

#line 215

#line 215
	 	
#line 215
##### end dev_search_sysfs(amazon_ssm_agent_t) depth: 3
#line 215
 	
#line 215

#line 215
	 	
#line 215
##### end fs_list_cgroup_dirs(amazon_ssm_agent_t) depth: 2
#line 215
 	
#line 215
	 	 	
#line 215
##### begin fs_read_cgroup_files(amazon_ssm_agent_t) depth: 3
#line 215
 	
#line 215
	
#line 215
	
#line 215
		require {
#line 215
			
#line 215
		type cgroup_t;
#line 215

#line 215
	
#line 215
		} # end require
#line 215
	
#line 215

#line 215

#line 215
	
#line 215
	allow amazon_ssm_agent_t cgroup_t:dir { getattr search open };
#line 215
	allow amazon_ssm_agent_t cgroup_t:file { open { getattr read ioctl lock } };
#line 215

#line 215
	
#line 215
	allow amazon_ssm_agent_t cgroup_t:dir { getattr search open };
#line 215
	allow amazon_ssm_agent_t cgroup_t:lnk_file { getattr read };
#line 215

#line 215
	 	 	
#line 215
##### begin fs_search_tmpfs(amazon_ssm_agent_t) depth: 4
#line 215
 	
#line 215
	
#line 215
	
#line 215
		require {
#line 215
			
#line 215
		type tmpfs_t;
#line 215
	
#line 215
		} # end require
#line 215
	
#line 215

#line 215

#line 215
	allow amazon_ssm_agent_t tmpfs_t:dir { getattr search open };
#line 215

#line 215
	 	
#line 215
##### end fs_search_tmpfs(amazon_ssm_agent_t) depth: 3
#line 215
 	
#line 215
	 	 	
#line 215
##### begin dev_search_sysfs(amazon_ssm_agent_t) depth: 4
#line 215
 	
#line 215
	
#line 215
	
#line 215
		require {
#line 215
			
#line 215
		type sysfs_t;
#line 215
	
#line 215
		} # end require
#line 215
	
#line 215

#line 215

#line 215
	
#line 215
	allow amazon_ssm_agent_t sysfs_t:dir { getattr search open };
#line 215
	allow amazon_ssm_agent_t sysfs_t:dir { getattr search open };
#line 215

#line 215

#line 215
	 	
#line 215
##### end dev_search_sysfs(amazon_ssm_agent_t) depth: 3
#line 215
 	
#line 215

#line 215
	 	
#line 215
##### end fs_read_cgroup_files(amazon_ssm_agent_t) depth: 2
#line 215
 	
#line 215
	 	 	
#line 215
##### begin systemd_list_unit_dirs(amazon_ssm_agent_t) depth: 3
#line 215
 	
#line 215
        
#line 215
	
#line 215
		require {
#line 215
			
#line 215
                attribute systemd_unit_file_type;
#line 215
        
#line 215
		} # end require
#line 215
	
#line 215

#line 215
	
#line 215
	 	 	
#line 215
##### begin files_search_var_lib(amazon_ssm_agent_t) depth: 4
#line 215
 	
#line 215
	
#line 215
	
#line 215
		require {
#line 215
			
#line 215
		type var_t, var_lib_t;
#line 215
	
#line 215
		} # end require
#line 215
	
#line 215

#line 215

#line 215
	
#line 215
	allow amazon_ssm_agent_t var_t:dir { getattr search open };
#line 215
	allow amazon_ssm_agent_t var_lib_t:dir { getattr search open };
#line 215

#line 215

#line 215
	 	
#line 215
##### end files_search_var_lib(amazon_ssm_agent_t) depth: 3
#line 215
 	
#line 215
	allow amazon_ssm_agent_t systemd_unit_file_type:dir { getattr search open read lock ioctl };
#line 215

#line 215
	 	
#line 215
##### end systemd_list_unit_dirs(amazon_ssm_agent_t) depth: 2
#line 215
 	
#line 215
	 	 	
#line 215
##### begin init_list_pid_dirs(amazon_ssm_agent_t) depth: 3
#line 215
 	
#line 215
    
#line 215
	
#line 215
		require {
#line 215
			
#line 215
        type init_var_run_t;
#line 215
    
#line 215
		} # end require
#line 215
	
#line 215

#line 215

#line 215
    allow amazon_ssm_agent_t init_var_run_t:dir { getattr search open read lock ioctl };
#line 215

#line 215
	 	
#line 215
##### end init_list_pid_dirs(amazon_ssm_agent_t) depth: 2
#line 215
 	
#line 215
	 	 	
#line 215
##### begin init_read_state(amazon_ssm_agent_t) depth: 3
#line 215
 	
#line 215
	
#line 215
	
#line 215
		require {
#line 215
			
#line 215
		type init_t;
#line 215
	
#line 215
		} # end require
#line 215
	
#line 215

#line 215

#line 215
	allow amazon_ssm_agent_t init_t:dir { getattr search open };
#line 215
	allow amazon_ssm_agent_t init_t:file { open { getattr read ioctl lock } };
#line 215
	allow amazon_ssm_agent_t init_t:lnk_file { getattr read };
#line 215

#line 215
	 	
#line 215
##### end init_read_state(amazon_ssm_agent_t) depth: 2
#line 215
 	
#line 215
	 	 	
#line 215
##### begin init_stream_send(amazon_ssm_agent_t) depth: 3
#line 215
 	
#line 215
	
#line 215
	
#line 215
		require {
#line 215
			
#line 215
		type init_t;
#line 215
	
#line 215
		} # end require
#line 215
	
#line 215

#line 215

#line 215
	allow amazon_ssm_agent_t init_t:unix_stream_socket sendto;
#line 215

#line 215
	 	
#line 215
##### end init_stream_send(amazon_ssm_agent_t) depth: 2
#line 215
 	
#line 215
	 	 	
#line 215
##### begin init_stream_connect(amazon_ssm_agent_t) depth: 3
#line 215
 	
#line 215
	
#line 215
	
#line 215
		require {
#line 215
			
#line 215
		type init_t, init_var_run_t;
#line 215
	
#line 215
		} # end require
#line 215
	
#line 215

#line 215

#line 215
	 	 	
#line 215
##### begin files_search_pids(amazon_ssm_agent_t) depth: 4
#line 215
 	
#line 215
	
#line 215
	
#line 215
		require {
#line 215
			
#line 215
		type var_t, var_run_t;
#line 215
	
#line 215
		} # end require
#line 215
	
#line 215

#line 215

#line 215
	allow amazon_ssm_agent_t var_t:lnk_file { getattr read };
#line 215
	allow amazon_ssm_agent_t var_run_t:lnk_file { getattr read };
#line 215
	
#line 215
	allow amazon_ssm_agent_t var_t:dir { getattr search open };
#line 215
	allow amazon_ssm_agent_t var_run_t:dir { getattr search open };
#line 215

#line 215

#line 215
	 	
#line 215
##### end files_search_pids(amazon_ssm_agent_t) depth: 3
#line 215
 	
#line 215
	
#line 215
	allow amazon_ssm_agent_t init_var_run_t:dir { getattr search open };
#line 215
	allow amazon_ssm_agent_t init_var_run_t:sock_file { getattr write open append };
#line 215
	allow amazon_ssm_agent_t init_t:unix_stream_socket connectto;
#line 215
    
#line 215
	allow amazon_ssm_agent_t init_t:unix_stream_socket getattr;
#line 215

#line 215
	 	
#line 215
##### end init_stream_connect(amazon_ssm_agent_t) depth: 2
#line 215
 	
#line 215

#line 215
	 	 	
#line 215
##### begin systemd_login_list_pid_dirs(amazon_ssm_agent_t) depth: 3
#line 215
 	
#line 215
	
#line 215
	
#line 215
		require {
#line 215
			
#line 215
		type systemd_logind_var_run_t;
#line 215
	
#line 215
		} # end require
#line 215
	
#line 215

#line 215

#line 215
	 	 	
#line 215
##### begin files_search_pids(amazon_ssm_agent_t) depth: 4
#line 215
 	
#line 215
	
#line 215
	
#line 215
		require {
#line 215
			
#line 215
		type var_t, var_run_t;
#line 215
	
#line 215
		} # end require
#line 215
	
#line 215

#line 215

#line 215
	allow amazon_ssm_agent_t var_t:lnk_file { getattr read };
#line 215
	allow amazon_ssm_agent_t var_run_t:lnk_file { getattr read };
#line 215
	
#line 215
	allow amazon_ssm_agent_t var_t:dir { getattr search open };
#line 215
	allow amazon_ssm_agent_t var_run_t:dir { getattr search open };
#line 215

#line 215

#line 215
	 	
#line 215
##### end files_search_pids(amazon_ssm_agent_t) depth: 3
#line 215
 	
#line 215
	
#line 215
	allow amazon_ssm_agent_t systemd_logind_var_run_t:dir { getattr search open };
#line 215
	allow amazon_ssm_agent_t systemd_logind_var_run_t:dir { getattr search open read lock ioctl };
#line 215

#line 215

#line 215
	 	
#line 215
##### end systemd_login_list_pid_dirs(amazon_ssm_agent_t) depth: 2
#line 215
 	
#line 215
	 	 	
#line 215
##### begin systemd_login_read_pid_files(amazon_ssm_agent_t) depth: 3
#line 215
 	
#line 215
	
#line 215
	
#line 215
		require {
#line 215
			
#line 215
		type systemd_logind_var_run_t;
#line 215
	
#line 215
		} # end require
#line 215
	
#line 215

#line 215

#line 215
	 	 	
#line 215
##### begin files_search_pids(amazon_ssm_agent_t) depth: 4
#line 215
 	
#line 215
	
#line 215
	
#line 215
		require {
#line 215
			
#line 215
		type var_t, var_run_t;
#line 215
	
#line 215
		} # end require
#line 215
	
#line 215

#line 215

#line 215
	allow amazon_ssm_agent_t var_t:lnk_file { getattr read };
#line 215
	allow amazon_ssm_agent_t var_run_t:lnk_file { getattr read };
#line 215
	
#line 215
	allow amazon_ssm_agent_t var_t:dir { getattr search open };
#line 215
	allow amazon_ssm_agent_t var_run_t:dir { getattr search open };
#line 215

#line 215

#line 215
	 	
#line 215
##### end files_search_pids(amazon_ssm_agent_t) depth: 3
#line 215
 	
#line 215
	
#line 215
	allow amazon_ssm_agent_t systemd_logind_var_run_t:dir { getattr search open };
#line 215
	allow amazon_ssm_agent_t systemd_logind_var_run_t:file { open { getattr read ioctl lock } };
#line 215

#line 215

#line 215
	 	
#line 215
##### end systemd_login_read_pid_files(amazon_ssm_agent_t) depth: 2
#line 215
 	
#line 215
	 	 	
#line 215
##### begin systemd_passwd_agent_exec(amazon_ssm_agent_t) depth: 3
#line 215
 	
#line 215
	
#line 215
	
#line 215
		require {
#line 215
			
#line 215
		type systemd_passwd_agent_t, systemd_passwd_agent_exec_t;
#line 215
	
#line 215
		} # end require
#line 215
	
#line 215

#line 215

#line 215
	allow amazon_ssm_agent_t systemd_passwd_agent_exec_t:file { { getattr open read execute ioctl } ioctl lock execute_no_trans };
#line 215
	 	 	
#line 215
##### begin systemd_manage_passwd_run(amazon_ssm_agent_t) depth: 4
#line 215
 	
#line 215
	
#line 215
	
#line 215
		require {
#line 215
			
#line 215
		type systemd_passwd_agent_t;	
#line 215
		type systemd_passwd_var_run_t;
#line 215
	
#line 215
		} # end require
#line 215
	
#line 215

#line 215

#line 215
	 	 	
#line 215
##### begin init_search_pid_dirs(amazon_ssm_agent_t) depth: 5
#line 215
 	
#line 215
    
#line 215
	
#line 215
		require {
#line 215
			
#line 215
        type init_var_run_t;
#line 215
    
#line 215
		} # end require
#line 215
	
#line 215

#line 215

#line 215
    allow amazon_ssm_agent_t init_var_run_t:dir { getattr search open };
#line 215

#line 215
	 	
#line 215
##### end init_search_pid_dirs(amazon_ssm_agent_t) depth: 4
#line 215
 	
#line 215
	
#line 215
	allow amazon_ssm_agent_t systemd_passwd_var_run_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 215
	allow amazon_ssm_agent_t systemd_passwd_var_run_t:file { create open getattr setattr read write append rename link unlink ioctl lock };
#line 215

#line 215
	
#line 215
	allow amazon_ssm_agent_t systemd_passwd_var_run_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 215
	allow amazon_ssm_agent_t systemd_passwd_var_run_t:sock_file { create open getattr setattr read write rename link unlink ioctl lock append };
#line 215

#line 215
	
#line 215
	allow amazon_ssm_agent_t systemd_passwd_var_run_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 215
	allow amazon_ssm_agent_t systemd_passwd_var_run_t:fifo_file { create open getattr setattr read write append rename link unlink ioctl lock };
#line 215

#line 215

#line 215
	allow systemd_passwd_agent_t amazon_ssm_agent_t:process signull;
#line 215
	allow systemd_passwd_agent_t amazon_ssm_agent_t:unix_dgram_socket sendto;
#line 215

#line 215
	 	
#line 215
##### end systemd_manage_passwd_run(amazon_ssm_agent_t) depth: 3
#line 215
 	
#line 215

#line 215
	 	
#line 215
##### end systemd_passwd_agent_exec(amazon_ssm_agent_t) depth: 2
#line 215
 	
#line 215

#line 215
	dontaudit amazon_ssm_agent_t self:capability net_admin;
#line 215

#line 215
	 	
#line 215
##### end systemd_exec_systemctl(amazon_ssm_agent_t) depth: 1
#line 215
 	
#line 215
	 	 	
#line 215
##### begin init_reload_services(amazon_ssm_agent_t) depth: 2
#line 215
 	
#line 215
	
#line 215
	
#line 215
		require {
#line 215
			
#line 215
		type init_t;
#line 215
	
#line 215
		} # end require
#line 215
	
#line 215

#line 215

#line 215
	allow amazon_ssm_agent_t init_t:system reload;
#line 215

#line 215
	 	
#line 215
##### end init_reload_services(amazon_ssm_agent_t) depth: 1
#line 215
 	
#line 215
       allow amazon_ssm_agent_t sssd_unit_file_t:file { open { getattr read ioctl lock } };
#line 215
       allow amazon_ssm_agent_t sssd_unit_file_t:service { start stop status reload enable disable } ;
#line 215

#line 215
       
#line 215
	allow amazon_ssm_agent_t sssd_t:dir { getattr search open read lock ioctl };
#line 215
	allow amazon_ssm_agent_t sssd_t:file { open { getattr read ioctl lock } };
#line 215
	allow amazon_ssm_agent_t sssd_t:lnk_file { getattr read };
#line 215
	allow amazon_ssm_agent_t sssd_t:process getattr;
#line 215

#line 215

#line 215
	 	
#line 215
##### end sssd_systemctl(amazon_ssm_agent_t) depth: 0
#line 215
 	

 	 	
#line 217
##### begin files_manage_generic_tmp_files(amazon_ssm_agent_t) depth: 1
#line 217
 	
#line 217
	
#line 217
	
#line 217
		require {
#line 217
			
#line 217
		type tmp_t;
#line 217
	
#line 217
		} # end require
#line 217
	
#line 217

#line 217

#line 217
	
#line 217
	allow amazon_ssm_agent_t tmp_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 217
	allow amazon_ssm_agent_t tmp_t:file { create open getattr setattr read write append rename link unlink ioctl lock };
#line 217

#line 217

#line 217
	 	
#line 217
##### end files_manage_generic_tmp_files(amazon_ssm_agent_t) depth: 0
#line 217
 	

 	 	
#line 219
##### begin ipa_filetrans_named_content(amazon_ssm_agent_t) depth: 1
#line 219
 	
#line 219

#line 219
    
#line 219
	
#line 219
		require {
#line 219
			
#line 219
        type ipa_tmp_t;
#line 219
    
#line 219
		} # end require
#line 219
	
#line 219

#line 219
    
#line 219
     	 	
#line 219
##### begin files_tmp_filetrans(amazon_ssm_agent_t,ipa_tmp_t,file,"ca.p12") depth: 2
#line 219
 	
#line 219
	
#line 219
	
#line 219
		require {
#line 219
			
#line 219
		type tmp_t;
#line 219
	
#line 219
		} # end require
#line 219
	
#line 219

#line 219

#line 219
	
#line 219
	allow amazon_ssm_agent_t tmp_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 219
	type_transition amazon_ssm_agent_t tmp_t:file ipa_tmp_t "ca.p12";
#line 219

#line 219

#line 219
	 	
#line 219
##### end files_tmp_filetrans(amazon_ssm_agent_t,ipa_tmp_t,file,"ca.p12") depth: 1
#line 219
 	
#line 219

#line 219
	 	
#line 219
##### end ipa_filetrans_named_content(amazon_ssm_agent_t) depth: 0
#line 219
 	

 	 	
#line 221
##### begin files_manage_mounttab(amazon_ssm_agent_t) depth: 1
#line 221
 	
#line 221
	
#line 221
	
#line 221
		require {
#line 221
			
#line 221
		type var_t, var_lib_t;
#line 221
	
#line 221
		} # end require
#line 221
	
#line 221

#line 221

#line 221
	allow amazon_ssm_agent_t var_t:dir { getattr search open };
#line 221
	
#line 221
	allow amazon_ssm_agent_t var_lib_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 221
	allow amazon_ssm_agent_t var_lib_t:file { create open getattr setattr read write append rename link unlink ioctl lock };
#line 221

#line 221

#line 221
	 	
#line 221
##### end files_manage_mounttab(amazon_ssm_agent_t) depth: 0
#line 221
 	

 	 	
#line 223
##### begin corecmd_manage_bin_files(amazon_ssm_agent_t) depth: 1
#line 223
 	
#line 223
	
#line 223
	
#line 223
		require {
#line 223
			
#line 223
		type bin_t;
#line 223
	
#line 223
		} # end require
#line 223
	
#line 223

#line 223

#line 223
	 	 	
#line 223
##### begin corecmd_read_bin_symlinks(amazon_ssm_agent_t) depth: 2
#line 223
 	
#line 223
	
#line 223
	
#line 223
		require {
#line 223
			
#line 223
		type bin_t;
#line 223
	
#line 223
		} # end require
#line 223
	
#line 223

#line 223

#line 223
	
#line 223
	allow amazon_ssm_agent_t bin_t:dir { getattr search open };
#line 223
	allow amazon_ssm_agent_t bin_t:lnk_file { getattr read };
#line 223

#line 223

#line 223
	 	
#line 223
##### end corecmd_read_bin_symlinks(amazon_ssm_agent_t) depth: 1
#line 223
 	
#line 223
	
#line 223
	allow amazon_ssm_agent_t bin_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 223
	allow amazon_ssm_agent_t bin_t:file { create open getattr setattr read write append rename link unlink ioctl lock };
#line 223

#line 223

#line 223
	 	
#line 223
##### end corecmd_manage_bin_files(amazon_ssm_agent_t) depth: 0
#line 223
 	

 	 	
#line 225
##### begin corecmd_relabel_bin_files(amazon_ssm_agent_t) depth: 1
#line 225
 	
#line 225
	
#line 225
	
#line 225
		require {
#line 225
			
#line 225
		type bin_t;
#line 225
	
#line 225
		} # end require
#line 225
	
#line 225

#line 225

#line 225
	
#line 225
	allow amazon_ssm_agent_t bin_t:dir { getattr search open };
#line 225
	allow amazon_ssm_agent_t bin_t:file { getattr relabelfrom relabelto };
#line 225

#line 225

#line 225
	 	
#line 225
##### end corecmd_relabel_bin_files(amazon_ssm_agent_t) depth: 0
#line 225
 	

 	 	
#line 227
##### begin dbus_system_bus_client(amazon_ssm_agent_t) depth: 1
#line 227
 	
#line 227
	
#line 227
	
#line 227
		require {
#line 227
			
#line 227
		type system_dbusd_t, system_dbusd_t;
#line 227
		type system_dbusd_var_run_t, system_dbusd_var_lib_t;
#line 227
		class dbus send_msg;
#line 227
		attribute dbusd_unconfined;
#line 227
	
#line 227
		} # end require
#line 227
	
#line 227

#line 227

#line 227
	# SE-DBus specific permissions
#line 227
	allow amazon_ssm_agent_t { system_dbusd_t self }:dbus send_msg;
#line 227
	allow { system_dbusd_t dbusd_unconfined } amazon_ssm_agent_t:dbus send_msg;
#line 227

#line 227
	
#line 227
	allow amazon_ssm_agent_t system_dbusd_var_lib_t:dir { getattr search open };
#line 227
	allow amazon_ssm_agent_t system_dbusd_var_lib_t:file { open { getattr read ioctl lock } };
#line 227

#line 227
	 	 	
#line 227
##### begin files_search_var_lib(amazon_ssm_agent_t) depth: 2
#line 227
 	
#line 227
	
#line 227
	
#line 227
		require {
#line 227
			
#line 227
		type var_t, var_lib_t;
#line 227
	
#line 227
		} # end require
#line 227
	
#line 227

#line 227

#line 227
	
#line 227
	allow amazon_ssm_agent_t var_t:dir { getattr search open };
#line 227
	allow amazon_ssm_agent_t var_lib_t:dir { getattr search open };
#line 227

#line 227

#line 227
	 	
#line 227
##### end files_search_var_lib(amazon_ssm_agent_t) depth: 1
#line 227
 	
#line 227

#line 227
	 	 	
#line 227
##### begin dev_read_urand(amazon_ssm_agent_t) depth: 2
#line 227
 	
#line 227
	
#line 227
	
#line 227
		require {
#line 227
			
#line 227
		type device_t, urandom_device_t;
#line 227
	
#line 227
		} # end require
#line 227
	
#line 227

#line 227

#line 227
	
#line 227
	allow amazon_ssm_agent_t device_t:dir { getattr search open };
#line 227
	allow amazon_ssm_agent_t urandom_device_t:chr_file { getattr open read lock ioctl };
#line 227

#line 227

#line 227
	 	
#line 227
##### end dev_read_urand(amazon_ssm_agent_t) depth: 1
#line 227
 	
#line 227

#line 227
	# For connecting to the bus
#line 227
	 	 	
#line 227
##### begin files_search_pids(amazon_ssm_agent_t) depth: 2
#line 227
 	
#line 227
	
#line 227
	
#line 227
		require {
#line 227
			
#line 227
		type var_t, var_run_t;
#line 227
	
#line 227
		} # end require
#line 227
	
#line 227

#line 227

#line 227
	allow amazon_ssm_agent_t var_t:lnk_file { getattr read };
#line 227
	allow amazon_ssm_agent_t var_run_t:lnk_file { getattr read };
#line 227
	
#line 227
	allow amazon_ssm_agent_t var_t:dir { getattr search open };
#line 227
	allow amazon_ssm_agent_t var_run_t:dir { getattr search open };
#line 227

#line 227

#line 227
	 	
#line 227
##### end files_search_pids(amazon_ssm_agent_t) depth: 1
#line 227
 	
#line 227
	
#line 227
	allow amazon_ssm_agent_t system_dbusd_var_run_t:dir { getattr search open };
#line 227
	allow amazon_ssm_agent_t system_dbusd_var_run_t:sock_file { getattr write open append };
#line 227
	allow amazon_ssm_agent_t system_dbusd_t:unix_stream_socket connectto;
#line 227

#line 227
	 	 	
#line 227
##### begin dbus_read_config(amazon_ssm_agent_t) depth: 2
#line 227
 	
#line 227
	
#line 227
	
#line 227
		require {
#line 227
			
#line 227
		type dbusd_etc_t;
#line 227
	
#line 227
		} # end require
#line 227
	
#line 227

#line 227

#line 227
	allow amazon_ssm_agent_t dbusd_etc_t:dir { getattr search open read lock ioctl };
#line 227
	allow amazon_ssm_agent_t dbusd_etc_t:file { open { getattr read ioctl lock } };
#line 227

#line 227
	 	
#line 227
##### end dbus_read_config(amazon_ssm_agent_t) depth: 1
#line 227
 	
#line 227

#line 227
    
#line 227
	optional {
#line 227
		
#line 227
         	 	
#line 227
##### begin unconfined_server_dbus_chat(amazon_ssm_agent_t) depth: 2
#line 227
 	
#line 227
	
#line 227
	
#line 227
		require {
#line 227
			
#line 227
		type unconfined_service_t;
#line 227
        class dbus send_msg;
#line 227
	
#line 227
		} # end require
#line 227
	
#line 227

#line 227

#line 227
        allow amazon_ssm_agent_t unconfined_service_t:dbus send_msg;
#line 227
        allow unconfined_service_t amazon_ssm_agent_t:dbus send_msg;
#line 227

#line 227
	 	
#line 227
##### end unconfined_server_dbus_chat(amazon_ssm_agent_t) depth: 1
#line 227
 	
#line 227
    
#line 227
	} # end optional
#line 227

#line 227

#line 227
	 	
#line 227
##### end dbus_system_bus_client(amazon_ssm_agent_t) depth: 0
#line 227
 	

 	 	
#line 229
##### begin fs_getattr_tmpfs(amazon_ssm_agent_t) depth: 1
#line 229
 	
#line 229
	
#line 229
	
#line 229
		require {
#line 229
			
#line 229
		type tmpfs_t;
#line 229
	
#line 229
		} # end require
#line 229
	
#line 229

#line 229

#line 229
	allow amazon_ssm_agent_t tmpfs_t:filesystem getattr;
#line 229

#line 229
	 	
#line 229
##### end fs_getattr_tmpfs(amazon_ssm_agent_t) depth: 0
#line 229
 	

 	 	
#line 231
##### begin init_exec(amazon_ssm_agent_t) depth: 1
#line 231
 	
#line 231
	
#line 231
	
#line 231
		require {
#line 231
			
#line 231
		type init_exec_t;
#line 231
	
#line 231
		} # end require
#line 231
	
#line 231

#line 231

#line 231
	 	 	
#line 231
##### begin corecmd_search_bin(amazon_ssm_agent_t) depth: 2
#line 231
 	
#line 231
	
#line 231
	
#line 231
		require {
#line 231
			
#line 231
		type bin_t;
#line 231
	
#line 231
		} # end require
#line 231
	
#line 231

#line 231

#line 231
	 	 	
#line 231
##### begin corecmd_read_bin_symlinks(amazon_ssm_agent_t) depth: 3
#line 231
 	
#line 231
	
#line 231
	
#line 231
		require {
#line 231
			
#line 231
		type bin_t;
#line 231
	
#line 231
		} # end require
#line 231
	
#line 231

#line 231

#line 231
	
#line 231
	allow amazon_ssm_agent_t bin_t:dir { getattr search open };
#line 231
	allow amazon_ssm_agent_t bin_t:lnk_file { getattr read };
#line 231

#line 231

#line 231
	 	
#line 231
##### end corecmd_read_bin_symlinks(amazon_ssm_agent_t) depth: 2
#line 231
 	
#line 231
	
#line 231
	allow amazon_ssm_agent_t bin_t:dir { getattr search open };
#line 231
	allow amazon_ssm_agent_t bin_t:dir { getattr search open };
#line 231

#line 231

#line 231
	 	
#line 231
##### end corecmd_search_bin(amazon_ssm_agent_t) depth: 1
#line 231
 	
#line 231
	allow amazon_ssm_agent_t init_exec_t:file { { getattr open read execute ioctl } ioctl lock execute_no_trans };
#line 231

#line 231
	
#line 231
	optional {
#line 231
		
#line 231
		 	 	
#line 231
##### begin systemd_exec_systemctl(amazon_ssm_agent_t) depth: 2
#line 231
 	
#line 231
        
#line 231
	
#line 231
		require {
#line 231
			
#line 231
                type systemd_systemctl_exec_t;
#line 231
        
#line 231
		} # end require
#line 231
	
#line 231

#line 231

#line 231
	 	 	
#line 231
##### begin corecmd_search_bin(amazon_ssm_agent_t) depth: 3
#line 231
 	
#line 231
	
#line 231
	
#line 231
		require {
#line 231
			
#line 231
		type bin_t;
#line 231
	
#line 231
		} # end require
#line 231
	
#line 231

#line 231

#line 231
	 	 	
#line 231
##### begin corecmd_read_bin_symlinks(amazon_ssm_agent_t) depth: 4
#line 231
 	
#line 231
	
#line 231
	
#line 231
		require {
#line 231
			
#line 231
		type bin_t;
#line 231
	
#line 231
		} # end require
#line 231
	
#line 231

#line 231

#line 231
	
#line 231
	allow amazon_ssm_agent_t bin_t:dir { getattr search open };
#line 231
	allow amazon_ssm_agent_t bin_t:lnk_file { getattr read };
#line 231

#line 231

#line 231
	 	
#line 231
##### end corecmd_read_bin_symlinks(amazon_ssm_agent_t) depth: 3
#line 231
 	
#line 231
	
#line 231
	allow amazon_ssm_agent_t bin_t:dir { getattr search open };
#line 231
	allow amazon_ssm_agent_t bin_t:dir { getattr search open };
#line 231

#line 231

#line 231
	 	
#line 231
##### end corecmd_search_bin(amazon_ssm_agent_t) depth: 2
#line 231
 	
#line 231
	allow amazon_ssm_agent_t systemd_systemctl_exec_t:file { { getattr open read execute ioctl } ioctl lock execute_no_trans };
#line 231

#line 231
	 	 	
#line 231
##### begin fs_list_cgroup_dirs(amazon_ssm_agent_t) depth: 3
#line 231
 	
#line 231
	
#line 231
	
#line 231
		require {
#line 231
			
#line 231
		type cgroup_t;
#line 231
	
#line 231
		} # end require
#line 231
	
#line 231

#line 231

#line 231
	
#line 231
	allow amazon_ssm_agent_t cgroup_t:dir { getattr search open };
#line 231
	allow amazon_ssm_agent_t cgroup_t:dir { getattr search open read lock ioctl };
#line 231

#line 231
	 	 	
#line 231
##### begin fs_search_tmpfs(amazon_ssm_agent_t) depth: 4
#line 231
 	
#line 231
	
#line 231
	
#line 231
		require {
#line 231
			
#line 231
		type tmpfs_t;
#line 231
	
#line 231
		} # end require
#line 231
	
#line 231

#line 231

#line 231
	allow amazon_ssm_agent_t tmpfs_t:dir { getattr search open };
#line 231

#line 231
	 	
#line 231
##### end fs_search_tmpfs(amazon_ssm_agent_t) depth: 3
#line 231
 	
#line 231
	 	 	
#line 231
##### begin dev_search_sysfs(amazon_ssm_agent_t) depth: 4
#line 231
 	
#line 231
	
#line 231
	
#line 231
		require {
#line 231
			
#line 231
		type sysfs_t;
#line 231
	
#line 231
		} # end require
#line 231
	
#line 231

#line 231

#line 231
	
#line 231
	allow amazon_ssm_agent_t sysfs_t:dir { getattr search open };
#line 231
	allow amazon_ssm_agent_t sysfs_t:dir { getattr search open };
#line 231

#line 231

#line 231
	 	
#line 231
##### end dev_search_sysfs(amazon_ssm_agent_t) depth: 3
#line 231
 	
#line 231

#line 231
	 	
#line 231
##### end fs_list_cgroup_dirs(amazon_ssm_agent_t) depth: 2
#line 231
 	
#line 231
	 	 	
#line 231
##### begin fs_read_cgroup_files(amazon_ssm_agent_t) depth: 3
#line 231
 	
#line 231
	
#line 231
	
#line 231
		require {
#line 231
			
#line 231
		type cgroup_t;
#line 231

#line 231
	
#line 231
		} # end require
#line 231
	
#line 231

#line 231

#line 231
	
#line 231
	allow amazon_ssm_agent_t cgroup_t:dir { getattr search open };
#line 231
	allow amazon_ssm_agent_t cgroup_t:file { open { getattr read ioctl lock } };
#line 231

#line 231
	
#line 231
	allow amazon_ssm_agent_t cgroup_t:dir { getattr search open };
#line 231
	allow amazon_ssm_agent_t cgroup_t:lnk_file { getattr read };
#line 231

#line 231
	 	 	
#line 231
##### begin fs_search_tmpfs(amazon_ssm_agent_t) depth: 4
#line 231
 	
#line 231
	
#line 231
	
#line 231
		require {
#line 231
			
#line 231
		type tmpfs_t;
#line 231
	
#line 231
		} # end require
#line 231
	
#line 231

#line 231

#line 231
	allow amazon_ssm_agent_t tmpfs_t:dir { getattr search open };
#line 231

#line 231
	 	
#line 231
##### end fs_search_tmpfs(amazon_ssm_agent_t) depth: 3
#line 231
 	
#line 231
	 	 	
#line 231
##### begin dev_search_sysfs(amazon_ssm_agent_t) depth: 4
#line 231
 	
#line 231
	
#line 231
	
#line 231
		require {
#line 231
			
#line 231
		type sysfs_t;
#line 231
	
#line 231
		} # end require
#line 231
	
#line 231

#line 231

#line 231
	
#line 231
	allow amazon_ssm_agent_t sysfs_t:dir { getattr search open };
#line 231
	allow amazon_ssm_agent_t sysfs_t:dir { getattr search open };
#line 231

#line 231

#line 231
	 	
#line 231
##### end dev_search_sysfs(amazon_ssm_agent_t) depth: 3
#line 231
 	
#line 231

#line 231
	 	
#line 231
##### end fs_read_cgroup_files(amazon_ssm_agent_t) depth: 2
#line 231
 	
#line 231
	 	 	
#line 231
##### begin systemd_list_unit_dirs(amazon_ssm_agent_t) depth: 3
#line 231
 	
#line 231
        
#line 231
	
#line 231
		require {
#line 231
			
#line 231
                attribute systemd_unit_file_type;
#line 231
        
#line 231
		} # end require
#line 231
	
#line 231

#line 231
	
#line 231
	 	 	
#line 231
##### begin files_search_var_lib(amazon_ssm_agent_t) depth: 4
#line 231
 	
#line 231
	
#line 231
	
#line 231
		require {
#line 231
			
#line 231
		type var_t, var_lib_t;
#line 231
	
#line 231
		} # end require
#line 231
	
#line 231

#line 231

#line 231
	
#line 231
	allow amazon_ssm_agent_t var_t:dir { getattr search open };
#line 231
	allow amazon_ssm_agent_t var_lib_t:dir { getattr search open };
#line 231

#line 231

#line 231
	 	
#line 231
##### end files_search_var_lib(amazon_ssm_agent_t) depth: 3
#line 231
 	
#line 231
	allow amazon_ssm_agent_t systemd_unit_file_type:dir { getattr search open read lock ioctl };
#line 231

#line 231
	 	
#line 231
##### end systemd_list_unit_dirs(amazon_ssm_agent_t) depth: 2
#line 231
 	
#line 231
	 	 	
#line 231
##### begin init_list_pid_dirs(amazon_ssm_agent_t) depth: 3
#line 231
 	
#line 231
    
#line 231
	
#line 231
		require {
#line 231
			
#line 231
        type init_var_run_t;
#line 231
    
#line 231
		} # end require
#line 231
	
#line 231

#line 231

#line 231
    allow amazon_ssm_agent_t init_var_run_t:dir { getattr search open read lock ioctl };
#line 231

#line 231
	 	
#line 231
##### end init_list_pid_dirs(amazon_ssm_agent_t) depth: 2
#line 231
 	
#line 231
	 	 	
#line 231
##### begin init_read_state(amazon_ssm_agent_t) depth: 3
#line 231
 	
#line 231
	
#line 231
	
#line 231
		require {
#line 231
			
#line 231
		type init_t;
#line 231
	
#line 231
		} # end require
#line 231
	
#line 231

#line 231

#line 231
	allow amazon_ssm_agent_t init_t:dir { getattr search open };
#line 231
	allow amazon_ssm_agent_t init_t:file { open { getattr read ioctl lock } };
#line 231
	allow amazon_ssm_agent_t init_t:lnk_file { getattr read };
#line 231

#line 231
	 	
#line 231
##### end init_read_state(amazon_ssm_agent_t) depth: 2
#line 231
 	
#line 231
	 	 	
#line 231
##### begin init_stream_send(amazon_ssm_agent_t) depth: 3
#line 231
 	
#line 231
	
#line 231
	
#line 231
		require {
#line 231
			
#line 231
		type init_t;
#line 231
	
#line 231
		} # end require
#line 231
	
#line 231

#line 231

#line 231
	allow amazon_ssm_agent_t init_t:unix_stream_socket sendto;
#line 231

#line 231
	 	
#line 231
##### end init_stream_send(amazon_ssm_agent_t) depth: 2
#line 231
 	
#line 231
	 	 	
#line 231
##### begin init_stream_connect(amazon_ssm_agent_t) depth: 3
#line 231
 	
#line 231
	
#line 231
	
#line 231
		require {
#line 231
			
#line 231
		type init_t, init_var_run_t;
#line 231
	
#line 231
		} # end require
#line 231
	
#line 231

#line 231

#line 231
	 	 	
#line 231
##### begin files_search_pids(amazon_ssm_agent_t) depth: 4
#line 231
 	
#line 231
	
#line 231
	
#line 231
		require {
#line 231
			
#line 231
		type var_t, var_run_t;
#line 231
	
#line 231
		} # end require
#line 231
	
#line 231

#line 231

#line 231
	allow amazon_ssm_agent_t var_t:lnk_file { getattr read };
#line 231
	allow amazon_ssm_agent_t var_run_t:lnk_file { getattr read };
#line 231
	
#line 231
	allow amazon_ssm_agent_t var_t:dir { getattr search open };
#line 231
	allow amazon_ssm_agent_t var_run_t:dir { getattr search open };
#line 231

#line 231

#line 231
	 	
#line 231
##### end files_search_pids(amazon_ssm_agent_t) depth: 3
#line 231
 	
#line 231
	
#line 231
	allow amazon_ssm_agent_t init_var_run_t:dir { getattr search open };
#line 231
	allow amazon_ssm_agent_t init_var_run_t:sock_file { getattr write open append };
#line 231
	allow amazon_ssm_agent_t init_t:unix_stream_socket connectto;
#line 231
    
#line 231
	allow amazon_ssm_agent_t init_t:unix_stream_socket getattr;
#line 231

#line 231
	 	
#line 231
##### end init_stream_connect(amazon_ssm_agent_t) depth: 2
#line 231
 	
#line 231

#line 231
	 	 	
#line 231
##### begin systemd_login_list_pid_dirs(amazon_ssm_agent_t) depth: 3
#line 231
 	
#line 231
	
#line 231
	
#line 231
		require {
#line 231
			
#line 231
		type systemd_logind_var_run_t;
#line 231
	
#line 231
		} # end require
#line 231
	
#line 231

#line 231

#line 231
	 	 	
#line 231
##### begin files_search_pids(amazon_ssm_agent_t) depth: 4
#line 231
 	
#line 231
	
#line 231
	
#line 231
		require {
#line 231
			
#line 231
		type var_t, var_run_t;
#line 231
	
#line 231
		} # end require
#line 231
	
#line 231

#line 231

#line 231
	allow amazon_ssm_agent_t var_t:lnk_file { getattr read };
#line 231
	allow amazon_ssm_agent_t var_run_t:lnk_file { getattr read };
#line 231
	
#line 231
	allow amazon_ssm_agent_t var_t:dir { getattr search open };
#line 231
	allow amazon_ssm_agent_t var_run_t:dir { getattr search open };
#line 231

#line 231

#line 231
	 	
#line 231
##### end files_search_pids(amazon_ssm_agent_t) depth: 3
#line 231
 	
#line 231
	
#line 231
	allow amazon_ssm_agent_t systemd_logind_var_run_t:dir { getattr search open };
#line 231
	allow amazon_ssm_agent_t systemd_logind_var_run_t:dir { getattr search open read lock ioctl };
#line 231

#line 231

#line 231
	 	
#line 231
##### end systemd_login_list_pid_dirs(amazon_ssm_agent_t) depth: 2
#line 231
 	
#line 231
	 	 	
#line 231
##### begin systemd_login_read_pid_files(amazon_ssm_agent_t) depth: 3
#line 231
 	
#line 231
	
#line 231
	
#line 231
		require {
#line 231
			
#line 231
		type systemd_logind_var_run_t;
#line 231
	
#line 231
		} # end require
#line 231
	
#line 231

#line 231

#line 231
	 	 	
#line 231
##### begin files_search_pids(amazon_ssm_agent_t) depth: 4
#line 231
 	
#line 231
	
#line 231
	
#line 231
		require {
#line 231
			
#line 231
		type var_t, var_run_t;
#line 231
	
#line 231
		} # end require
#line 231
	
#line 231

#line 231

#line 231
	allow amazon_ssm_agent_t var_t:lnk_file { getattr read };
#line 231
	allow amazon_ssm_agent_t var_run_t:lnk_file { getattr read };
#line 231
	
#line 231
	allow amazon_ssm_agent_t var_t:dir { getattr search open };
#line 231
	allow amazon_ssm_agent_t var_run_t:dir { getattr search open };
#line 231

#line 231

#line 231
	 	
#line 231
##### end files_search_pids(amazon_ssm_agent_t) depth: 3
#line 231
 	
#line 231
	
#line 231
	allow amazon_ssm_agent_t systemd_logind_var_run_t:dir { getattr search open };
#line 231
	allow amazon_ssm_agent_t systemd_logind_var_run_t:file { open { getattr read ioctl lock } };
#line 231

#line 231

#line 231
	 	
#line 231
##### end systemd_login_read_pid_files(amazon_ssm_agent_t) depth: 2
#line 231
 	
#line 231
	 	 	
#line 231
##### begin systemd_passwd_agent_exec(amazon_ssm_agent_t) depth: 3
#line 231
 	
#line 231
	
#line 231
	
#line 231
		require {
#line 231
			
#line 231
		type systemd_passwd_agent_t, systemd_passwd_agent_exec_t;
#line 231
	
#line 231
		} # end require
#line 231
	
#line 231

#line 231

#line 231
	allow amazon_ssm_agent_t systemd_passwd_agent_exec_t:file { { getattr open read execute ioctl } ioctl lock execute_no_trans };
#line 231
	 	 	
#line 231
##### begin systemd_manage_passwd_run(amazon_ssm_agent_t) depth: 4
#line 231
 	
#line 231
	
#line 231
	
#line 231
		require {
#line 231
			
#line 231
		type systemd_passwd_agent_t;	
#line 231
		type systemd_passwd_var_run_t;
#line 231
	
#line 231
		} # end require
#line 231
	
#line 231

#line 231

#line 231
	 	 	
#line 231
##### begin init_search_pid_dirs(amazon_ssm_agent_t) depth: 5
#line 231
 	
#line 231
    
#line 231
	
#line 231
		require {
#line 231
			
#line 231
        type init_var_run_t;
#line 231
    
#line 231
		} # end require
#line 231
	
#line 231

#line 231

#line 231
    allow amazon_ssm_agent_t init_var_run_t:dir { getattr search open };
#line 231

#line 231
	 	
#line 231
##### end init_search_pid_dirs(amazon_ssm_agent_t) depth: 4
#line 231
 	
#line 231
	
#line 231
	allow amazon_ssm_agent_t systemd_passwd_var_run_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 231
	allow amazon_ssm_agent_t systemd_passwd_var_run_t:file { create open getattr setattr read write append rename link unlink ioctl lock };
#line 231

#line 231
	
#line 231
	allow amazon_ssm_agent_t systemd_passwd_var_run_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 231
	allow amazon_ssm_agent_t systemd_passwd_var_run_t:sock_file { create open getattr setattr read write rename link unlink ioctl lock append };
#line 231

#line 231
	
#line 231
	allow amazon_ssm_agent_t systemd_passwd_var_run_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 231
	allow amazon_ssm_agent_t systemd_passwd_var_run_t:fifo_file { create open getattr setattr read write append rename link unlink ioctl lock };
#line 231

#line 231

#line 231
	allow systemd_passwd_agent_t amazon_ssm_agent_t:process signull;
#line 231
	allow systemd_passwd_agent_t amazon_ssm_agent_t:unix_dgram_socket sendto;
#line 231

#line 231
	 	
#line 231
##### end systemd_manage_passwd_run(amazon_ssm_agent_t) depth: 3
#line 231
 	
#line 231

#line 231
	 	
#line 231
##### end systemd_passwd_agent_exec(amazon_ssm_agent_t) depth: 2
#line 231
 	
#line 231

#line 231
	dontaudit amazon_ssm_agent_t self:capability net_admin;
#line 231

#line 231
	 	
#line 231
##### end systemd_exec_systemctl(amazon_ssm_agent_t) depth: 1
#line 231
 	
#line 231
	
#line 231
	} # end optional
#line 231

#line 231

#line 231
	 	
#line 231
##### end init_exec(amazon_ssm_agent_t) depth: 0
#line 231
 	

 	 	
#line 233
##### begin rpm_transition_script(amazon_ssm_agent_t,system_r) depth: 1
#line 233
 	
#line 233
	
#line 233
	
#line 233
		require {
#line 233
			
#line 233
		type rpm_script_t;
#line 233
		attribute rpm_transition_domain;
#line 233
		attribute_role rpm_script_roles;
#line 233
	
#line 233
		} # end require
#line 233
	
#line 233

#line 233

#line 233
	typeattribute amazon_ssm_agent_t rpm_transition_domain;
#line 233
	allow amazon_ssm_agent_t rpm_script_t:process transition;
#line 233
	roleattribute system_r rpm_script_roles;
#line 233

#line 233
	allow amazon_ssm_agent_t rpm_script_t:fd use;
#line 233
	allow rpm_script_t amazon_ssm_agent_t:fd use;
#line 233
	allow rpm_script_t amazon_ssm_agent_t:fifo_file { open { getattr read write append ioctl lock } };
#line 233
	allow rpm_script_t amazon_ssm_agent_t:process sigchld;
#line 233

#line 233
	 	
#line 233
##### end rpm_transition_script(amazon_ssm_agent_t,system_r) depth: 0
#line 233
 	

 	 	
#line 235
##### begin selinux_compute_create_context(amazon_ssm_agent_t) depth: 1
#line 235
 	
#line 235
	
#line 235
	
#line 235
		require {
#line 235
			
#line 235
		type security_t;
#line 235
	
#line 235
		} # end require
#line 235
	
#line 235

#line 235

#line 235
	 	 	
#line 235
##### begin dev_getattr_sysfs_fs(amazon_ssm_agent_t) depth: 2
#line 235
 	
#line 235
	
#line 235
	
#line 235
		require {
#line 235
			
#line 235
		type sysfs_t;
#line 235
	
#line 235
		} # end require
#line 235
	
#line 235

#line 235

#line 235
	allow amazon_ssm_agent_t sysfs_t:filesystem getattr;
#line 235

#line 235
	 	
#line 235
##### end dev_getattr_sysfs_fs(amazon_ssm_agent_t) depth: 1
#line 235
 	
#line 235
	 	 	
#line 235
##### begin dev_search_sysfs(amazon_ssm_agent_t) depth: 2
#line 235
 	
#line 235
	
#line 235
	
#line 235
		require {
#line 235
			
#line 235
		type sysfs_t;
#line 235
	
#line 235
		} # end require
#line 235
	
#line 235

#line 235

#line 235
	
#line 235
	allow amazon_ssm_agent_t sysfs_t:dir { getattr search open };
#line 235
	allow amazon_ssm_agent_t sysfs_t:dir { getattr search open };
#line 235

#line 235

#line 235
	 	
#line 235
##### end dev_search_sysfs(amazon_ssm_agent_t) depth: 1
#line 235
 	
#line 235
	allow amazon_ssm_agent_t security_t:lnk_file { getattr read };
#line 235
	allow amazon_ssm_agent_t security_t:dir { getattr search open read lock ioctl };
#line 235
	allow amazon_ssm_agent_t security_t:file { open { getattr read write append ioctl lock } };
#line 235
	allow amazon_ssm_agent_t security_t:security compute_create;
#line 235

#line 235
	 	
#line 235
##### end selinux_compute_create_context(amazon_ssm_agent_t) depth: 0
#line 235
 	

 	 	
#line 237
##### begin selinux_get_enforce_mode(amazon_ssm_agent_t) depth: 1
#line 237
 	
#line 237
	
#line 237
	
#line 237
		require {
#line 237
			
#line 237
		type security_t;
#line 237
	
#line 237
		} # end require
#line 237
	
#line 237

#line 237

#line 237
	 	 	
#line 237
##### begin dev_search_sysfs(amazon_ssm_agent_t) depth: 2
#line 237
 	
#line 237
	
#line 237
	
#line 237
		require {
#line 237
			
#line 237
		type sysfs_t;
#line 237
	
#line 237
		} # end require
#line 237
	
#line 237

#line 237

#line 237
	
#line 237
	allow amazon_ssm_agent_t sysfs_t:dir { getattr search open };
#line 237
	allow amazon_ssm_agent_t sysfs_t:dir { getattr search open };
#line 237

#line 237

#line 237
	 	
#line 237
##### end dev_search_sysfs(amazon_ssm_agent_t) depth: 1
#line 237
 	
#line 237
	 	 	
#line 237
##### begin selinux_get_fs_mount(amazon_ssm_agent_t) depth: 2
#line 237
 	
#line 237
	
#line 237
	
#line 237
		require {
#line 237
			
#line 237
		type security_t;
#line 237
	
#line 237
		} # end require
#line 237
	
#line 237

#line 237

#line 237
	allow amazon_ssm_agent_t security_t:lnk_file { getattr read };
#line 237
	 	 	
#line 237
##### begin dev_getattr_sysfs_fs(amazon_ssm_agent_t) depth: 3
#line 237
 	
#line 237
	
#line 237
	
#line 237
		require {
#line 237
			
#line 237
		type sysfs_t;
#line 237
	
#line 237
		} # end require
#line 237
	
#line 237

#line 237

#line 237
	allow amazon_ssm_agent_t sysfs_t:filesystem getattr;
#line 237

#line 237
	 	
#line 237
##### end dev_getattr_sysfs_fs(amazon_ssm_agent_t) depth: 2
#line 237
 	
#line 237
	 	 	
#line 237
##### begin dev_search_sysfs(amazon_ssm_agent_t) depth: 3
#line 237
 	
#line 237
	
#line 237
	
#line 237
		require {
#line 237
			
#line 237
		type sysfs_t;
#line 237
	
#line 237
		} # end require
#line 237
	
#line 237

#line 237

#line 237
	
#line 237
	allow amazon_ssm_agent_t sysfs_t:dir { getattr search open };
#line 237
	allow amazon_ssm_agent_t sysfs_t:dir { getattr search open };
#line 237

#line 237

#line 237
	 	
#line 237
##### end dev_search_sysfs(amazon_ssm_agent_t) depth: 2
#line 237
 	
#line 237
	# starting in libselinux 2.0.5, init_selinuxmnt() will
#line 237
	# attempt to short circuit by checking if SELINUXMNT
#line 237
	# (/selinux) is already a selinuxfs
#line 237
	allow amazon_ssm_agent_t security_t:filesystem getattr;
#line 237

#line 237
	# read /proc/filesystems to see if selinuxfs is supported
#line 237
	# then read /proc/self/mount to see where selinuxfs is mounted
#line 237
	 	 	
#line 237
##### begin kernel_read_system_state(amazon_ssm_agent_t) depth: 3
#line 237
 	
#line 237
	
#line 237
	
#line 237
		require {
#line 237
			
#line 237
		attribute kernel_system_state_reader;
#line 237
	
#line 237
		} # end require
#line 237
	
#line 237

#line 237

#line 237
	typeattribute amazon_ssm_agent_t kernel_system_state_reader;
#line 237

#line 237
	 	
#line 237
##### end kernel_read_system_state(amazon_ssm_agent_t) depth: 2
#line 237
 	
#line 237

#line 237
	 	
#line 237
##### end selinux_get_fs_mount(amazon_ssm_agent_t) depth: 1
#line 237
 	
#line 237
	allow amazon_ssm_agent_t security_t:dir { getattr search open read lock ioctl };
#line 237
	allow amazon_ssm_agent_t security_t:file { open { getattr read ioctl lock } };
#line 237
	allow amazon_ssm_agent_t security_t:lnk_file { getattr read };
#line 237

#line 237
	 	
#line 237
##### end selinux_get_enforce_mode(amazon_ssm_agent_t) depth: 0
#line 237
 	

 	 	
#line 239
##### begin selinux_set_enforce_mode(amazon_ssm_agent_t) depth: 1
#line 239
 	
#line 239
	
#line 239
	
#line 239
		require {
#line 239
			
#line 239
		type security_t;
#line 239
		attribute can_setenforce;
#line 239
	
#line 239
		} # end require
#line 239
	
#line 239

#line 239

#line 239
	 	 	
#line 239
##### begin dev_search_sysfs(amazon_ssm_agent_t) depth: 2
#line 239
 	
#line 239
	
#line 239
	
#line 239
		require {
#line 239
			
#line 239
		type sysfs_t;
#line 239
	
#line 239
		} # end require
#line 239
	
#line 239

#line 239

#line 239
	
#line 239
	allow amazon_ssm_agent_t sysfs_t:dir { getattr search open };
#line 239
	allow amazon_ssm_agent_t sysfs_t:dir { getattr search open };
#line 239

#line 239

#line 239
	 	
#line 239
##### end dev_search_sysfs(amazon_ssm_agent_t) depth: 1
#line 239
 	
#line 239
	allow amazon_ssm_agent_t security_t:dir { getattr search open read lock ioctl };
#line 239
	allow amazon_ssm_agent_t security_t:file { open { getattr read write append ioctl lock } };
#line 239
	typeattribute amazon_ssm_agent_t can_setenforce;
#line 239

#line 239
	 	
#line 239
##### end selinux_set_enforce_mode(amazon_ssm_agent_t) depth: 0
#line 239
 	

 	 	
#line 241
##### begin seutil_read_file_contexts(amazon_ssm_agent_t) depth: 1
#line 241
 	
#line 241
	
#line 241
	
#line 241
		require {
#line 241
			
#line 241
		type selinux_config_t, default_context_t, file_context_t;
#line 241
	
#line 241
		} # end require
#line 241
	
#line 241

#line 241

#line 241
	 	 	
#line 241
##### begin files_search_etc(amazon_ssm_agent_t) depth: 2
#line 241
 	
#line 241
	
#line 241
	
#line 241
		require {
#line 241
			
#line 241
		type etc_t;
#line 241
	
#line 241
		} # end require
#line 241
	
#line 241

#line 241

#line 241
	allow amazon_ssm_agent_t etc_t:dir { getattr search open };
#line 241

#line 241
	 	
#line 241
##### end files_search_etc(amazon_ssm_agent_t) depth: 1
#line 241
 	
#line 241
	allow amazon_ssm_agent_t { selinux_config_t default_context_t }:dir { getattr search open };
#line 241
	
#line 241
	allow amazon_ssm_agent_t file_context_t:dir { getattr search open };
#line 241
	allow amazon_ssm_agent_t file_context_t:dir { getattr search open read lock ioctl };
#line 241

#line 241
	
#line 241
	allow amazon_ssm_agent_t file_context_t:dir { getattr search open };
#line 241
	allow amazon_ssm_agent_t file_context_t:file { open { getattr read ioctl lock } };
#line 241

#line 241
	
#line 241
	allow amazon_ssm_agent_t file_context_t:dir { getattr search open };
#line 241
	allow amazon_ssm_agent_t file_context_t:lnk_file { getattr read };
#line 241

#line 241

#line 241
	 	
#line 241
##### end seutil_read_file_contexts(amazon_ssm_agent_t) depth: 0
#line 241
 	

 	 	
#line 243
##### begin seutil_read_module_store(amazon_ssm_agent_t) depth: 1
#line 243
 	
#line 243
	
#line 243
	
#line 243
		require {
#line 243
			
#line 243
		type selinux_config_t, semanage_store_t;
#line 243
	
#line 243
		} # end require
#line 243
	
#line 243

#line 243

#line 243
	 	 	
#line 243
##### begin files_search_etc(amazon_ssm_agent_t) depth: 2
#line 243
 	
#line 243
	
#line 243
	
#line 243
		require {
#line 243
			
#line 243
		type etc_t;
#line 243
	
#line 243
		} # end require
#line 243
	
#line 243

#line 243

#line 243
	allow amazon_ssm_agent_t etc_t:dir { getattr search open };
#line 243

#line 243
	 	
#line 243
##### end files_search_etc(amazon_ssm_agent_t) depth: 1
#line 243
 	
#line 243
	
#line 243
	allow amazon_ssm_agent_t selinux_config_t:dir { getattr search open };
#line 243
	allow amazon_ssm_agent_t semanage_store_t:dir { getattr search open read lock ioctl };
#line 243

#line 243
	
#line 243
	allow amazon_ssm_agent_t semanage_store_t:dir { getattr search open };
#line 243
	allow amazon_ssm_agent_t semanage_store_t:file { open { getattr read ioctl lock } };
#line 243

#line 243
	
#line 243
	allow amazon_ssm_agent_t semanage_store_t:dir { getattr search open };
#line 243
	allow amazon_ssm_agent_t semanage_store_t:lnk_file { getattr read };
#line 243

#line 243

#line 243
	 	
#line 243
##### end seutil_read_module_store(amazon_ssm_agent_t) depth: 0
#line 243
 	

 	 	
#line 245
##### begin seutil_search_default_contexts(amazon_ssm_agent_t) depth: 1
#line 245
 	
#line 245
	
#line 245
	
#line 245
		require {
#line 245
			
#line 245
		type selinux_config_t, default_context_t;
#line 245
	
#line 245
		} # end require
#line 245
	
#line 245

#line 245

#line 245
	 	 	
#line 245
##### begin files_search_etc(amazon_ssm_agent_t) depth: 2
#line 245
 	
#line 245
	
#line 245
	
#line 245
		require {
#line 245
			
#line 245
		type etc_t;
#line 245
	
#line 245
		} # end require
#line 245
	
#line 245

#line 245

#line 245
	allow amazon_ssm_agent_t etc_t:dir { getattr search open };
#line 245

#line 245
	 	
#line 245
##### end files_search_etc(amazon_ssm_agent_t) depth: 1
#line 245
 	
#line 245
	
#line 245
	allow amazon_ssm_agent_t selinux_config_t:dir { getattr search open };
#line 245
	allow amazon_ssm_agent_t default_context_t:dir { getattr search open };
#line 245

#line 245

#line 245
	 	
#line 245
##### end seutil_search_default_contexts(amazon_ssm_agent_t) depth: 0
#line 245
 	

 	 	
#line 247
##### begin systemd_write_inhibit_pipes(amazon_ssm_agent_t) depth: 1
#line 247
 	
#line 247
	
#line 247
	
#line 247
		require {
#line 247
			
#line 247
		type systemd_logind_inhibit_var_run_t;
#line 247
	
#line 247
		} # end require
#line 247
	
#line 247

#line 247

#line 247
	allow amazon_ssm_agent_t systemd_logind_inhibit_var_run_t:fifo_file write;
#line 247

#line 247
	 	
#line 247
##### end systemd_write_inhibit_pipes(amazon_ssm_agent_t) depth: 0
#line 247
 	

 	 	
#line 249
##### begin init_write_utmp(amazon_ssm_agent_t) depth: 1
#line 249
 	
#line 249
	
#line 249
	
#line 249
		require {
#line 249
			
#line 249
		type initrc_var_run_t;
#line 249
	
#line 249
		} # end require
#line 249
	
#line 249

#line 249

#line 249
	 	 	
#line 249
##### begin files_list_pids(amazon_ssm_agent_t) depth: 2
#line 249
 	
#line 249
	
#line 249
	
#line 249
		require {
#line 249
			
#line 249
		type var_t, var_run_t;
#line 249
	
#line 249
		} # end require
#line 249
	
#line 249

#line 249

#line 249
	 	 	
#line 249
##### begin files_search_pids(amazon_ssm_agent_t) depth: 3
#line 249
 	
#line 249
	
#line 249
	
#line 249
		require {
#line 249
			
#line 249
		type var_t, var_run_t;
#line 249
	
#line 249
		} # end require
#line 249
	
#line 249

#line 249

#line 249
	allow amazon_ssm_agent_t var_t:lnk_file { getattr read };
#line 249
	allow amazon_ssm_agent_t var_run_t:lnk_file { getattr read };
#line 249
	
#line 249
	allow amazon_ssm_agent_t var_t:dir { getattr search open };
#line 249
	allow amazon_ssm_agent_t var_run_t:dir { getattr search open };
#line 249

#line 249

#line 249
	 	
#line 249
##### end files_search_pids(amazon_ssm_agent_t) depth: 2
#line 249
 	
#line 249
	
#line 249
	allow amazon_ssm_agent_t var_t:dir { getattr search open };
#line 249
	allow amazon_ssm_agent_t var_run_t:dir { getattr search open read lock ioctl };
#line 249

#line 249

#line 249
	 	
#line 249
##### end files_list_pids(amazon_ssm_agent_t) depth: 1
#line 249
 	
#line 249
	allow amazon_ssm_agent_t initrc_var_run_t:file { getattr open write };
#line 249

#line 249
	 	
#line 249
##### end init_write_utmp(amazon_ssm_agent_t) depth: 0
#line 249
 	

 	 	
#line 251
##### begin files_delete_root_dir_entry(amazon_ssm_agent_t) depth: 1
#line 251
 	
#line 251
	
#line 251
	
#line 251
		require {
#line 251
			
#line 251
		type root_t;
#line 251
	
#line 251
		} # end require
#line 251
	
#line 251

#line 251

#line 251
	allow amazon_ssm_agent_t root_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 251

#line 251
	 	
#line 251
##### end files_delete_root_dir_entry(amazon_ssm_agent_t) depth: 0
#line 251
 	

 	 	
#line 253
##### begin files_manage_root_files(amazon_ssm_agent_t) depth: 1
#line 253
 	
#line 253
	
#line 253
	
#line 253
		require {
#line 253
			
#line 253
		type root_t;
#line 253
	
#line 253
		} # end require
#line 253
	
#line 253

#line 253

#line 253
	
#line 253
	allow amazon_ssm_agent_t root_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 253
	allow amazon_ssm_agent_t root_t:file { create open getattr setattr read write append rename link unlink ioctl lock };
#line 253

#line 253

#line 253
	 	
#line 253
##### end files_manage_root_files(amazon_ssm_agent_t) depth: 0
#line 253
 	

 	 	
#line 255
##### begin kernel_request_load_module(amazon_ssm_agent_t) depth: 1
#line 255
 	
#line 255
	
#line 255
	
#line 255
		require {
#line 255
			
#line 255
		type kernel_t;
#line 255
	
#line 255
		} # end require
#line 255
	
#line 255

#line 255

#line 255
	allow amazon_ssm_agent_t kernel_t:system module_request;
#line 255

#line 255
	 	
#line 255
##### end kernel_request_load_module(amazon_ssm_agent_t) depth: 0
#line 255
 	

 	 	
#line 257
##### begin selinux_compute_access_vector(amazon_ssm_agent_t) depth: 1
#line 257
 	
#line 257
	
#line 257
	
#line 257
		require {
#line 257
			
#line 257
		type security_t;
#line 257
	
#line 257
		} # end require
#line 257
	
#line 257

#line 257

#line 257
	 	 	
#line 257
##### begin dev_getattr_sysfs_fs(amazon_ssm_agent_t) depth: 2
#line 257
 	
#line 257
	
#line 257
	
#line 257
		require {
#line 257
			
#line 257
		type sysfs_t;
#line 257
	
#line 257
		} # end require
#line 257
	
#line 257

#line 257

#line 257
	allow amazon_ssm_agent_t sysfs_t:filesystem getattr;
#line 257

#line 257
	 	
#line 257
##### end dev_getattr_sysfs_fs(amazon_ssm_agent_t) depth: 1
#line 257
 	
#line 257
	 	 	
#line 257
##### begin dev_search_sysfs(amazon_ssm_agent_t) depth: 2
#line 257
 	
#line 257
	
#line 257
	
#line 257
		require {
#line 257
			
#line 257
		type sysfs_t;
#line 257
	
#line 257
		} # end require
#line 257
	
#line 257

#line 257

#line 257
	
#line 257
	allow amazon_ssm_agent_t sysfs_t:dir { getattr search open };
#line 257
	allow amazon_ssm_agent_t sysfs_t:dir { getattr search open };
#line 257

#line 257

#line 257
	 	
#line 257
##### end dev_search_sysfs(amazon_ssm_agent_t) depth: 1
#line 257
 	
#line 257
	allow amazon_ssm_agent_t security_t:lnk_file { getattr read };
#line 257
	allow amazon_ssm_agent_t security_t:dir { getattr search open read lock ioctl };
#line 257
	allow amazon_ssm_agent_t security_t:file { open { getattr read write append ioctl lock } };
#line 257
	allow amazon_ssm_agent_t security_t:security compute_av;
#line 257

#line 257
	 	
#line 257
##### end selinux_compute_access_vector(amazon_ssm_agent_t) depth: 0
#line 257
 	

 	 	
#line 259
##### begin su_exec(amazon_ssm_agent_t) depth: 1
#line 259
 	
#line 259
	
#line 259
	
#line 259
		require {
#line 259
			
#line 259
		type su_exec_t;
#line 259
	
#line 259
		} # end require
#line 259
	
#line 259

#line 259

#line 259
	 	 	
#line 259
##### begin corecmd_search_bin(amazon_ssm_agent_t) depth: 2
#line 259
 	
#line 259
	
#line 259
	
#line 259
		require {
#line 259
			
#line 259
		type bin_t;
#line 259
	
#line 259
		} # end require
#line 259
	
#line 259

#line 259

#line 259
	 	 	
#line 259
##### begin corecmd_read_bin_symlinks(amazon_ssm_agent_t) depth: 3
#line 259
 	
#line 259
	
#line 259
	
#line 259
		require {
#line 259
			
#line 259
		type bin_t;
#line 259
	
#line 259
		} # end require
#line 259
	
#line 259

#line 259

#line 259
	
#line 259
	allow amazon_ssm_agent_t bin_t:dir { getattr search open };
#line 259
	allow amazon_ssm_agent_t bin_t:lnk_file { getattr read };
#line 259

#line 259

#line 259
	 	
#line 259
##### end corecmd_read_bin_symlinks(amazon_ssm_agent_t) depth: 2
#line 259
 	
#line 259
	
#line 259
	allow amazon_ssm_agent_t bin_t:dir { getattr search open };
#line 259
	allow amazon_ssm_agent_t bin_t:dir { getattr search open };
#line 259

#line 259

#line 259
	 	
#line 259
##### end corecmd_search_bin(amazon_ssm_agent_t) depth: 1
#line 259
 	
#line 259
	allow amazon_ssm_agent_t su_exec_t:file { { getattr open read execute ioctl } ioctl lock execute_no_trans };
#line 259

#line 259
	 	
#line 259
##### end su_exec(amazon_ssm_agent_t) depth: 0
#line 259
 	

 	 	
#line 261
##### begin init_telinit(amazon_ssm_agent_t) depth: 1
#line 261
 	
#line 261
	
#line 261
	
#line 261
		require {
#line 261
			
#line 261
		type initctl_t;
#line 261
		type init_t;
#line 261
	
#line 261
		} # end require
#line 261
	
#line 261

#line 261

#line 261
	 	 	
#line 261
##### begin corecmd_exec_bin(amazon_ssm_agent_t) depth: 2
#line 261
 	
#line 261
	
#line 261
	
#line 261
		require {
#line 261
			
#line 261
		type bin_t;
#line 261
	
#line 261
		} # end require
#line 261
	
#line 261

#line 261

#line 261
	
#line 261
	allow amazon_ssm_agent_t bin_t:dir { getattr search open };
#line 261
	allow amazon_ssm_agent_t bin_t:lnk_file { getattr read };
#line 261

#line 261
	
#line 261
	allow amazon_ssm_agent_t bin_t:dir { getattr search open };
#line 261
	allow amazon_ssm_agent_t bin_t:dir { getattr search open read lock ioctl };
#line 261

#line 261
	allow amazon_ssm_agent_t bin_t:file { { getattr open read execute ioctl } ioctl lock execute_no_trans };
#line 261

#line 261
	
#line 261
		 	 	
#line 261
##### begin files_exec_all_base_ro_files(amazon_ssm_agent_t) depth: 3
#line 261
 	
#line 261
	
#line 261
	
#line 261
		require {
#line 261
			
#line 261
		attribute base_ro_file_type;
#line 261
	
#line 261
		} # end require
#line 261
	
#line 261

#line 261

#line 261
	allow amazon_ssm_agent_t base_ro_file_type:file { { getattr open read execute ioctl } ioctl lock execute_no_trans };
#line 261

#line 261
	 	
#line 261
##### end files_exec_all_base_ro_files(amazon_ssm_agent_t) depth: 2
#line 261
 	
#line 261
	
#line 261

#line 261
	 	
#line 261
##### end corecmd_exec_bin(amazon_ssm_agent_t) depth: 1
#line 261
 	
#line 261

#line 261
	 	 	
#line 261
##### begin dev_list_all_dev_nodes(amazon_ssm_agent_t) depth: 2
#line 261
 	
#line 261
	
#line 261
	
#line 261
		require {
#line 261
			
#line 261
		type device_t;
#line 261
	
#line 261
		} # end require
#line 261
	
#line 261

#line 261

#line 261
	
#line 261
	allow amazon_ssm_agent_t device_t:dir { getattr search open };
#line 261
	allow amazon_ssm_agent_t device_t:dir { getattr search open read lock ioctl };
#line 261

#line 261
	
#line 261
	allow amazon_ssm_agent_t device_t:dir { getattr search open };
#line 261
	allow amazon_ssm_agent_t device_t:lnk_file { getattr read };
#line 261

#line 261

#line 261
	 	
#line 261
##### end dev_list_all_dev_nodes(amazon_ssm_agent_t) depth: 1
#line 261
 	
#line 261
	allow amazon_ssm_agent_t initctl_t:fifo_file { open { getattr read write append ioctl lock } };
#line 261

#line 261
	 	 	
#line 261
##### begin init_exec(amazon_ssm_agent_t) depth: 2
#line 261
 	
#line 261
	
#line 261
	
#line 261
		require {
#line 261
			
#line 261
		type init_exec_t;
#line 261
	
#line 261
		} # end require
#line 261
	
#line 261

#line 261

#line 261
	 	 	
#line 261
##### begin corecmd_search_bin(amazon_ssm_agent_t) depth: 3
#line 261
 	
#line 261
	
#line 261
	
#line 261
		require {
#line 261
			
#line 261
		type bin_t;
#line 261
	
#line 261
		} # end require
#line 261
	
#line 261

#line 261

#line 261
	 	 	
#line 261
##### begin corecmd_read_bin_symlinks(amazon_ssm_agent_t) depth: 4
#line 261
 	
#line 261
	
#line 261
	
#line 261
		require {
#line 261
			
#line 261
		type bin_t;
#line 261
	
#line 261
		} # end require
#line 261
	
#line 261

#line 261

#line 261
	
#line 261
	allow amazon_ssm_agent_t bin_t:dir { getattr search open };
#line 261
	allow amazon_ssm_agent_t bin_t:lnk_file { getattr read };
#line 261

#line 261

#line 261
	 	
#line 261
##### end corecmd_read_bin_symlinks(amazon_ssm_agent_t) depth: 3
#line 261
 	
#line 261
	
#line 261
	allow amazon_ssm_agent_t bin_t:dir { getattr search open };
#line 261
	allow amazon_ssm_agent_t bin_t:dir { getattr search open };
#line 261

#line 261

#line 261
	 	
#line 261
##### end corecmd_search_bin(amazon_ssm_agent_t) depth: 2
#line 261
 	
#line 261
	allow amazon_ssm_agent_t init_exec_t:file { { getattr open read execute ioctl } ioctl lock execute_no_trans };
#line 261

#line 261
	
#line 261
	optional {
#line 261
		
#line 261
		 	 	
#line 261
##### begin systemd_exec_systemctl(amazon_ssm_agent_t) depth: 3
#line 261
 	
#line 261
        
#line 261
	
#line 261
		require {
#line 261
			
#line 261
                type systemd_systemctl_exec_t;
#line 261
        
#line 261
		} # end require
#line 261
	
#line 261

#line 261

#line 261
	 	 	
#line 261
##### begin corecmd_search_bin(amazon_ssm_agent_t) depth: 4
#line 261
 	
#line 261
	
#line 261
	
#line 261
		require {
#line 261
			
#line 261
		type bin_t;
#line 261
	
#line 261
		} # end require
#line 261
	
#line 261

#line 261

#line 261
	 	 	
#line 261
##### begin corecmd_read_bin_symlinks(amazon_ssm_agent_t) depth: 5
#line 261
 	
#line 261
	
#line 261
	
#line 261
		require {
#line 261
			
#line 261
		type bin_t;
#line 261
	
#line 261
		} # end require
#line 261
	
#line 261

#line 261

#line 261
	
#line 261
	allow amazon_ssm_agent_t bin_t:dir { getattr search open };
#line 261
	allow amazon_ssm_agent_t bin_t:lnk_file { getattr read };
#line 261

#line 261

#line 261
	 	
#line 261
##### end corecmd_read_bin_symlinks(amazon_ssm_agent_t) depth: 4
#line 261
 	
#line 261
	
#line 261
	allow amazon_ssm_agent_t bin_t:dir { getattr search open };
#line 261
	allow amazon_ssm_agent_t bin_t:dir { getattr search open };
#line 261

#line 261

#line 261
	 	
#line 261
##### end corecmd_search_bin(amazon_ssm_agent_t) depth: 3
#line 261
 	
#line 261
	allow amazon_ssm_agent_t systemd_systemctl_exec_t:file { { getattr open read execute ioctl } ioctl lock execute_no_trans };
#line 261

#line 261
	 	 	
#line 261
##### begin fs_list_cgroup_dirs(amazon_ssm_agent_t) depth: 4
#line 261
 	
#line 261
	
#line 261
	
#line 261
		require {
#line 261
			
#line 261
		type cgroup_t;
#line 261
	
#line 261
		} # end require
#line 261
	
#line 261

#line 261

#line 261
	
#line 261
	allow amazon_ssm_agent_t cgroup_t:dir { getattr search open };
#line 261
	allow amazon_ssm_agent_t cgroup_t:dir { getattr search open read lock ioctl };
#line 261

#line 261
	 	 	
#line 261
##### begin fs_search_tmpfs(amazon_ssm_agent_t) depth: 5
#line 261
 	
#line 261
	
#line 261
	
#line 261
		require {
#line 261
			
#line 261
		type tmpfs_t;
#line 261
	
#line 261
		} # end require
#line 261
	
#line 261

#line 261

#line 261
	allow amazon_ssm_agent_t tmpfs_t:dir { getattr search open };
#line 261

#line 261
	 	
#line 261
##### end fs_search_tmpfs(amazon_ssm_agent_t) depth: 4
#line 261
 	
#line 261
	 	 	
#line 261
##### begin dev_search_sysfs(amazon_ssm_agent_t) depth: 5
#line 261
 	
#line 261
	
#line 261
	
#line 261
		require {
#line 261
			
#line 261
		type sysfs_t;
#line 261
	
#line 261
		} # end require
#line 261
	
#line 261

#line 261

#line 261
	
#line 261
	allow amazon_ssm_agent_t sysfs_t:dir { getattr search open };
#line 261
	allow amazon_ssm_agent_t sysfs_t:dir { getattr search open };
#line 261

#line 261

#line 261
	 	
#line 261
##### end dev_search_sysfs(amazon_ssm_agent_t) depth: 4
#line 261
 	
#line 261

#line 261
	 	
#line 261
##### end fs_list_cgroup_dirs(amazon_ssm_agent_t) depth: 3
#line 261
 	
#line 261
	 	 	
#line 261
##### begin fs_read_cgroup_files(amazon_ssm_agent_t) depth: 4
#line 261
 	
#line 261
	
#line 261
	
#line 261
		require {
#line 261
			
#line 261
		type cgroup_t;
#line 261

#line 261
	
#line 261
		} # end require
#line 261
	
#line 261

#line 261

#line 261
	
#line 261
	allow amazon_ssm_agent_t cgroup_t:dir { getattr search open };
#line 261
	allow amazon_ssm_agent_t cgroup_t:file { open { getattr read ioctl lock } };
#line 261

#line 261
	
#line 261
	allow amazon_ssm_agent_t cgroup_t:dir { getattr search open };
#line 261
	allow amazon_ssm_agent_t cgroup_t:lnk_file { getattr read };
#line 261

#line 261
	 	 	
#line 261
##### begin fs_search_tmpfs(amazon_ssm_agent_t) depth: 5
#line 261
 	
#line 261
	
#line 261
	
#line 261
		require {
#line 261
			
#line 261
		type tmpfs_t;
#line 261
	
#line 261
		} # end require
#line 261
	
#line 261

#line 261

#line 261
	allow amazon_ssm_agent_t tmpfs_t:dir { getattr search open };
#line 261

#line 261
	 	
#line 261
##### end fs_search_tmpfs(amazon_ssm_agent_t) depth: 4
#line 261
 	
#line 261
	 	 	
#line 261
##### begin dev_search_sysfs(amazon_ssm_agent_t) depth: 5
#line 261
 	
#line 261
	
#line 261
	
#line 261
		require {
#line 261
			
#line 261
		type sysfs_t;
#line 261
	
#line 261
		} # end require
#line 261
	
#line 261

#line 261

#line 261
	
#line 261
	allow amazon_ssm_agent_t sysfs_t:dir { getattr search open };
#line 261
	allow amazon_ssm_agent_t sysfs_t:dir { getattr search open };
#line 261

#line 261

#line 261
	 	
#line 261
##### end dev_search_sysfs(amazon_ssm_agent_t) depth: 4
#line 261
 	
#line 261

#line 261
	 	
#line 261
##### end fs_read_cgroup_files(amazon_ssm_agent_t) depth: 3
#line 261
 	
#line 261
	 	 	
#line 261
##### begin systemd_list_unit_dirs(amazon_ssm_agent_t) depth: 4
#line 261
 	
#line 261
        
#line 261
	
#line 261
		require {
#line 261
			
#line 261
                attribute systemd_unit_file_type;
#line 261
        
#line 261
		} # end require
#line 261
	
#line 261

#line 261
	
#line 261
	 	 	
#line 261
##### begin files_search_var_lib(amazon_ssm_agent_t) depth: 5
#line 261
 	
#line 261
	
#line 261
	
#line 261
		require {
#line 261
			
#line 261
		type var_t, var_lib_t;
#line 261
	
#line 261
		} # end require
#line 261
	
#line 261

#line 261

#line 261
	
#line 261
	allow amazon_ssm_agent_t var_t:dir { getattr search open };
#line 261
	allow amazon_ssm_agent_t var_lib_t:dir { getattr search open };
#line 261

#line 261

#line 261
	 	
#line 261
##### end files_search_var_lib(amazon_ssm_agent_t) depth: 4
#line 261
 	
#line 261
	allow amazon_ssm_agent_t systemd_unit_file_type:dir { getattr search open read lock ioctl };
#line 261

#line 261
	 	
#line 261
##### end systemd_list_unit_dirs(amazon_ssm_agent_t) depth: 3
#line 261
 	
#line 261
	 	 	
#line 261
##### begin init_list_pid_dirs(amazon_ssm_agent_t) depth: 4
#line 261
 	
#line 261
    
#line 261
	
#line 261
		require {
#line 261
			
#line 261
        type init_var_run_t;
#line 261
    
#line 261
		} # end require
#line 261
	
#line 261

#line 261

#line 261
    allow amazon_ssm_agent_t init_var_run_t:dir { getattr search open read lock ioctl };
#line 261

#line 261
	 	
#line 261
##### end init_list_pid_dirs(amazon_ssm_agent_t) depth: 3
#line 261
 	
#line 261
	 	 	
#line 261
##### begin init_read_state(amazon_ssm_agent_t) depth: 4
#line 261
 	
#line 261
	
#line 261
	
#line 261
		require {
#line 261
			
#line 261
		type init_t;
#line 261
	
#line 261
		} # end require
#line 261
	
#line 261

#line 261

#line 261
	allow amazon_ssm_agent_t init_t:dir { getattr search open };
#line 261
	allow amazon_ssm_agent_t init_t:file { open { getattr read ioctl lock } };
#line 261
	allow amazon_ssm_agent_t init_t:lnk_file { getattr read };
#line 261

#line 261
	 	
#line 261
##### end init_read_state(amazon_ssm_agent_t) depth: 3
#line 261
 	
#line 261
	 	 	
#line 261
##### begin init_stream_send(amazon_ssm_agent_t) depth: 4
#line 261
 	
#line 261
	
#line 261
	
#line 261
		require {
#line 261
			
#line 261
		type init_t;
#line 261
	
#line 261
		} # end require
#line 261
	
#line 261

#line 261

#line 261
	allow amazon_ssm_agent_t init_t:unix_stream_socket sendto;
#line 261

#line 261
	 	
#line 261
##### end init_stream_send(amazon_ssm_agent_t) depth: 3
#line 261
 	
#line 261
	 	 	
#line 261
##### begin init_stream_connect(amazon_ssm_agent_t) depth: 4
#line 261
 	
#line 261
	
#line 261
	
#line 261
		require {
#line 261
			
#line 261
		type init_t, init_var_run_t;
#line 261
	
#line 261
		} # end require
#line 261
	
#line 261

#line 261

#line 261
	 	 	
#line 261
##### begin files_search_pids(amazon_ssm_agent_t) depth: 5
#line 261
 	
#line 261
	
#line 261
	
#line 261
		require {
#line 261
			
#line 261
		type var_t, var_run_t;
#line 261
	
#line 261
		} # end require
#line 261
	
#line 261

#line 261

#line 261
	allow amazon_ssm_agent_t var_t:lnk_file { getattr read };
#line 261
	allow amazon_ssm_agent_t var_run_t:lnk_file { getattr read };
#line 261
	
#line 261
	allow amazon_ssm_agent_t var_t:dir { getattr search open };
#line 261
	allow amazon_ssm_agent_t var_run_t:dir { getattr search open };
#line 261

#line 261

#line 261
	 	
#line 261
##### end files_search_pids(amazon_ssm_agent_t) depth: 4
#line 261
 	
#line 261
	
#line 261
	allow amazon_ssm_agent_t init_var_run_t:dir { getattr search open };
#line 261
	allow amazon_ssm_agent_t init_var_run_t:sock_file { getattr write open append };
#line 261
	allow amazon_ssm_agent_t init_t:unix_stream_socket connectto;
#line 261
    
#line 261
	allow amazon_ssm_agent_t init_t:unix_stream_socket getattr;
#line 261

#line 261
	 	
#line 261
##### end init_stream_connect(amazon_ssm_agent_t) depth: 3
#line 261
 	
#line 261

#line 261
	 	 	
#line 261
##### begin systemd_login_list_pid_dirs(amazon_ssm_agent_t) depth: 4
#line 261
 	
#line 261
	
#line 261
	
#line 261
		require {
#line 261
			
#line 261
		type systemd_logind_var_run_t;
#line 261
	
#line 261
		} # end require
#line 261
	
#line 261

#line 261

#line 261
	 	 	
#line 261
##### begin files_search_pids(amazon_ssm_agent_t) depth: 5
#line 261
 	
#line 261
	
#line 261
	
#line 261
		require {
#line 261
			
#line 261
		type var_t, var_run_t;
#line 261
	
#line 261
		} # end require
#line 261
	
#line 261

#line 261

#line 261
	allow amazon_ssm_agent_t var_t:lnk_file { getattr read };
#line 261
	allow amazon_ssm_agent_t var_run_t:lnk_file { getattr read };
#line 261
	
#line 261
	allow amazon_ssm_agent_t var_t:dir { getattr search open };
#line 261
	allow amazon_ssm_agent_t var_run_t:dir { getattr search open };
#line 261

#line 261

#line 261
	 	
#line 261
##### end files_search_pids(amazon_ssm_agent_t) depth: 4
#line 261
 	
#line 261
	
#line 261
	allow amazon_ssm_agent_t systemd_logind_var_run_t:dir { getattr search open };
#line 261
	allow amazon_ssm_agent_t systemd_logind_var_run_t:dir { getattr search open read lock ioctl };
#line 261

#line 261

#line 261
	 	
#line 261
##### end systemd_login_list_pid_dirs(amazon_ssm_agent_t) depth: 3
#line 261
 	
#line 261
	 	 	
#line 261
##### begin systemd_login_read_pid_files(amazon_ssm_agent_t) depth: 4
#line 261
 	
#line 261
	
#line 261
	
#line 261
		require {
#line 261
			
#line 261
		type systemd_logind_var_run_t;
#line 261
	
#line 261
		} # end require
#line 261
	
#line 261

#line 261

#line 261
	 	 	
#line 261
##### begin files_search_pids(amazon_ssm_agent_t) depth: 5
#line 261
 	
#line 261
	
#line 261
	
#line 261
		require {
#line 261
			
#line 261
		type var_t, var_run_t;
#line 261
	
#line 261
		} # end require
#line 261
	
#line 261

#line 261

#line 261
	allow amazon_ssm_agent_t var_t:lnk_file { getattr read };
#line 261
	allow amazon_ssm_agent_t var_run_t:lnk_file { getattr read };
#line 261
	
#line 261
	allow amazon_ssm_agent_t var_t:dir { getattr search open };
#line 261
	allow amazon_ssm_agent_t var_run_t:dir { getattr search open };
#line 261

#line 261

#line 261
	 	
#line 261
##### end files_search_pids(amazon_ssm_agent_t) depth: 4
#line 261
 	
#line 261
	
#line 261
	allow amazon_ssm_agent_t systemd_logind_var_run_t:dir { getattr search open };
#line 261
	allow amazon_ssm_agent_t systemd_logind_var_run_t:file { open { getattr read ioctl lock } };
#line 261

#line 261

#line 261
	 	
#line 261
##### end systemd_login_read_pid_files(amazon_ssm_agent_t) depth: 3
#line 261
 	
#line 261
	 	 	
#line 261
##### begin systemd_passwd_agent_exec(amazon_ssm_agent_t) depth: 4
#line 261
 	
#line 261
	
#line 261
	
#line 261
		require {
#line 261
			
#line 261
		type systemd_passwd_agent_t, systemd_passwd_agent_exec_t;
#line 261
	
#line 261
		} # end require
#line 261
	
#line 261

#line 261

#line 261
	allow amazon_ssm_agent_t systemd_passwd_agent_exec_t:file { { getattr open read execute ioctl } ioctl lock execute_no_trans };
#line 261
	 	 	
#line 261
##### begin systemd_manage_passwd_run(amazon_ssm_agent_t) depth: 5
#line 261
 	
#line 261
	
#line 261
	
#line 261
		require {
#line 261
			
#line 261
		type systemd_passwd_agent_t;	
#line 261
		type systemd_passwd_var_run_t;
#line 261
	
#line 261
		} # end require
#line 261
	
#line 261

#line 261

#line 261
	 	 	
#line 261
##### begin init_search_pid_dirs(amazon_ssm_agent_t) depth: 6
#line 261
 	
#line 261
    
#line 261
	
#line 261
		require {
#line 261
			
#line 261
        type init_var_run_t;
#line 261
    
#line 261
		} # end require
#line 261
	
#line 261

#line 261

#line 261
    allow amazon_ssm_agent_t init_var_run_t:dir { getattr search open };
#line 261

#line 261
	 	
#line 261
##### end init_search_pid_dirs(amazon_ssm_agent_t) depth: 5
#line 261
 	
#line 261
	
#line 261
	allow amazon_ssm_agent_t systemd_passwd_var_run_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 261
	allow amazon_ssm_agent_t systemd_passwd_var_run_t:file { create open getattr setattr read write append rename link unlink ioctl lock };
#line 261

#line 261
	
#line 261
	allow amazon_ssm_agent_t systemd_passwd_var_run_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 261
	allow amazon_ssm_agent_t systemd_passwd_var_run_t:sock_file { create open getattr setattr read write rename link unlink ioctl lock append };
#line 261

#line 261
	
#line 261
	allow amazon_ssm_agent_t systemd_passwd_var_run_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 261
	allow amazon_ssm_agent_t systemd_passwd_var_run_t:fifo_file { create open getattr setattr read write append rename link unlink ioctl lock };
#line 261

#line 261

#line 261
	allow systemd_passwd_agent_t amazon_ssm_agent_t:process signull;
#line 261
	allow systemd_passwd_agent_t amazon_ssm_agent_t:unix_dgram_socket sendto;
#line 261

#line 261
	 	
#line 261
##### end systemd_manage_passwd_run(amazon_ssm_agent_t) depth: 4
#line 261
 	
#line 261

#line 261
	 	
#line 261
##### end systemd_passwd_agent_exec(amazon_ssm_agent_t) depth: 3
#line 261
 	
#line 261

#line 261
	dontaudit amazon_ssm_agent_t self:capability net_admin;
#line 261

#line 261
	 	
#line 261
##### end systemd_exec_systemctl(amazon_ssm_agent_t) depth: 2
#line 261
 	
#line 261
	
#line 261
	} # end optional
#line 261

#line 261

#line 261
	 	
#line 261
##### end init_exec(amazon_ssm_agent_t) depth: 1
#line 261
 	
#line 261

#line 261
	
#line 261
	allow amazon_ssm_agent_t init_t:dir { getattr search open read lock ioctl };
#line 261
	allow amazon_ssm_agent_t init_t:file { open { getattr read ioctl lock } };
#line 261
	allow amazon_ssm_agent_t init_t:lnk_file { getattr read };
#line 261
	allow amazon_ssm_agent_t init_t:process getattr;
#line 261

#line 261
	allow amazon_ssm_agent_t init_t:process signal;
#line 261
	dontaudit amazon_ssm_agent_t self:capability net_admin;
#line 261
	# upstart uses a datagram socket instead of initctl pipe
#line 261
	allow amazon_ssm_agent_t self:unix_dgram_socket { create { ioctl read getattr lock write setattr append bind connect getopt setopt shutdown } };
#line 261
	allow amazon_ssm_agent_t init_t:unix_dgram_socket sendto;
#line 261
	#576913
#line 261
	allow amazon_ssm_agent_t init_t:unix_stream_socket connectto;
#line 261

#line 261
	 	
#line 261
##### end init_telinit(amazon_ssm_agent_t) depth: 0
#line 261
 	

 	 	
#line 263
##### begin ssh_read_user_home_files(amazon_ssm_agent_t) depth: 1
#line 263
 	
#line 263
	
#line 263
	
#line 263
		require {
#line 263
			
#line 263
		type ssh_home_t;
#line 263
	
#line 263
		} # end require
#line 263
	
#line 263

#line 263

#line 263
	allow amazon_ssm_agent_t ssh_home_t:dir { getattr search open read lock ioctl };
#line 263
	
#line 263
	allow amazon_ssm_agent_t ssh_home_t:dir { getattr search open };
#line 263
	allow amazon_ssm_agent_t ssh_home_t:file { open { getattr read ioctl lock } };
#line 263

#line 263
	
#line 263
	allow amazon_ssm_agent_t ssh_home_t:dir { getattr search open };
#line 263
	allow amazon_ssm_agent_t ssh_home_t:lnk_file { getattr read };
#line 263

#line 263
	 	 	
#line 263
##### begin userdom_search_user_home_dirs(amazon_ssm_agent_t) depth: 2
#line 263
 	
#line 263
	
#line 263
	
#line 263
		require {
#line 263
			
#line 263
		type user_home_dir_t;
#line 263
	
#line 263
		} # end require
#line 263
	
#line 263

#line 263

#line 263
	allow amazon_ssm_agent_t user_home_dir_t:dir { getattr search open };
#line 263
	allow amazon_ssm_agent_t user_home_dir_t:lnk_file { getattr read };
#line 263
	 	 	
#line 263
##### begin files_search_home(amazon_ssm_agent_t) depth: 3
#line 263
 	
#line 263
	
#line 263
	
#line 263
		require {
#line 263
			
#line 263
		type home_root_t;
#line 263
	
#line 263
		} # end require
#line 263
	
#line 263

#line 263

#line 263
	allow amazon_ssm_agent_t home_root_t:dir { getattr search open };
#line 263
	allow amazon_ssm_agent_t home_root_t:lnk_file { getattr read };
#line 263

#line 263
	 	
#line 263
##### end files_search_home(amazon_ssm_agent_t) depth: 2
#line 263
 	
#line 263

#line 263
	 	
#line 263
##### end userdom_search_user_home_dirs(amazon_ssm_agent_t) depth: 1
#line 263
 	
#line 263

#line 263
	 	
#line 263
##### end ssh_read_user_home_files(amazon_ssm_agent_t) depth: 0
#line 263
 	

 	 	
#line 265
##### begin corenet_tcp_connect_ssh_port(amazon_ssm_agent_t) depth: 1
#line 265
 	
#line 265
	
#line 265
	
#line 265
		require {
#line 265
			
#line 265
		type ssh_port_t;
#line 265
	
#line 265
		} # end require
#line 265
	
#line 265

#line 265

#line 265
	allow amazon_ssm_agent_t ssh_port_t:tcp_socket name_connect;
#line 265

#line 265
	 	
#line 265
##### end corenet_tcp_connect_ssh_port(amazon_ssm_agent_t) depth: 0
#line 265
 	

 	 	
#line 267
##### begin mta_getattr_spool(amazon_ssm_agent_t) depth: 1
#line 267
 	
#line 267
	
#line 267
	
#line 267
		require {
#line 267
			
#line 267
		type mail_spool_t;
#line 267
	
#line 267
		} # end require
#line 267
	
#line 267

#line 267

#line 267
	 	 	
#line 267
##### begin files_search_spool(amazon_ssm_agent_t) depth: 2
#line 267
 	
#line 267
	
#line 267
	
#line 267
		require {
#line 267
			
#line 267
		type var_t, var_spool_t;
#line 267
	
#line 267
		} # end require
#line 267
	
#line 267

#line 267

#line 267
	
#line 267
	allow amazon_ssm_agent_t var_t:dir { getattr search open };
#line 267
	allow amazon_ssm_agent_t var_spool_t:dir { getattr search open };
#line 267

#line 267

#line 267
	 	
#line 267
##### end files_search_spool(amazon_ssm_agent_t) depth: 1
#line 267
 	
#line 267
	allow amazon_ssm_agent_t mail_spool_t:dir { getattr search open read lock ioctl };
#line 267
	
#line 267
	allow amazon_ssm_agent_t mail_spool_t:dir { getattr search open };
#line 267
	allow amazon_ssm_agent_t mail_spool_t:file { getattr };
#line 267

#line 267
	
#line 267
	allow amazon_ssm_agent_t mail_spool_t:dir { getattr search open };
#line 267
	allow amazon_ssm_agent_t mail_spool_t:lnk_file { getattr read };
#line 267

#line 267

#line 267
	 	
#line 267
##### end mta_getattr_spool(amazon_ssm_agent_t) depth: 0
#line 267
 	

 	 	
#line 269
##### begin mta_read_spool(amazon_ssm_agent_t) depth: 1
#line 269
 	
#line 269
    
#line 269
	
#line 269
		require {
#line 269
			
#line 269
        type mail_spool_t;
#line 269
    
#line 269
		} # end require
#line 269
	
#line 269

#line 269

#line 269
	 	 	
#line 269
##### begin files_search_spool(amazon_ssm_agent_t) depth: 2
#line 269
 	
#line 269
	
#line 269
	
#line 269
		require {
#line 269
			
#line 269
		type var_t, var_spool_t;
#line 269
	
#line 269
		} # end require
#line 269
	
#line 269

#line 269

#line 269
	
#line 269
	allow amazon_ssm_agent_t var_t:dir { getattr search open };
#line 269
	allow amazon_ssm_agent_t var_spool_t:dir { getattr search open };
#line 269

#line 269

#line 269
	 	
#line 269
##### end files_search_spool(amazon_ssm_agent_t) depth: 1
#line 269
 	
#line 269
	
#line 269
	allow amazon_ssm_agent_t mail_spool_t:dir { getattr search open };
#line 269
	allow amazon_ssm_agent_t mail_spool_t:file { open { getattr read ioctl lock } };
#line 269

#line 269

#line 269
	 	
#line 269
##### end mta_read_spool(amazon_ssm_agent_t) depth: 0
#line 269
 	

 	 	
#line 271
##### begin files_rw_generic_pids(amazon_ssm_agent_t) depth: 1
#line 271
 	
#line 271
	
#line 271
	
#line 271
		require {
#line 271
			
#line 271
		type var_t, var_run_t;
#line 271
	
#line 271
		} # end require
#line 271
	
#line 271

#line 271

#line 271
	 	 	
#line 271
##### begin files_search_pids(amazon_ssm_agent_t) depth: 2
#line 271
 	
#line 271
	
#line 271
	
#line 271
		require {
#line 271
			
#line 271
		type var_t, var_run_t;
#line 271
	
#line 271
		} # end require
#line 271
	
#line 271

#line 271

#line 271
	allow amazon_ssm_agent_t var_t:lnk_file { getattr read };
#line 271
	allow amazon_ssm_agent_t var_run_t:lnk_file { getattr read };
#line 271
	
#line 271
	allow amazon_ssm_agent_t var_t:dir { getattr search open };
#line 271
	allow amazon_ssm_agent_t var_run_t:dir { getattr search open };
#line 271

#line 271

#line 271
	 	
#line 271
##### end files_search_pids(amazon_ssm_agent_t) depth: 1
#line 271
 	
#line 271
	
#line 271
	allow amazon_ssm_agent_t var_t:dir { getattr search open };
#line 271
	allow amazon_ssm_agent_t var_run_t:dir { getattr search open read lock ioctl };
#line 271

#line 271
	
#line 271
	allow amazon_ssm_agent_t var_run_t:dir { getattr search open };
#line 271
	allow amazon_ssm_agent_t var_run_t:file { open { getattr read write append ioctl lock } };
#line 271

#line 271

#line 271
	 	
#line 271
##### end files_rw_generic_pids(amazon_ssm_agent_t) depth: 0
#line 271
 	

 	 	
#line 273
##### begin systemd_dbus_chat_logind(amazon_ssm_agent_t) depth: 1
#line 273
 	
#line 273
	
#line 273
	
#line 273
		require {
#line 273
			
#line 273
		type systemd_logind_t;
#line 273
		class dbus send_msg;
#line 273
	
#line 273
		} # end require
#line 273
	
#line 273

#line 273

#line 273
	allow amazon_ssm_agent_t systemd_logind_t:dbus send_msg;
#line 273
	allow systemd_logind_t amazon_ssm_agent_t:dbus send_msg;
#line 273
	
#line 273
	allow systemd_logind_t amazon_ssm_agent_t:dir { getattr search open read lock ioctl };
#line 273
	allow systemd_logind_t amazon_ssm_agent_t:file { open { getattr read ioctl lock } };
#line 273
	allow systemd_logind_t amazon_ssm_agent_t:lnk_file { getattr read };
#line 273
	allow systemd_logind_t amazon_ssm_agent_t:process getattr;
#line 273

#line 273
	allow systemd_logind_t amazon_ssm_agent_t:process signal;
#line 273
	allow amazon_ssm_agent_t systemd_logind_t:fd use;
#line 273

#line 273
	 	
#line 273
##### end systemd_dbus_chat_logind(amazon_ssm_agent_t) depth: 0
#line 273
 	

 	 	
#line 275
##### begin init_status(amazon_ssm_agent_t) depth: 1
#line 275
 	
#line 275
	
#line 275
	
#line 275
		require {
#line 275
			
#line 275
		type init_t;
#line 275
	
#line 275
		} # end require
#line 275
	
#line 275

#line 275

#line 275
	allow amazon_ssm_agent_t init_t:system status;
#line 275
	allow amazon_ssm_agent_t init_t:service status;
#line 275

#line 275
	 	
#line 275
##### end init_status(amazon_ssm_agent_t) depth: 0
#line 275
 	

 	 	
#line 277
##### begin seutil_read_config(amazon_ssm_agent_t) depth: 1
#line 277
 	
#line 277
	
#line 277
	
#line 277
		require {
#line 277
			
#line 277
		type selinux_config_t;
#line 277
	
#line 277
		} # end require
#line 277
	
#line 277

#line 277

#line 277
	 	 	
#line 277
##### begin files_search_etc(amazon_ssm_agent_t) depth: 2
#line 277
 	
#line 277
	
#line 277
	
#line 277
		require {
#line 277
			
#line 277
		type etc_t;
#line 277
	
#line 277
		} # end require
#line 277
	
#line 277

#line 277

#line 277
	allow amazon_ssm_agent_t etc_t:dir { getattr search open };
#line 277

#line 277
	 	
#line 277
##### end files_search_etc(amazon_ssm_agent_t) depth: 1
#line 277
 	
#line 277
	allow amazon_ssm_agent_t selinux_config_t:dir { getattr search open read lock ioctl };
#line 277
	
#line 277
	allow amazon_ssm_agent_t selinux_config_t:dir { getattr search open };
#line 277
	allow amazon_ssm_agent_t selinux_config_t:file { open { getattr read ioctl lock } };
#line 277

#line 277
	
#line 277
	allow amazon_ssm_agent_t selinux_config_t:dir { getattr search open };
#line 277
	allow amazon_ssm_agent_t selinux_config_t:lnk_file { getattr read };
#line 277

#line 277

#line 277
	 	
#line 277
##### end seutil_read_config(amazon_ssm_agent_t) depth: 0
#line 277
 	

 	 	
#line 279
##### begin term_use_unallocated_ttys(amazon_ssm_agent_t) depth: 1
#line 279
 	
#line 279
	
#line 279
	
#line 279
		require {
#line 279
			
#line 279
		type tty_device_t;
#line 279
	
#line 279
		} # end require
#line 279
	
#line 279

#line 279

#line 279
	 	 	
#line 279
##### begin dev_list_all_dev_nodes(amazon_ssm_agent_t) depth: 2
#line 279
 	
#line 279
	
#line 279
	
#line 279
		require {
#line 279
			
#line 279
		type device_t;
#line 279
	
#line 279
		} # end require
#line 279
	
#line 279

#line 279

#line 279
	
#line 279
	allow amazon_ssm_agent_t device_t:dir { getattr search open };
#line 279
	allow amazon_ssm_agent_t device_t:dir { getattr search open read lock ioctl };
#line 279

#line 279
	
#line 279
	allow amazon_ssm_agent_t device_t:dir { getattr search open };
#line 279
	allow amazon_ssm_agent_t device_t:lnk_file { getattr read };
#line 279

#line 279

#line 279
	 	
#line 279
##### end dev_list_all_dev_nodes(amazon_ssm_agent_t) depth: 1
#line 279
 	
#line 279
	allow amazon_ssm_agent_t tty_device_t:chr_file { open { getattr read write append ioctl lock } };
#line 279

#line 279
	 	
#line 279
##### end term_use_unallocated_ttys(amazon_ssm_agent_t) depth: 0
#line 279
 	

 	 	
#line 281
##### begin files_delete_etc_files(amazon_ssm_agent_t) depth: 1
#line 281
 	
#line 281
	
#line 281
	
#line 281
		require {
#line 281
			
#line 281
		type etc_t;
#line 281
	
#line 281
		} # end require
#line 281
	
#line 281

#line 281

#line 281
	
#line 281
	allow amazon_ssm_agent_t etc_t:dir { getattr search open lock ioctl write remove_name };
#line 281
	allow amazon_ssm_agent_t etc_t:file { getattr unlink };
#line 281

#line 281

#line 281
	 	
#line 281
##### end files_delete_etc_files(amazon_ssm_agent_t) depth: 0
#line 281
 	

 	 	
#line 283
##### begin systemd_write_inherited_logind_sessions_pipes(amazon_ssm_agent_t) depth: 1
#line 283
 	
#line 283
	
#line 283
	
#line 283
		require {
#line 283
			
#line 283
		type systemd_logind_sessions_t;
#line 283
		type systemd_logind_t;
#line 283
	
#line 283
		} # end require
#line 283
	
#line 283

#line 283

#line 283
	allow amazon_ssm_agent_t systemd_logind_t:fd use;
#line 283
	allow amazon_ssm_agent_t systemd_logind_sessions_t:fifo_file write;
#line 283

#line 283
	 	
#line 283
##### end systemd_write_inherited_logind_sessions_pipes(amazon_ssm_agent_t) depth: 0
#line 283
 	

 	 	
#line 285
##### begin libs_delete_lib_symlinks(amazon_ssm_agent_t) depth: 1
#line 285
 	
#line 285
	
#line 285
	
#line 285
		require {
#line 285
			
#line 285
		type lib_t;
#line 285
	
#line 285
		} # end require
#line 285
	
#line 285

#line 285

#line 285
	
#line 285
	allow amazon_ssm_agent_t lib_t:dir { getattr search open lock ioctl write remove_name };
#line 285
	allow amazon_ssm_agent_t lib_t:lnk_file { getattr unlink };
#line 285

#line 285

#line 285
	 	
#line 285
##### end libs_delete_lib_symlinks(amazon_ssm_agent_t) depth: 0
#line 285
 	

 	 	
#line 287
##### begin libs_manage_lib_dirs(amazon_ssm_agent_t) depth: 1
#line 287
 	
#line 287
	
#line 287
	
#line 287
		require {
#line 287
			
#line 287
		type lib_t;
#line 287
	
#line 287
		} # end require
#line 287
	
#line 287

#line 287

#line 287
	
#line 287
	allow amazon_ssm_agent_t lib_t:dir { getattr search open };
#line 287
	allow amazon_ssm_agent_t lib_t:lnk_file { getattr read };
#line 287

#line 287
	allow amazon_ssm_agent_t lib_t:dir { create open getattr setattr read write link unlink rename search add_name remove_name reparent rmdir lock ioctl };
#line 287

#line 287
	 	
#line 287
##### end libs_manage_lib_dirs(amazon_ssm_agent_t) depth: 0
#line 287
 	

 	 	
#line 289
##### begin init_start_transient_unit(amazon_ssm_agent_t) depth: 1
#line 289
 	
#line 289
	
#line 289
	
#line 289
		require {
#line 289
			
#line 289
		type init_t;
#line 289
	
#line 289
		} # end require
#line 289
	
#line 289

#line 289

#line 289
	allow amazon_ssm_agent_t init_t:service start;
#line 289

#line 289
	 	
#line 289
##### end init_start_transient_unit(amazon_ssm_agent_t) depth: 0
#line 289
 	

 	 	
#line 291
##### begin files_manage_boot_files(amazon_ssm_agent_t) depth: 1
#line 291
 	
#line 291
	
#line 291
	
#line 291
		require {
#line 291
			
#line 291
		type boot_t;
#line 291
	
#line 291
		} # end require
#line 291
	
#line 291

#line 291

#line 291
	
#line 291
	allow amazon_ssm_agent_t boot_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 291
	allow amazon_ssm_agent_t boot_t:file { create open getattr setattr read write append rename link unlink ioctl lock };
#line 291

#line 291

#line 291
	 	
#line 291
##### end files_manage_boot_files(amazon_ssm_agent_t) depth: 0
#line 291
 	

 	 	
#line 293
##### begin gssproxy_search_lib(amazon_ssm_agent_t) depth: 1
#line 293
 	
#line 293
	
#line 293
	
#line 293
		require {
#line 293
			
#line 293
		type gssproxy_var_lib_t;
#line 293
	
#line 293
		} # end require
#line 293
	
#line 293

#line 293

#line 293
	allow amazon_ssm_agent_t gssproxy_var_lib_t:dir { getattr search open };
#line 293
	 	 	
#line 293
##### begin files_search_var_lib(amazon_ssm_agent_t) depth: 2
#line 293
 	
#line 293
	
#line 293
	
#line 293
		require {
#line 293
			
#line 293
		type var_t, var_lib_t;
#line 293
	
#line 293
		} # end require
#line 293
	
#line 293

#line 293

#line 293
	
#line 293
	allow amazon_ssm_agent_t var_t:dir { getattr search open };
#line 293
	allow amazon_ssm_agent_t var_lib_t:dir { getattr search open };
#line 293

#line 293

#line 293
	 	
#line 293
##### end files_search_var_lib(amazon_ssm_agent_t) depth: 1
#line 293
 	
#line 293

#line 293
	 	
#line 293
##### end gssproxy_search_lib(amazon_ssm_agent_t) depth: 0
#line 293
 	

 	 	
#line 295
##### begin init_read_var_lib_files(amazon_ssm_agent_t) depth: 1
#line 295
 	
#line 295
	
#line 295
	
#line 295
		require {
#line 295
			
#line 295
		type init_var_lib_t;
#line 295
	
#line 295
		} # end require
#line 295
	
#line 295

#line 295

#line 295
	 	 	
#line 295
##### begin files_search_var_lib(amazon_ssm_agent_t) depth: 2
#line 295
 	
#line 295
	
#line 295
	
#line 295
		require {
#line 295
			
#line 295
		type var_t, var_lib_t;
#line 295
	
#line 295
		} # end require
#line 295
	
#line 295

#line 295

#line 295
	
#line 295
	allow amazon_ssm_agent_t var_t:dir { getattr search open };
#line 295
	allow amazon_ssm_agent_t var_lib_t:dir { getattr search open };
#line 295

#line 295

#line 295
	 	
#line 295
##### end files_search_var_lib(amazon_ssm_agent_t) depth: 1
#line 295
 	
#line 295
	
#line 295
	allow amazon_ssm_agent_t init_var_lib_t:dir { getattr search open };
#line 295
	allow amazon_ssm_agent_t init_var_lib_t:file { open { getattr read ioctl lock } };
#line 295

#line 295

#line 295
	 	
#line 295
##### end init_read_var_lib_files(amazon_ssm_agent_t) depth: 0
#line 295
 	

 	 	
#line 297
##### begin systemd_start_systemd_services(amazon_ssm_agent_t) depth: 1
#line 297
 	
#line 297
	
#line 297
	
#line 297
		require {
#line 297
			
#line 297
		type systemd_unit_file_t;
#line 297
	
#line 297
		} # end require
#line 297
	
#line 297

#line 297

#line 297
	allow amazon_ssm_agent_t systemd_unit_file_t:service start;
#line 297

#line 297
	 	
#line 297
##### end systemd_start_systemd_services(amazon_ssm_agent_t) depth: 0
#line 297
 	

 	 	
#line 299
##### begin files_relabelfrom_boot_files(amazon_ssm_agent_t) depth: 1
#line 299
 	
#line 299
	
#line 299
	
#line 299
		require {
#line 299
			
#line 299
		type boot_t;
#line 299
	
#line 299
		} # end require
#line 299
	
#line 299

#line 299

#line 299
	
#line 299
	allow amazon_ssm_agent_t boot_t:dir { getattr search open };
#line 299
	allow amazon_ssm_agent_t boot_t:file { getattr relabelfrom };
#line 299

#line 299

#line 299
	 	
#line 299
##### end files_relabelfrom_boot_files(amazon_ssm_agent_t) depth: 0
#line 299
 	

 	 	
#line 301
##### begin systemd_config_generic_services(amazon_ssm_agent_t) depth: 1
#line 301
 	
#line 301
	
#line 301
	
#line 301
		require {
#line 301
			
#line 301
		type systemd_unit_file_t;
#line 301
	
#line 301
		} # end require
#line 301
	
#line 301

#line 301

#line 301
	 	 	
#line 301
##### begin systemd_exec_systemctl(amazon_ssm_agent_t) depth: 2
#line 301
 	
#line 301
        
#line 301
	
#line 301
		require {
#line 301
			
#line 301
                type systemd_systemctl_exec_t;
#line 301
        
#line 301
		} # end require
#line 301
	
#line 301

#line 301

#line 301
	 	 	
#line 301
##### begin corecmd_search_bin(amazon_ssm_agent_t) depth: 3
#line 301
 	
#line 301
	
#line 301
	
#line 301
		require {
#line 301
			
#line 301
		type bin_t;
#line 301
	
#line 301
		} # end require
#line 301
	
#line 301

#line 301

#line 301
	 	 	
#line 301
##### begin corecmd_read_bin_symlinks(amazon_ssm_agent_t) depth: 4
#line 301
 	
#line 301
	
#line 301
	
#line 301
		require {
#line 301
			
#line 301
		type bin_t;
#line 301
	
#line 301
		} # end require
#line 301
	
#line 301

#line 301

#line 301
	
#line 301
	allow amazon_ssm_agent_t bin_t:dir { getattr search open };
#line 301
	allow amazon_ssm_agent_t bin_t:lnk_file { getattr read };
#line 301

#line 301

#line 301
	 	
#line 301
##### end corecmd_read_bin_symlinks(amazon_ssm_agent_t) depth: 3
#line 301
 	
#line 301
	
#line 301
	allow amazon_ssm_agent_t bin_t:dir { getattr search open };
#line 301
	allow amazon_ssm_agent_t bin_t:dir { getattr search open };
#line 301

#line 301

#line 301
	 	
#line 301
##### end corecmd_search_bin(amazon_ssm_agent_t) depth: 2
#line 301
 	
#line 301
	allow amazon_ssm_agent_t systemd_systemctl_exec_t:file { { getattr open read execute ioctl } ioctl lock execute_no_trans };
#line 301

#line 301
	 	 	
#line 301
##### begin fs_list_cgroup_dirs(amazon_ssm_agent_t) depth: 3
#line 301
 	
#line 301
	
#line 301
	
#line 301
		require {
#line 301
			
#line 301
		type cgroup_t;
#line 301
	
#line 301
		} # end require
#line 301
	
#line 301

#line 301

#line 301
	
#line 301
	allow amazon_ssm_agent_t cgroup_t:dir { getattr search open };
#line 301
	allow amazon_ssm_agent_t cgroup_t:dir { getattr search open read lock ioctl };
#line 301

#line 301
	 	 	
#line 301
##### begin fs_search_tmpfs(amazon_ssm_agent_t) depth: 4
#line 301
 	
#line 301
	
#line 301
	
#line 301
		require {
#line 301
			
#line 301
		type tmpfs_t;
#line 301
	
#line 301
		} # end require
#line 301
	
#line 301

#line 301

#line 301
	allow amazon_ssm_agent_t tmpfs_t:dir { getattr search open };
#line 301

#line 301
	 	
#line 301
##### end fs_search_tmpfs(amazon_ssm_agent_t) depth: 3
#line 301
 	
#line 301
	 	 	
#line 301
##### begin dev_search_sysfs(amazon_ssm_agent_t) depth: 4
#line 301
 	
#line 301
	
#line 301
	
#line 301
		require {
#line 301
			
#line 301
		type sysfs_t;
#line 301
	
#line 301
		} # end require
#line 301
	
#line 301

#line 301

#line 301
	
#line 301
	allow amazon_ssm_agent_t sysfs_t:dir { getattr search open };
#line 301
	allow amazon_ssm_agent_t sysfs_t:dir { getattr search open };
#line 301

#line 301

#line 301
	 	
#line 301
##### end dev_search_sysfs(amazon_ssm_agent_t) depth: 3
#line 301
 	
#line 301

#line 301
	 	
#line 301
##### end fs_list_cgroup_dirs(amazon_ssm_agent_t) depth: 2
#line 301
 	
#line 301
	 	 	
#line 301
##### begin fs_read_cgroup_files(amazon_ssm_agent_t) depth: 3
#line 301
 	
#line 301
	
#line 301
	
#line 301
		require {
#line 301
			
#line 301
		type cgroup_t;
#line 301

#line 301
	
#line 301
		} # end require
#line 301
	
#line 301

#line 301

#line 301
	
#line 301
	allow amazon_ssm_agent_t cgroup_t:dir { getattr search open };
#line 301
	allow amazon_ssm_agent_t cgroup_t:file { open { getattr read ioctl lock } };
#line 301

#line 301
	
#line 301
	allow amazon_ssm_agent_t cgroup_t:dir { getattr search open };
#line 301
	allow amazon_ssm_agent_t cgroup_t:lnk_file { getattr read };
#line 301

#line 301
	 	 	
#line 301
##### begin fs_search_tmpfs(amazon_ssm_agent_t) depth: 4
#line 301
 	
#line 301
	
#line 301
	
#line 301
		require {
#line 301
			
#line 301
		type tmpfs_t;
#line 301
	
#line 301
		} # end require
#line 301
	
#line 301

#line 301

#line 301
	allow amazon_ssm_agent_t tmpfs_t:dir { getattr search open };
#line 301

#line 301
	 	
#line 301
##### end fs_search_tmpfs(amazon_ssm_agent_t) depth: 3
#line 301
 	
#line 301
	 	 	
#line 301
##### begin dev_search_sysfs(amazon_ssm_agent_t) depth: 4
#line 301
 	
#line 301
	
#line 301
	
#line 301
		require {
#line 301
			
#line 301
		type sysfs_t;
#line 301
	
#line 301
		} # end require
#line 301
	
#line 301

#line 301

#line 301
	
#line 301
	allow amazon_ssm_agent_t sysfs_t:dir { getattr search open };
#line 301
	allow amazon_ssm_agent_t sysfs_t:dir { getattr search open };
#line 301

#line 301

#line 301
	 	
#line 301
##### end dev_search_sysfs(amazon_ssm_agent_t) depth: 3
#line 301
 	
#line 301

#line 301
	 	
#line 301
##### end fs_read_cgroup_files(amazon_ssm_agent_t) depth: 2
#line 301
 	
#line 301
	 	 	
#line 301
##### begin systemd_list_unit_dirs(amazon_ssm_agent_t) depth: 3
#line 301
 	
#line 301
        
#line 301
	
#line 301
		require {
#line 301
			
#line 301
                attribute systemd_unit_file_type;
#line 301
        
#line 301
		} # end require
#line 301
	
#line 301

#line 301
	
#line 301
	 	 	
#line 301
##### begin files_search_var_lib(amazon_ssm_agent_t) depth: 4
#line 301
 	
#line 301
	
#line 301
	
#line 301
		require {
#line 301
			
#line 301
		type var_t, var_lib_t;
#line 301
	
#line 301
		} # end require
#line 301
	
#line 301

#line 301

#line 301
	
#line 301
	allow amazon_ssm_agent_t var_t:dir { getattr search open };
#line 301
	allow amazon_ssm_agent_t var_lib_t:dir { getattr search open };
#line 301

#line 301

#line 301
	 	
#line 301
##### end files_search_var_lib(amazon_ssm_agent_t) depth: 3
#line 301
 	
#line 301
	allow amazon_ssm_agent_t systemd_unit_file_type:dir { getattr search open read lock ioctl };
#line 301

#line 301
	 	
#line 301
##### end systemd_list_unit_dirs(amazon_ssm_agent_t) depth: 2
#line 301
 	
#line 301
	 	 	
#line 301
##### begin init_list_pid_dirs(amazon_ssm_agent_t) depth: 3
#line 301
 	
#line 301
    
#line 301
	
#line 301
		require {
#line 301
			
#line 301
        type init_var_run_t;
#line 301
    
#line 301
		} # end require
#line 301
	
#line 301

#line 301

#line 301
    allow amazon_ssm_agent_t init_var_run_t:dir { getattr search open read lock ioctl };
#line 301

#line 301
	 	
#line 301
##### end init_list_pid_dirs(amazon_ssm_agent_t) depth: 2
#line 301
 	
#line 301
	 	 	
#line 301
##### begin init_read_state(amazon_ssm_agent_t) depth: 3
#line 301
 	
#line 301
	
#line 301
	
#line 301
		require {
#line 301
			
#line 301
		type init_t;
#line 301
	
#line 301
		} # end require
#line 301
	
#line 301

#line 301

#line 301
	allow amazon_ssm_agent_t init_t:dir { getattr search open };
#line 301
	allow amazon_ssm_agent_t init_t:file { open { getattr read ioctl lock } };
#line 301
	allow amazon_ssm_agent_t init_t:lnk_file { getattr read };
#line 301

#line 301
	 	
#line 301
##### end init_read_state(amazon_ssm_agent_t) depth: 2
#line 301
 	
#line 301
	 	 	
#line 301
##### begin init_stream_send(amazon_ssm_agent_t) depth: 3
#line 301
 	
#line 301
	
#line 301
	
#line 301
		require {
#line 301
			
#line 301
		type init_t;
#line 301
	
#line 301
		} # end require
#line 301
	
#line 301

#line 301

#line 301
	allow amazon_ssm_agent_t init_t:unix_stream_socket sendto;
#line 301

#line 301
	 	
#line 301
##### end init_stream_send(amazon_ssm_agent_t) depth: 2
#line 301
 	
#line 301
	 	 	
#line 301
##### begin init_stream_connect(amazon_ssm_agent_t) depth: 3
#line 301
 	
#line 301
	
#line 301
	
#line 301
		require {
#line 301
			
#line 301
		type init_t, init_var_run_t;
#line 301
	
#line 301
		} # end require
#line 301
	
#line 301

#line 301

#line 301
	 	 	
#line 301
##### begin files_search_pids(amazon_ssm_agent_t) depth: 4
#line 301
 	
#line 301
	
#line 301
	
#line 301
		require {
#line 301
			
#line 301
		type var_t, var_run_t;
#line 301
	
#line 301
		} # end require
#line 301
	
#line 301

#line 301

#line 301
	allow amazon_ssm_agent_t var_t:lnk_file { getattr read };
#line 301
	allow amazon_ssm_agent_t var_run_t:lnk_file { getattr read };
#line 301
	
#line 301
	allow amazon_ssm_agent_t var_t:dir { getattr search open };
#line 301
	allow amazon_ssm_agent_t var_run_t:dir { getattr search open };
#line 301

#line 301

#line 301
	 	
#line 301
##### end files_search_pids(amazon_ssm_agent_t) depth: 3
#line 301
 	
#line 301
	
#line 301
	allow amazon_ssm_agent_t init_var_run_t:dir { getattr search open };
#line 301
	allow amazon_ssm_agent_t init_var_run_t:sock_file { getattr write open append };
#line 301
	allow amazon_ssm_agent_t init_t:unix_stream_socket connectto;
#line 301
    
#line 301
	allow amazon_ssm_agent_t init_t:unix_stream_socket getattr;
#line 301

#line 301
	 	
#line 301
##### end init_stream_connect(amazon_ssm_agent_t) depth: 2
#line 301
 	
#line 301

#line 301
	 	 	
#line 301
##### begin systemd_login_list_pid_dirs(amazon_ssm_agent_t) depth: 3
#line 301
 	
#line 301
	
#line 301
	
#line 301
		require {
#line 301
			
#line 301
		type systemd_logind_var_run_t;
#line 301
	
#line 301
		} # end require
#line 301
	
#line 301

#line 301

#line 301
	 	 	
#line 301
##### begin files_search_pids(amazon_ssm_agent_t) depth: 4
#line 301
 	
#line 301
	
#line 301
	
#line 301
		require {
#line 301
			
#line 301
		type var_t, var_run_t;
#line 301
	
#line 301
		} # end require
#line 301
	
#line 301

#line 301

#line 301
	allow amazon_ssm_agent_t var_t:lnk_file { getattr read };
#line 301
	allow amazon_ssm_agent_t var_run_t:lnk_file { getattr read };
#line 301
	
#line 301
	allow amazon_ssm_agent_t var_t:dir { getattr search open };
#line 301
	allow amazon_ssm_agent_t var_run_t:dir { getattr search open };
#line 301

#line 301

#line 301
	 	
#line 301
##### end files_search_pids(amazon_ssm_agent_t) depth: 3
#line 301
 	
#line 301
	
#line 301
	allow amazon_ssm_agent_t systemd_logind_var_run_t:dir { getattr search open };
#line 301
	allow amazon_ssm_agent_t systemd_logind_var_run_t:dir { getattr search open read lock ioctl };
#line 301

#line 301

#line 301
	 	
#line 301
##### end systemd_login_list_pid_dirs(amazon_ssm_agent_t) depth: 2
#line 301
 	
#line 301
	 	 	
#line 301
##### begin systemd_login_read_pid_files(amazon_ssm_agent_t) depth: 3
#line 301
 	
#line 301
	
#line 301
	
#line 301
		require {
#line 301
			
#line 301
		type systemd_logind_var_run_t;
#line 301
	
#line 301
		} # end require
#line 301
	
#line 301

#line 301

#line 301
	 	 	
#line 301
##### begin files_search_pids(amazon_ssm_agent_t) depth: 4
#line 301
 	
#line 301
	
#line 301
	
#line 301
		require {
#line 301
			
#line 301
		type var_t, var_run_t;
#line 301
	
#line 301
		} # end require
#line 301
	
#line 301

#line 301

#line 301
	allow amazon_ssm_agent_t var_t:lnk_file { getattr read };
#line 301
	allow amazon_ssm_agent_t var_run_t:lnk_file { getattr read };
#line 301
	
#line 301
	allow amazon_ssm_agent_t var_t:dir { getattr search open };
#line 301
	allow amazon_ssm_agent_t var_run_t:dir { getattr search open };
#line 301

#line 301

#line 301
	 	
#line 301
##### end files_search_pids(amazon_ssm_agent_t) depth: 3
#line 301
 	
#line 301
	
#line 301
	allow amazon_ssm_agent_t systemd_logind_var_run_t:dir { getattr search open };
#line 301
	allow amazon_ssm_agent_t systemd_logind_var_run_t:file { open { getattr read ioctl lock } };
#line 301

#line 301

#line 301
	 	
#line 301
##### end systemd_login_read_pid_files(amazon_ssm_agent_t) depth: 2
#line 301
 	
#line 301
	 	 	
#line 301
##### begin systemd_passwd_agent_exec(amazon_ssm_agent_t) depth: 3
#line 301
 	
#line 301
	
#line 301
	
#line 301
		require {
#line 301
			
#line 301
		type systemd_passwd_agent_t, systemd_passwd_agent_exec_t;
#line 301
	
#line 301
		} # end require
#line 301
	
#line 301

#line 301

#line 301
	allow amazon_ssm_agent_t systemd_passwd_agent_exec_t:file { { getattr open read execute ioctl } ioctl lock execute_no_trans };
#line 301
	 	 	
#line 301
##### begin systemd_manage_passwd_run(amazon_ssm_agent_t) depth: 4
#line 301
 	
#line 301
	
#line 301
	
#line 301
		require {
#line 301
			
#line 301
		type systemd_passwd_agent_t;	
#line 301
		type systemd_passwd_var_run_t;
#line 301
	
#line 301
		} # end require
#line 301
	
#line 301

#line 301

#line 301
	 	 	
#line 301
##### begin init_search_pid_dirs(amazon_ssm_agent_t) depth: 5
#line 301
 	
#line 301
    
#line 301
	
#line 301
		require {
#line 301
			
#line 301
        type init_var_run_t;
#line 301
    
#line 301
		} # end require
#line 301
	
#line 301

#line 301

#line 301
    allow amazon_ssm_agent_t init_var_run_t:dir { getattr search open };
#line 301

#line 301
	 	
#line 301
##### end init_search_pid_dirs(amazon_ssm_agent_t) depth: 4
#line 301
 	
#line 301
	
#line 301
	allow amazon_ssm_agent_t systemd_passwd_var_run_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 301
	allow amazon_ssm_agent_t systemd_passwd_var_run_t:file { create open getattr setattr read write append rename link unlink ioctl lock };
#line 301

#line 301
	
#line 301
	allow amazon_ssm_agent_t systemd_passwd_var_run_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 301
	allow amazon_ssm_agent_t systemd_passwd_var_run_t:sock_file { create open getattr setattr read write rename link unlink ioctl lock append };
#line 301

#line 301
	
#line 301
	allow amazon_ssm_agent_t systemd_passwd_var_run_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 301
	allow amazon_ssm_agent_t systemd_passwd_var_run_t:fifo_file { create open getattr setattr read write append rename link unlink ioctl lock };
#line 301

#line 301

#line 301
	allow systemd_passwd_agent_t amazon_ssm_agent_t:process signull;
#line 301
	allow systemd_passwd_agent_t amazon_ssm_agent_t:unix_dgram_socket sendto;
#line 301

#line 301
	 	
#line 301
##### end systemd_manage_passwd_run(amazon_ssm_agent_t) depth: 3
#line 301
 	
#line 301

#line 301
	 	
#line 301
##### end systemd_passwd_agent_exec(amazon_ssm_agent_t) depth: 2
#line 301
 	
#line 301

#line 301
	dontaudit amazon_ssm_agent_t self:capability net_admin;
#line 301

#line 301
	 	
#line 301
##### end systemd_exec_systemctl(amazon_ssm_agent_t) depth: 1
#line 301
 	
#line 301
	allow amazon_ssm_agent_t systemd_unit_file_t:file { open { getattr read ioctl lock } };
#line 301
	allow amazon_ssm_agent_t systemd_unit_file_t:service { start stop status reload enable disable } ;
#line 301

#line 301
	 	
#line 301
##### end systemd_config_generic_services(amazon_ssm_agent_t) depth: 0
#line 301
 	

 	 	
#line 303
##### begin unconfined_server_signull(amazon_ssm_agent_t) depth: 1
#line 303
 	
#line 303
	
#line 303
	
#line 303
		require {
#line 303
			
#line 303
		type unconfined_service_t;
#line 303
	
#line 303
		} # end require
#line 303
	
#line 303

#line 303

#line 303
	allow amazon_ssm_agent_t unconfined_service_t:process signull;
#line 303

#line 303
	 	
#line 303
##### end unconfined_server_signull(amazon_ssm_agent_t) depth: 0
#line 303
 	

 	 	
#line 305
##### begin files_manage_etc_dirs(amazon_ssm_agent_t) depth: 1
#line 305
 	
#line 305
	
#line 305
	
#line 305
		require {
#line 305
			
#line 305
		type etc_t;
#line 305
	
#line 305
		} # end require
#line 305
	
#line 305

#line 305

#line 305
	
#line 305
	allow amazon_ssm_agent_t etc_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 305
	allow amazon_ssm_agent_t etc_t:dir { create open getattr setattr read write link unlink rename search add_name remove_name reparent rmdir lock ioctl };
#line 305

#line 305

#line 305
	 	
#line 305
##### end files_manage_etc_dirs(amazon_ssm_agent_t) depth: 0
#line 305
 	

 	 	
#line 307
##### begin systemd_create_unit_file_lnk(amazon_ssm_agent_t) depth: 1
#line 307
 	
#line 307
    
#line 307
	
#line 307
		require {
#line 307
			
#line 307
        type systemd_unit_file_t;
#line 307
    
#line 307
		} # end require
#line 307
	
#line 307

#line 307

#line 307
    
#line 307
	allow amazon_ssm_agent_t systemd_unit_file_t:dir { getattr search open lock ioctl write add_name };
#line 307
	allow amazon_ssm_agent_t systemd_unit_file_t:lnk_file { create getattr };
#line 307

#line 307

#line 307
	 	
#line 307
##### end systemd_create_unit_file_lnk(amazon_ssm_agent_t) depth: 0
#line 307
 	

 	 	
#line 309
##### begin files_manage_etc_dirs(amazon_ssm_agent_t) depth: 1
#line 309
 	
#line 309
	
#line 309
	
#line 309
		require {
#line 309
			
#line 309
		type etc_t;
#line 309
	
#line 309
		} # end require
#line 309
	
#line 309

#line 309

#line 309
	
#line 309
	allow amazon_ssm_agent_t etc_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 309
	allow amazon_ssm_agent_t etc_t:dir { create open getattr setattr read write link unlink rename search add_name remove_name reparent rmdir lock ioctl };
#line 309

#line 309

#line 309
	 	
#line 309
##### end files_manage_etc_dirs(amazon_ssm_agent_t) depth: 0
#line 309
 	

optional {
        
#line 312
	
#line 312
		require {
#line 312
			
#line 312
                type syslogd_var_run_t;
#line 312
                class file { map };
#line 312
        
#line 312
		} # end require
#line 312
	
#line 315


        allow amazon_ssm_agent_t syslogd_var_run_t:file map;
}


optional {

        
#line 323
	
#line 323
		require {
#line 323
			
#line 323
                type systemd_userdbd_runtime_t;
#line 323
        
#line 323
		} # end require
#line 323
	
#line 325


        
#line 327
	allow amazon_ssm_agent_t systemd_userdbd_runtime_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 327
	allow amazon_ssm_agent_t systemd_userdbd_runtime_t:sock_file { create open getattr setattr read write rename link unlink ioctl lock append };
#line 327


}

optional {

        
#line 333
	
#line 333
		require {
#line 333
			
#line 333
        type systemd_userdbd_t;
#line 333
        type systemd_userdbd_runtime_t;
#line 333
        
#line 333
		} # end require
#line 333
	
#line 336


         	 	
#line 338
##### begin files_search_pids(amazon_ssm_agent_t) depth: 1
#line 338
 	
#line 338
	
#line 338
	
#line 338
		require {
#line 338
			
#line 338
		type var_t, var_run_t;
#line 338
	
#line 338
		} # end require
#line 338
	
#line 338

#line 338

#line 338
	allow amazon_ssm_agent_t var_t:lnk_file { getattr read };
#line 338
	allow amazon_ssm_agent_t var_run_t:lnk_file { getattr read };
#line 338
	
#line 338
	allow amazon_ssm_agent_t var_t:dir { getattr search open };
#line 338
	allow amazon_ssm_agent_t var_run_t:dir { getattr search open };
#line 338

#line 338

#line 338
	 	
#line 338
##### end files_search_pids(amazon_ssm_agent_t) depth: 0
#line 338
 	
        
#line 339
	allow amazon_ssm_agent_t systemd_userdbd_runtime_t:dir { getattr search open };
#line 339
	allow amazon_ssm_agent_t systemd_userdbd_runtime_t:dir { getattr search open read lock ioctl };
#line 339

        
#line 340
	allow amazon_ssm_agent_t systemd_userdbd_runtime_t:dir { getattr search open };
#line 340
	allow amazon_ssm_agent_t systemd_userdbd_runtime_t:lnk_file { getattr read };
#line 340

        
#line 341
	allow amazon_ssm_agent_t systemd_userdbd_runtime_t:dir { getattr search open };
#line 341
	allow amazon_ssm_agent_t systemd_userdbd_runtime_t:sock_file { getattr write open append };
#line 341


        allow amazon_ssm_agent_t systemd_userdbd_t:unix_stream_socket connectto;

}


optional {
        
#line 349
	
#line 349
		require {
#line 349
			
#line 349
                type etc_t;
#line 349
                class dir { watch_dir_perms };
#line 349
        
#line 349
		} # end require
#line 349
	
#line 352


        allow amazon_ssm_agent_t etc_t:dir watch_dir_perms;

}


#line 358
	optional {
#line 358
		
#line 358
         	 	
#line 358
##### begin container_spc_read_state(amazon_ssm_agent_t) depth: 1
#line 358
 	
#line 358
	
#line 358
	
#line 358
		require {
#line 358
			
#line 358
		type spc_t;
#line 358
	
#line 358
		} # end require
#line 358
	
#line 358

#line 358

#line 358
	
#line 358
	allow amazon_ssm_agent_t spc_t:dir { getattr search open read lock ioctl };
#line 358
	allow amazon_ssm_agent_t spc_t:file { open { getattr read ioctl lock } };
#line 358
	allow amazon_ssm_agent_t spc_t:lnk_file { getattr read };
#line 358
	allow amazon_ssm_agent_t spc_t:process getattr;
#line 358

#line 358

#line 358
	 	
#line 358
##### end container_spc_read_state(amazon_ssm_agent_t) depth: 0
#line 358
 	
#line 358
         	 	
#line 358
##### begin container_read_pid_files(amazon_ssm_agent_t) depth: 1
#line 358
 	
#line 358
	
#line 358
	
#line 358
		require {
#line 358
			
#line 358
		type container_var_run_t;
#line 358
	
#line 358
		} # end require
#line 358
	
#line 358

#line 358

#line 358
	 	 	
#line 358
##### begin files_search_pids(amazon_ssm_agent_t) depth: 2
#line 358
 	
#line 358
	
#line 358
	
#line 358
		require {
#line 358
			
#line 358
		type var_t, var_run_t;
#line 358
	
#line 358
		} # end require
#line 358
	
#line 358

#line 358

#line 358
	allow amazon_ssm_agent_t var_t:lnk_file { getattr read };
#line 358
	allow amazon_ssm_agent_t var_run_t:lnk_file { getattr read };
#line 358
	
#line 358
	allow amazon_ssm_agent_t var_t:dir { getattr search open };
#line 358
	allow amazon_ssm_agent_t var_run_t:dir { getattr search open };
#line 358

#line 358

#line 358
	 	
#line 358
##### end files_search_pids(amazon_ssm_agent_t) depth: 1
#line 358
 	
#line 358
	
#line 358
	allow amazon_ssm_agent_t container_var_run_t:dir { getattr search open };
#line 358
	allow amazon_ssm_agent_t container_var_run_t:file { open { getattr read ioctl lock } };
#line 358

#line 358

#line 358
	 	
#line 358
##### end container_read_pid_files(amazon_ssm_agent_t) depth: 0
#line 358
 	
#line 358
         	 	
#line 358
##### begin container_runtime_exec(amazon_ssm_agent_t) depth: 1
#line 358
 	
#line 358
	
#line 358
	
#line 358
		require {
#line 358
			
#line 358
		type container_runtime_exec_t;
#line 358
	
#line 358
		} # end require
#line 358
	
#line 358

#line 358

#line 358
	 	 	
#line 358
##### begin corecmd_search_bin(amazon_ssm_agent_t) depth: 2
#line 358
 	
#line 358
	
#line 358
	
#line 358
		require {
#line 358
			
#line 358
		type bin_t;
#line 358
	
#line 358
		} # end require
#line 358
	
#line 358

#line 358

#line 358
	 	 	
#line 358
##### begin corecmd_read_bin_symlinks(amazon_ssm_agent_t) depth: 3
#line 358
 	
#line 358
	
#line 358
	
#line 358
		require {
#line 358
			
#line 358
		type bin_t;
#line 358
	
#line 358
		} # end require
#line 358
	
#line 358

#line 358

#line 358
	
#line 358
	allow amazon_ssm_agent_t bin_t:dir { getattr search open };
#line 358
	allow amazon_ssm_agent_t bin_t:lnk_file { getattr read };
#line 358

#line 358

#line 358
	 	
#line 358
##### end corecmd_read_bin_symlinks(amazon_ssm_agent_t) depth: 2
#line 358
 	
#line 358
	
#line 358
	allow amazon_ssm_agent_t bin_t:dir { getattr search open };
#line 358
	allow amazon_ssm_agent_t bin_t:dir { getattr search open };
#line 358

#line 358

#line 358
	 	
#line 358
##### end corecmd_search_bin(amazon_ssm_agent_t) depth: 1
#line 358
 	
#line 358
	allow amazon_ssm_agent_t container_runtime_exec_t:file { { getattr open read execute ioctl } ioctl lock execute_no_trans };
#line 358

#line 358
	 	
#line 358
##### end container_runtime_exec(amazon_ssm_agent_t) depth: 0
#line 358
 	
#line 358

#line 358
	} # end optional
#line 362



#line 364
	optional {
#line 364
		
#line 364
         	 	
#line 364
##### begin rpm_manage_cache(amazon_ssm_agent_t) depth: 1
#line 364
 	
#line 364
	
#line 364
	
#line 364
		require {
#line 364
			
#line 364
		type rpm_var_cache_t;
#line 364
	
#line 364
		} # end require
#line 364
	
#line 364

#line 364

#line 364
	 	 	
#line 364
##### begin files_search_var_lib(amazon_ssm_agent_t) depth: 2
#line 364
 	
#line 364
	
#line 364
	
#line 364
		require {
#line 364
			
#line 364
		type var_t, var_lib_t;
#line 364
	
#line 364
		} # end require
#line 364
	
#line 364

#line 364

#line 364
	
#line 364
	allow amazon_ssm_agent_t var_t:dir { getattr search open };
#line 364
	allow amazon_ssm_agent_t var_lib_t:dir { getattr search open };
#line 364

#line 364

#line 364
	 	
#line 364
##### end files_search_var_lib(amazon_ssm_agent_t) depth: 1
#line 364
 	
#line 364
	
#line 364
	allow amazon_ssm_agent_t rpm_var_cache_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 364
	allow amazon_ssm_agent_t rpm_var_cache_t:dir { create open getattr setattr read write link unlink rename search add_name remove_name reparent rmdir lock ioctl };
#line 364

#line 364
	
#line 364
	allow amazon_ssm_agent_t rpm_var_cache_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 364
	allow amazon_ssm_agent_t rpm_var_cache_t:file { create open getattr setattr read write append rename link unlink ioctl lock };
#line 364

#line 364
	
#line 364
	allow amazon_ssm_agent_t rpm_var_cache_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 364
	allow amazon_ssm_agent_t rpm_var_cache_t:lnk_file { create getattr setattr read write append rename link unlink ioctl lock };
#line 364

#line 364

#line 364
	 	
#line 364
##### end rpm_manage_cache(amazon_ssm_agent_t) depth: 0
#line 364
 	
#line 364
         	 	
#line 364
##### begin rpm_read_cache(amazon_ssm_agent_t) depth: 1
#line 364
 	
#line 364
	
#line 364
	
#line 364
		require {
#line 364
			
#line 364
		type rpm_var_cache_t;
#line 364
	
#line 364
		} # end require
#line 364
	
#line 364

#line 364

#line 364
	 	 	
#line 364
##### begin files_search_var(amazon_ssm_agent_t) depth: 2
#line 364
 	
#line 364
	
#line 364
	
#line 364
		require {
#line 364
			
#line 364
		type var_t;
#line 364
	
#line 364
		} # end require
#line 364
	
#line 364

#line 364

#line 364
	allow amazon_ssm_agent_t var_t:dir { getattr search open };
#line 364

#line 364
	 	
#line 364
##### end files_search_var(amazon_ssm_agent_t) depth: 1
#line 364
 	
#line 364
	allow amazon_ssm_agent_t rpm_var_cache_t:dir { getattr search open read lock ioctl };
#line 364
	
#line 364
	allow amazon_ssm_agent_t rpm_var_cache_t:dir { getattr search open };
#line 364
	allow amazon_ssm_agent_t rpm_var_cache_t:file { open { getattr read ioctl lock } };
#line 364

#line 364
	
#line 364
	allow amazon_ssm_agent_t rpm_var_cache_t:dir { getattr search open };
#line 364
	allow amazon_ssm_agent_t rpm_var_cache_t:lnk_file { getattr read };
#line 364

#line 364

#line 364
	 	
#line 364
##### end rpm_read_cache(amazon_ssm_agent_t) depth: 0
#line 364
 	
#line 364
         	 	
#line 364
##### begin rpm_delete_db(amazon_ssm_agent_t) depth: 1
#line 364
 	
#line 364
	
#line 364
	
#line 364
		require {
#line 364
			
#line 364
		type rpm_var_lib_t;
#line 364
	
#line 364
		} # end require
#line 364
	
#line 364

#line 364

#line 364
	 	 	
#line 364
##### begin files_search_var_lib(amazon_ssm_agent_t) depth: 2
#line 364
 	
#line 364
	
#line 364
	
#line 364
		require {
#line 364
			
#line 364
		type var_t, var_lib_t;
#line 364
	
#line 364
		} # end require
#line 364
	
#line 364

#line 364

#line 364
	
#line 364
	allow amazon_ssm_agent_t var_t:dir { getattr search open };
#line 364
	allow amazon_ssm_agent_t var_lib_t:dir { getattr search open };
#line 364

#line 364

#line 364
	 	
#line 364
##### end files_search_var_lib(amazon_ssm_agent_t) depth: 1
#line 364
 	
#line 364
	
#line 364
	allow amazon_ssm_agent_t rpm_var_lib_t:dir { getattr search open lock ioctl write remove_name };
#line 364
	allow amazon_ssm_agent_t rpm_var_lib_t:file { getattr unlink };
#line 364

#line 364

#line 364
	 	
#line 364
##### end rpm_delete_db(amazon_ssm_agent_t) depth: 0
#line 364
 	
#line 364
         	 	
#line 364
##### begin rpm_exec(amazon_ssm_agent_t) depth: 1
#line 364
 	
#line 364
	
#line 364
	
#line 364
		require {
#line 364
			
#line 364
		type rpm_exec_t;
#line 364
	
#line 364
		} # end require
#line 364
	
#line 364

#line 364

#line 364
	 	 	
#line 364
##### begin corecmd_search_bin(amazon_ssm_agent_t) depth: 2
#line 364
 	
#line 364
	
#line 364
	
#line 364
		require {
#line 364
			
#line 364
		type bin_t;
#line 364
	
#line 364
		} # end require
#line 364
	
#line 364

#line 364

#line 364
	 	 	
#line 364
##### begin corecmd_read_bin_symlinks(amazon_ssm_agent_t) depth: 3
#line 364
 	
#line 364
	
#line 364
	
#line 364
		require {
#line 364
			
#line 364
		type bin_t;
#line 364
	
#line 364
		} # end require
#line 364
	
#line 364

#line 364

#line 364
	
#line 364
	allow amazon_ssm_agent_t bin_t:dir { getattr search open };
#line 364
	allow amazon_ssm_agent_t bin_t:lnk_file { getattr read };
#line 364

#line 364

#line 364
	 	
#line 364
##### end corecmd_read_bin_symlinks(amazon_ssm_agent_t) depth: 2
#line 364
 	
#line 364
	
#line 364
	allow amazon_ssm_agent_t bin_t:dir { getattr search open };
#line 364
	allow amazon_ssm_agent_t bin_t:dir { getattr search open };
#line 364

#line 364

#line 364
	 	
#line 364
##### end corecmd_search_bin(amazon_ssm_agent_t) depth: 1
#line 364
 	
#line 364
	allow amazon_ssm_agent_t rpm_exec_t:file { { getattr open read execute ioctl } ioctl lock execute_no_trans };
#line 364

#line 364
	 	
#line 364
##### end rpm_exec(amazon_ssm_agent_t) depth: 0
#line 364
 	
#line 364
         	 	
#line 364
##### begin rpm_manage_db(amazon_ssm_agent_t) depth: 1
#line 364
 	
#line 364
	
#line 364
	
#line 364
		require {
#line 364
			
#line 364
		type rpm_var_lib_t;
#line 364
	
#line 364
		} # end require
#line 364
	
#line 364

#line 364

#line 364
	 	 	
#line 364
##### begin files_search_var_lib(amazon_ssm_agent_t) depth: 2
#line 364
 	
#line 364
	
#line 364
	
#line 364
		require {
#line 364
			
#line 364
		type var_t, var_lib_t;
#line 364
	
#line 364
		} # end require
#line 364
	
#line 364

#line 364

#line 364
	
#line 364
	allow amazon_ssm_agent_t var_t:dir { getattr search open };
#line 364
	allow amazon_ssm_agent_t var_lib_t:dir { getattr search open };
#line 364

#line 364

#line 364
	 	
#line 364
##### end files_search_var_lib(amazon_ssm_agent_t) depth: 1
#line 364
 	
#line 364
	
#line 364
	allow amazon_ssm_agent_t rpm_var_lib_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 364
	allow amazon_ssm_agent_t rpm_var_lib_t:file { create open getattr setattr read write append rename link unlink ioctl lock };
#line 364

#line 364
	
#line 364
	allow amazon_ssm_agent_t rpm_var_lib_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 364
	allow amazon_ssm_agent_t rpm_var_lib_t:lnk_file { create getattr setattr read write append rename link unlink ioctl lock };
#line 364

#line 364

#line 364
	 	
#line 364
##### end rpm_manage_db(amazon_ssm_agent_t) depth: 0
#line 364
 	
#line 364
         	 	
#line 364
##### begin files_manage_system_conf_files(amazon_ssm_agent_t) depth: 1
#line 364
 	
#line 364
    
#line 364
	
#line 364
		require {
#line 364
			
#line 364
        type etc_t, system_conf_t;
#line 364
    
#line 364
		} # end require
#line 364
	
#line 364

#line 364

#line 364
    
#line 364
	allow amazon_ssm_agent_t { etc_t system_conf_t }:dir { open read getattr lock search ioctl add_name remove_name write };
#line 364
	allow amazon_ssm_agent_t system_conf_t:file { create open getattr setattr read write append rename link unlink ioctl lock };
#line 364

#line 364
     	 	
#line 364
##### begin files_filetrans_system_conf_named_files(amazon_ssm_agent_t) depth: 2
#line 364
 	
#line 364
    
#line 364
	
#line 364
		require {
#line 364
			
#line 364
        type etc_t, system_conf_t, usr_t;
#line 364
    
#line 364
		} # end require
#line 364
	
#line 364

#line 364

#line 364
	
#line 364
	allow amazon_ssm_agent_t etc_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 364
	type_transition amazon_ssm_agent_t etc_t:file system_conf_t "sysctl.conf";
#line 364

#line 364
	
#line 364
	allow amazon_ssm_agent_t etc_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 364
	type_transition amazon_ssm_agent_t etc_t:file system_conf_t "sysctl.conf.old";
#line 364

#line 364
	
#line 364
	allow amazon_ssm_agent_t etc_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 364
	type_transition amazon_ssm_agent_t etc_t:file system_conf_t "ebtables";
#line 364

#line 364
	
#line 364
	allow amazon_ssm_agent_t etc_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 364
	type_transition amazon_ssm_agent_t etc_t:file system_conf_t "ebtables.old";
#line 364

#line 364
	
#line 364
	allow amazon_ssm_agent_t etc_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 364
	type_transition amazon_ssm_agent_t etc_t:file system_conf_t "ebtables-config";
#line 364

#line 364
	
#line 364
	allow amazon_ssm_agent_t etc_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 364
	type_transition amazon_ssm_agent_t etc_t:file system_conf_t "ebtables-config.old";
#line 364

#line 364
	
#line 364
	allow amazon_ssm_agent_t etc_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 364
	type_transition amazon_ssm_agent_t etc_t:file system_conf_t "iptables";
#line 364

#line 364
	
#line 364
	allow amazon_ssm_agent_t etc_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 364
	type_transition amazon_ssm_agent_t etc_t:file system_conf_t "iptables.old";
#line 364

#line 364
	
#line 364
	allow amazon_ssm_agent_t etc_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 364
	type_transition amazon_ssm_agent_t etc_t:file system_conf_t "iptables-config";
#line 364

#line 364
	
#line 364
	allow amazon_ssm_agent_t etc_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 364
	type_transition amazon_ssm_agent_t etc_t:file system_conf_t "iptables-config.old";
#line 364

#line 364
	
#line 364
	allow amazon_ssm_agent_t etc_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 364
	type_transition amazon_ssm_agent_t etc_t:file system_conf_t "ip6tables";
#line 364

#line 364
	
#line 364
	allow amazon_ssm_agent_t etc_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 364
	type_transition amazon_ssm_agent_t etc_t:file system_conf_t "ip6tables.old";
#line 364

#line 364
	
#line 364
	allow amazon_ssm_agent_t etc_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 364
	type_transition amazon_ssm_agent_t etc_t:file system_conf_t "ip6tables-config";
#line 364

#line 364
	
#line 364
	allow amazon_ssm_agent_t etc_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 364
	type_transition amazon_ssm_agent_t etc_t:file system_conf_t "ip6tables-config.old";
#line 364

#line 364
    
#line 364
	allow amazon_ssm_agent_t etc_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 364
	type_transition amazon_ssm_agent_t etc_t:file system_conf_t "redhat.repo";
#line 364

#line 364
	
#line 364
	allow amazon_ssm_agent_t etc_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 364
	type_transition amazon_ssm_agent_t etc_t:file system_conf_t "system-config-firewall";
#line 364

#line 364
	
#line 364
	allow amazon_ssm_agent_t etc_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 364
	type_transition amazon_ssm_agent_t etc_t:file system_conf_t "system-config-firewall.old";
#line 364

#line 364
	
#line 364
	allow amazon_ssm_agent_t etc_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 364
	type_transition amazon_ssm_agent_t etc_t:dir system_conf_t "yum.repos.d";
#line 364

#line 364
	
#line 364
	allow amazon_ssm_agent_t etc_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 364
	type_transition amazon_ssm_agent_t etc_t:dir system_conf_t "remotes.d";
#line 364

#line 364
	
#line 364
	allow amazon_ssm_agent_t usr_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 364
	type_transition amazon_ssm_agent_t usr_t:dir system_conf_t "repo";
#line 364

#line 364

#line 364
	 	
#line 364
##### end files_filetrans_system_conf_named_files(amazon_ssm_agent_t) depth: 1
#line 364
 	
#line 364

#line 364
	 	
#line 364
##### end files_manage_system_conf_files(amazon_ssm_agent_t) depth: 0
#line 364
 	
#line 364
         	 	
#line 364
##### begin libs_manage_lib_files(amazon_ssm_agent_t) depth: 1
#line 364
 	
#line 364
	
#line 364
	
#line 364
		require {
#line 364
			
#line 364
		type lib_t;
#line 364
	
#line 364
		} # end require
#line 364
	
#line 364

#line 364

#line 364
	
#line 364
	allow amazon_ssm_agent_t lib_t:dir { getattr search open };
#line 364
	allow amazon_ssm_agent_t lib_t:lnk_file { getattr read };
#line 364

#line 364
	
#line 364
	allow amazon_ssm_agent_t lib_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 364
	allow amazon_ssm_agent_t lib_t:file { create open getattr setattr read write append rename link unlink ioctl lock };
#line 364

#line 364

#line 364
	 	
#line 364
##### end libs_manage_lib_files(amazon_ssm_agent_t) depth: 0
#line 364
 	
#line 364
         	 	
#line 364
##### begin files_rw_usr_dirs(amazon_ssm_agent_t) depth: 1
#line 364
 	
#line 364
	
#line 364
	
#line 364
		require {
#line 364
			
#line 364
		type usr_t;
#line 364
	
#line 364
		} # end require
#line 364
	
#line 364

#line 364

#line 364
	allow amazon_ssm_agent_t usr_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 364

#line 364
	 	
#line 364
##### end files_rw_usr_dirs(amazon_ssm_agent_t) depth: 0
#line 364
 	
#line 364
         	 	
#line 364
##### begin auth_manage_passwd(amazon_ssm_agent_t) depth: 1
#line 364
 	
#line 364
	
#line 364
	
#line 364
		require {
#line 364
			
#line 364
		type passwd_file_t;
#line 364
	
#line 364
		} # end require
#line 364
	
#line 364

#line 364

#line 364
	 	 	
#line 364
##### begin files_rw_etc_dirs(amazon_ssm_agent_t) depth: 2
#line 364
 	
#line 364
	
#line 364
	
#line 364
		require {
#line 364
			
#line 364
		type etc_t;
#line 364
	
#line 364
		} # end require
#line 364
	
#line 364

#line 364

#line 364
	allow amazon_ssm_agent_t etc_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 364

#line 364
	 	
#line 364
##### end files_rw_etc_dirs(amazon_ssm_agent_t) depth: 1
#line 364
 	
#line 364
	allow amazon_ssm_agent_t passwd_file_t:file { create open getattr setattr read write append rename link unlink ioctl lock };
#line 364
	 	 	
#line 364
##### begin files_etc_filetrans(amazon_ssm_agent_t,passwd_file_t,file,"passwd") depth: 2
#line 364
 	
#line 364
	
#line 364
	
#line 364
		require {
#line 364
			
#line 364
		type etc_t;
#line 364
	
#line 364
		} # end require
#line 364
	
#line 364

#line 364

#line 364
	
#line 364
	allow amazon_ssm_agent_t etc_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 364
	type_transition amazon_ssm_agent_t etc_t:file passwd_file_t "passwd";
#line 364

#line 364

#line 364
	 	
#line 364
##### end files_etc_filetrans(amazon_ssm_agent_t,passwd_file_t,file,"passwd") depth: 1
#line 364
 	
#line 364
	 	 	
#line 364
##### begin files_etc_filetrans(amazon_ssm_agent_t,passwd_file_t,file,"passwd-") depth: 2
#line 364
 	
#line 364
	
#line 364
	
#line 364
		require {
#line 364
			
#line 364
		type etc_t;
#line 364
	
#line 364
		} # end require
#line 364
	
#line 364

#line 364

#line 364
	
#line 364
	allow amazon_ssm_agent_t etc_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 364
	type_transition amazon_ssm_agent_t etc_t:file passwd_file_t "passwd-";
#line 364

#line 364

#line 364
	 	
#line 364
##### end files_etc_filetrans(amazon_ssm_agent_t,passwd_file_t,file,"passwd-") depth: 1
#line 364
 	
#line 364
	 	 	
#line 364
##### begin files_etc_filetrans(amazon_ssm_agent_t,passwd_file_t,file,"ptmptmp") depth: 2
#line 364
 	
#line 364
	
#line 364
	
#line 364
		require {
#line 364
			
#line 364
		type etc_t;
#line 364
	
#line 364
		} # end require
#line 364
	
#line 364

#line 364

#line 364
	
#line 364
	allow amazon_ssm_agent_t etc_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 364
	type_transition amazon_ssm_agent_t etc_t:file passwd_file_t "ptmptmp";
#line 364

#line 364

#line 364
	 	
#line 364
##### end files_etc_filetrans(amazon_ssm_agent_t,passwd_file_t,file,"ptmptmp") depth: 1
#line 364
 	
#line 364
	 	 	
#line 364
##### begin files_etc_filetrans(amazon_ssm_agent_t,passwd_file_t,file,"group") depth: 2
#line 364
 	
#line 364
	
#line 364
	
#line 364
		require {
#line 364
			
#line 364
		type etc_t;
#line 364
	
#line 364
		} # end require
#line 364
	
#line 364

#line 364

#line 364
	
#line 364
	allow amazon_ssm_agent_t etc_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 364
	type_transition amazon_ssm_agent_t etc_t:file passwd_file_t "group";
#line 364

#line 364

#line 364
	 	
#line 364
##### end files_etc_filetrans(amazon_ssm_agent_t,passwd_file_t,file,"group") depth: 1
#line 364
 	
#line 364
	 	 	
#line 364
##### begin files_etc_filetrans(amazon_ssm_agent_t,passwd_file_t,file,"group-") depth: 2
#line 364
 	
#line 364
	
#line 364
	
#line 364
		require {
#line 364
			
#line 364
		type etc_t;
#line 364
	
#line 364
		} # end require
#line 364
	
#line 364

#line 364

#line 364
	
#line 364
	allow amazon_ssm_agent_t etc_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 364
	type_transition amazon_ssm_agent_t etc_t:file passwd_file_t "group-";
#line 364

#line 364

#line 364
	 	
#line 364
##### end files_etc_filetrans(amazon_ssm_agent_t,passwd_file_t,file,"group-") depth: 1
#line 364
 	
#line 364
	 	 	
#line 364
##### begin files_etc_filetrans(amazon_ssm_agent_t,passwd_file_t,file,".pwd.lock") depth: 2
#line 364
 	
#line 364
	
#line 364
	
#line 364
		require {
#line 364
			
#line 364
		type etc_t;
#line 364
	
#line 364
		} # end require
#line 364
	
#line 364

#line 364

#line 364
	
#line 364
	allow amazon_ssm_agent_t etc_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 364
	type_transition amazon_ssm_agent_t etc_t:file passwd_file_t ".pwd.lock";
#line 364

#line 364

#line 364
	 	
#line 364
##### end files_etc_filetrans(amazon_ssm_agent_t,passwd_file_t,file,".pwd.lock") depth: 1
#line 364
 	
#line 364
	 	 	
#line 364
##### begin files_etc_filetrans(amazon_ssm_agent_t,passwd_file_t,file,"passwd.lock") depth: 2
#line 364
 	
#line 364
	
#line 364
	
#line 364
		require {
#line 364
			
#line 364
		type etc_t;
#line 364
	
#line 364
		} # end require
#line 364
	
#line 364

#line 364

#line 364
	
#line 364
	allow amazon_ssm_agent_t etc_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 364
	type_transition amazon_ssm_agent_t etc_t:file passwd_file_t "passwd.lock";
#line 364

#line 364

#line 364
	 	
#line 364
##### end files_etc_filetrans(amazon_ssm_agent_t,passwd_file_t,file,"passwd.lock") depth: 1
#line 364
 	
#line 364
	 	 	
#line 364
##### begin files_etc_filetrans(amazon_ssm_agent_t,passwd_file_t,file,"group.lock") depth: 2
#line 364
 	
#line 364
	
#line 364
	
#line 364
		require {
#line 364
			
#line 364
		type etc_t;
#line 364
	
#line 364
		} # end require
#line 364
	
#line 364

#line 364

#line 364
	
#line 364
	allow amazon_ssm_agent_t etc_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 364
	type_transition amazon_ssm_agent_t etc_t:file passwd_file_t "group.lock";
#line 364

#line 364

#line 364
	 	
#line 364
##### end files_etc_filetrans(amazon_ssm_agent_t,passwd_file_t,file,"group.lock") depth: 1
#line 364
 	
#line 364

#line 364
	 	
#line 364
##### end auth_manage_passwd(amazon_ssm_agent_t) depth: 0
#line 364
 	
#line 364
         	 	
#line 364
##### begin auth_manage_shadow(amazon_ssm_agent_t) depth: 1
#line 364
 	
#line 364
	
#line 364
	
#line 364
		require {
#line 364
			
#line 364
		attribute can_read_shadow_passwords, can_write_shadow_passwords;
#line 364
		type shadow_t;
#line 364
	
#line 364
		} # end require
#line 364
	
#line 364

#line 364

#line 364
	allow amazon_ssm_agent_t shadow_t:file { create open getattr setattr read write append rename link unlink ioctl lock };
#line 364
	typeattribute amazon_ssm_agent_t can_read_shadow_passwords, can_write_shadow_passwords;
#line 364
	 	 	
#line 364
##### begin files_var_filetrans(amazon_ssm_agent_t,shadow_t,file,"shadow") depth: 2
#line 364
 	
#line 364
	
#line 364
	
#line 364
		require {
#line 364
			
#line 364
		type var_t;
#line 364
	
#line 364
		} # end require
#line 364
	
#line 364

#line 364

#line 364
	
#line 364
	allow amazon_ssm_agent_t var_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 364
	type_transition amazon_ssm_agent_t var_t:file shadow_t "shadow";
#line 364

#line 364

#line 364
	 	
#line 364
##### end files_var_filetrans(amazon_ssm_agent_t,shadow_t,file,"shadow") depth: 1
#line 364
 	
#line 364
	 	 	
#line 364
##### begin files_var_filetrans(amazon_ssm_agent_t,shadow_t,file,"shadow-") depth: 2
#line 364
 	
#line 364
	
#line 364
	
#line 364
		require {
#line 364
			
#line 364
		type var_t;
#line 364
	
#line 364
		} # end require
#line 364
	
#line 364

#line 364

#line 364
	
#line 364
	allow amazon_ssm_agent_t var_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 364
	type_transition amazon_ssm_agent_t var_t:file shadow_t "shadow-";
#line 364

#line 364

#line 364
	 	
#line 364
##### end files_var_filetrans(amazon_ssm_agent_t,shadow_t,file,"shadow-") depth: 1
#line 364
 	
#line 364
	 	 	
#line 364
##### begin files_etc_filetrans(amazon_ssm_agent_t,shadow_t,file,"gshadow") depth: 2
#line 364
 	
#line 364
	
#line 364
	
#line 364
		require {
#line 364
			
#line 364
		type etc_t;
#line 364
	
#line 364
		} # end require
#line 364
	
#line 364

#line 364

#line 364
	
#line 364
	allow amazon_ssm_agent_t etc_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 364
	type_transition amazon_ssm_agent_t etc_t:file shadow_t "gshadow";
#line 364

#line 364

#line 364
	 	
#line 364
##### end files_etc_filetrans(amazon_ssm_agent_t,shadow_t,file,"gshadow") depth: 1
#line 364
 	
#line 364
	 	 	
#line 364
##### begin files_etc_filetrans(amazon_ssm_agent_t,shadow_t,file,"nshadow") depth: 2
#line 364
 	
#line 364
	
#line 364
	
#line 364
		require {
#line 364
			
#line 364
		type etc_t;
#line 364
	
#line 364
		} # end require
#line 364
	
#line 364

#line 364

#line 364
	
#line 364
	allow amazon_ssm_agent_t etc_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 364
	type_transition amazon_ssm_agent_t etc_t:file shadow_t "nshadow";
#line 364

#line 364

#line 364
	 	
#line 364
##### end files_etc_filetrans(amazon_ssm_agent_t,shadow_t,file,"nshadow") depth: 1
#line 364
 	
#line 364
	 	 	
#line 364
##### begin files_etc_filetrans(amazon_ssm_agent_t,shadow_t,file,"opasswd") depth: 2
#line 364
 	
#line 364
	
#line 364
	
#line 364
		require {
#line 364
			
#line 364
		type etc_t;
#line 364
	
#line 364
		} # end require
#line 364
	
#line 364

#line 364

#line 364
	
#line 364
	allow amazon_ssm_agent_t etc_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 364
	type_transition amazon_ssm_agent_t etc_t:file shadow_t "opasswd";
#line 364

#line 364

#line 364
	 	
#line 364
##### end files_etc_filetrans(amazon_ssm_agent_t,shadow_t,file,"opasswd") depth: 1
#line 364
 	
#line 364

#line 364
	 	
#line 364
##### end auth_manage_shadow(amazon_ssm_agent_t) depth: 0
#line 364
 	
#line 364
         	 	
#line 364
##### begin mta_append_spool(amazon_ssm_agent_t) depth: 1
#line 364
 	
#line 364
	
#line 364
	
#line 364
		require {
#line 364
			
#line 364
		type mail_spool_t;
#line 364
	
#line 364
		} # end require
#line 364
	
#line 364

#line 364

#line 364
	 	 	
#line 364
##### begin files_search_spool(amazon_ssm_agent_t) depth: 2
#line 364
 	
#line 364
	
#line 364
	
#line 364
		require {
#line 364
			
#line 364
		type var_t, var_spool_t;
#line 364
	
#line 364
		} # end require
#line 364
	
#line 364

#line 364

#line 364
	
#line 364
	allow amazon_ssm_agent_t var_t:dir { getattr search open };
#line 364
	allow amazon_ssm_agent_t var_spool_t:dir { getattr search open };
#line 364

#line 364

#line 364
	 	
#line 364
##### end files_search_spool(amazon_ssm_agent_t) depth: 1
#line 364
 	
#line 364
	allow amazon_ssm_agent_t mail_spool_t:dir { getattr search open read lock ioctl };
#line 364
	
#line 364
	allow amazon_ssm_agent_t mail_spool_t:dir { getattr search open lock ioctl write add_name };
#line 364
	allow amazon_ssm_agent_t mail_spool_t:file { getattr create open };
#line 364

#line 364
	
#line 364
	allow amazon_ssm_agent_t mail_spool_t:dir { getattr search open };
#line 364
	allow amazon_ssm_agent_t mail_spool_t:file { open { getattr write append lock ioctl } };
#line 364

#line 364
	
#line 364
	allow amazon_ssm_agent_t mail_spool_t:dir { getattr search open };
#line 364
	allow amazon_ssm_agent_t mail_spool_t:lnk_file { getattr read };
#line 364

#line 364

#line 364
	 	
#line 364
##### end mta_append_spool(amazon_ssm_agent_t) depth: 0
#line 364
 	
#line 364
         	 	
#line 364
##### begin mta_rw_spool(amazon_ssm_agent_t) depth: 1
#line 364
 	
#line 364
	
#line 364
	
#line 364
		require {
#line 364
			
#line 364
		type mail_spool_t;
#line 364
	
#line 364
		} # end require
#line 364
	
#line 364

#line 364

#line 364
	 	 	
#line 364
##### begin files_search_spool(amazon_ssm_agent_t) depth: 2
#line 364
 	
#line 364
	
#line 364
	
#line 364
		require {
#line 364
			
#line 364
		type var_t, var_spool_t;
#line 364
	
#line 364
		} # end require
#line 364
	
#line 364

#line 364

#line 364
	
#line 364
	allow amazon_ssm_agent_t var_t:dir { getattr search open };
#line 364
	allow amazon_ssm_agent_t var_spool_t:dir { getattr search open };
#line 364

#line 364

#line 364
	 	
#line 364
##### end files_search_spool(amazon_ssm_agent_t) depth: 1
#line 364
 	
#line 364
	allow amazon_ssm_agent_t mail_spool_t:dir { getattr search open read lock ioctl };
#line 364
	allow amazon_ssm_agent_t mail_spool_t:file { setattr };
#line 364
	
#line 364
	allow amazon_ssm_agent_t mail_spool_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 364
	allow amazon_ssm_agent_t mail_spool_t:file { create open getattr setattr read write append rename link unlink ioctl lock };
#line 364

#line 364
	
#line 364
	allow amazon_ssm_agent_t mail_spool_t:dir { getattr search open };
#line 364
	allow amazon_ssm_agent_t mail_spool_t:lnk_file { getattr read };
#line 364

#line 364

#line 364
	 	
#line 364
##### end mta_rw_spool(amazon_ssm_agent_t) depth: 0
#line 364
 	
#line 364
         	 	
#line 364
##### begin quota_filetrans_named_content(amazon_ssm_agent_t) depth: 1
#line 364
 	
#line 364
	
#line 364
	
#line 364
		require {
#line 364
			
#line 364
		type quota_db_t;
#line 364
	
#line 364
		} # end require
#line 364
	
#line 364

#line 364

#line 364
	 	 	
#line 364
##### begin files_root_filetrans(amazon_ssm_agent_t,quota_db_t,file,"aquota.user") depth: 2
#line 364
 	
#line 364
	
#line 364
	
#line 364
		require {
#line 364
			
#line 364
		type root_t;
#line 364
	
#line 364
		} # end require
#line 364
	
#line 364

#line 364

#line 364
	
#line 364
	allow amazon_ssm_agent_t root_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 364
	type_transition amazon_ssm_agent_t root_t:file quota_db_t "aquota.user";
#line 364

#line 364

#line 364
	 	
#line 364
##### end files_root_filetrans(amazon_ssm_agent_t,quota_db_t,file,"aquota.user") depth: 1
#line 364
 	
#line 364
	 	 	
#line 364
##### begin files_root_filetrans(amazon_ssm_agent_t,quota_db_t,file,"aquota.group") depth: 2
#line 364
 	
#line 364
	
#line 364
	
#line 364
		require {
#line 364
			
#line 364
		type root_t;
#line 364
	
#line 364
		} # end require
#line 364
	
#line 364

#line 364

#line 364
	
#line 364
	allow amazon_ssm_agent_t root_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 364
	type_transition amazon_ssm_agent_t root_t:file quota_db_t "aquota.group";
#line 364

#line 364

#line 364
	 	
#line 364
##### end files_root_filetrans(amazon_ssm_agent_t,quota_db_t,file,"aquota.group") depth: 1
#line 364
 	
#line 364
	 	 	
#line 364
##### begin files_boot_filetrans(amazon_ssm_agent_t,quota_db_t,file,"aquota.user") depth: 2
#line 364
 	
#line 364
	
#line 364
	
#line 364
		require {
#line 364
			
#line 364
		type boot_t;
#line 364
	
#line 364
		} # end require
#line 364
	
#line 364

#line 364

#line 364
	
#line 364
	allow amazon_ssm_agent_t boot_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 364
	type_transition amazon_ssm_agent_t boot_t:file quota_db_t "aquota.user";
#line 364

#line 364

#line 364
	 	
#line 364
##### end files_boot_filetrans(amazon_ssm_agent_t,quota_db_t,file,"aquota.user") depth: 1
#line 364
 	
#line 364
	 	 	
#line 364
##### begin files_boot_filetrans(amazon_ssm_agent_t,quota_db_t,file,"aquota.group") depth: 2
#line 364
 	
#line 364
	
#line 364
	
#line 364
		require {
#line 364
			
#line 364
		type boot_t;
#line 364
	
#line 364
		} # end require
#line 364
	
#line 364

#line 364

#line 364
	
#line 364
	allow amazon_ssm_agent_t boot_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 364
	type_transition amazon_ssm_agent_t boot_t:file quota_db_t "aquota.group";
#line 364

#line 364

#line 364
	 	
#line 364
##### end files_boot_filetrans(amazon_ssm_agent_t,quota_db_t,file,"aquota.group") depth: 1
#line 364
 	
#line 364
	 	 	
#line 364
##### begin files_etc_filetrans(amazon_ssm_agent_t,quota_db_t,file,"aquota.user") depth: 2
#line 364
 	
#line 364
	
#line 364
	
#line 364
		require {
#line 364
			
#line 364
		type etc_t;
#line 364
	
#line 364
		} # end require
#line 364
	
#line 364

#line 364

#line 364
	
#line 364
	allow amazon_ssm_agent_t etc_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 364
	type_transition amazon_ssm_agent_t etc_t:file quota_db_t "aquota.user";
#line 364

#line 364

#line 364
	 	
#line 364
##### end files_etc_filetrans(amazon_ssm_agent_t,quota_db_t,file,"aquota.user") depth: 1
#line 364
 	
#line 364
	 	 	
#line 364
##### begin files_etc_filetrans(amazon_ssm_agent_t,quota_db_t,file,"aquota.group") depth: 2
#line 364
 	
#line 364
	
#line 364
	
#line 364
		require {
#line 364
			
#line 364
		type etc_t;
#line 364
	
#line 364
		} # end require
#line 364
	
#line 364

#line 364

#line 364
	
#line 364
	allow amazon_ssm_agent_t etc_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 364
	type_transition amazon_ssm_agent_t etc_t:file quota_db_t "aquota.group";
#line 364

#line 364

#line 364
	 	
#line 364
##### end files_etc_filetrans(amazon_ssm_agent_t,quota_db_t,file,"aquota.group") depth: 1
#line 364
 	
#line 364
	 	 	
#line 364
##### begin files_tmp_filetrans(amazon_ssm_agent_t,quota_db_t,file,"aquota.user") depth: 2
#line 364
 	
#line 364
	
#line 364
	
#line 364
		require {
#line 364
			
#line 364
		type tmp_t;
#line 364
	
#line 364
		} # end require
#line 364
	
#line 364

#line 364

#line 364
	
#line 364
	allow amazon_ssm_agent_t tmp_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 364
	type_transition amazon_ssm_agent_t tmp_t:file quota_db_t "aquota.user";
#line 364

#line 364

#line 364
	 	
#line 364
##### end files_tmp_filetrans(amazon_ssm_agent_t,quota_db_t,file,"aquota.user") depth: 1
#line 364
 	
#line 364
	 	 	
#line 364
##### begin files_tmp_filetrans(amazon_ssm_agent_t,quota_db_t,file,"aquota.group") depth: 2
#line 364
 	
#line 364
	
#line 364
	
#line 364
		require {
#line 364
			
#line 364
		type tmp_t;
#line 364
	
#line 364
		} # end require
#line 364
	
#line 364

#line 364

#line 364
	
#line 364
	allow amazon_ssm_agent_t tmp_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 364
	type_transition amazon_ssm_agent_t tmp_t:file quota_db_t "aquota.group";
#line 364

#line 364

#line 364
	 	
#line 364
##### end files_tmp_filetrans(amazon_ssm_agent_t,quota_db_t,file,"aquota.group") depth: 1
#line 364
 	
#line 364
	 	 	
#line 364
##### begin files_home_filetrans(amazon_ssm_agent_t,quota_db_t,file,"aquota.user") depth: 2
#line 364
 	
#line 364
	
#line 364
	
#line 364
		require {
#line 364
			
#line 364
		type home_root_t;
#line 364
	
#line 364
		} # end require
#line 364
	
#line 364

#line 364

#line 364
	
#line 364
	allow amazon_ssm_agent_t home_root_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 364
	type_transition amazon_ssm_agent_t home_root_t:file quota_db_t "aquota.user";
#line 364

#line 364

#line 364
	 	
#line 364
##### end files_home_filetrans(amazon_ssm_agent_t,quota_db_t,file,"aquota.user") depth: 1
#line 364
 	
#line 364
	 	 	
#line 364
##### begin files_home_filetrans(amazon_ssm_agent_t,quota_db_t,file,"aquota.group") depth: 2
#line 364
 	
#line 364
	
#line 364
	
#line 364
		require {
#line 364
			
#line 364
		type home_root_t;
#line 364
	
#line 364
		} # end require
#line 364
	
#line 364

#line 364

#line 364
	
#line 364
	allow amazon_ssm_agent_t home_root_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 364
	type_transition amazon_ssm_agent_t home_root_t:file quota_db_t "aquota.group";
#line 364

#line 364

#line 364
	 	
#line 364
##### end files_home_filetrans(amazon_ssm_agent_t,quota_db_t,file,"aquota.group") depth: 1
#line 364
 	
#line 364
	 	 	
#line 364
##### begin files_usr_filetrans(amazon_ssm_agent_t,quota_db_t,file,"aquota.user") depth: 2
#line 364
 	
#line 364
	
#line 364
	
#line 364
		require {
#line 364
			
#line 364
		type usr_t;
#line 364
	
#line 364
		} # end require
#line 364
	
#line 364

#line 364

#line 364
	
#line 364
	allow amazon_ssm_agent_t usr_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 364
	type_transition amazon_ssm_agent_t usr_t:file quota_db_t "aquota.user";
#line 364

#line 364

#line 364
	 	
#line 364
##### end files_usr_filetrans(amazon_ssm_agent_t,quota_db_t,file,"aquota.user") depth: 1
#line 364
 	
#line 364
	 	 	
#line 364
##### begin files_usr_filetrans(amazon_ssm_agent_t,quota_db_t,file,"aquota.group") depth: 2
#line 364
 	
#line 364
	
#line 364
	
#line 364
		require {
#line 364
			
#line 364
		type usr_t;
#line 364
	
#line 364
		} # end require
#line 364
	
#line 364

#line 364

#line 364
	
#line 364
	allow amazon_ssm_agent_t usr_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 364
	type_transition amazon_ssm_agent_t usr_t:file quota_db_t "aquota.group";
#line 364

#line 364

#line 364
	 	
#line 364
##### end files_usr_filetrans(amazon_ssm_agent_t,quota_db_t,file,"aquota.group") depth: 1
#line 364
 	
#line 364
	 	 	
#line 364
##### begin files_var_filetrans(amazon_ssm_agent_t,quota_db_t,file,"aquota.user") depth: 2
#line 364
 	
#line 364
	
#line 364
	
#line 364
		require {
#line 364
			
#line 364
		type var_t;
#line 364
	
#line 364
		} # end require
#line 364
	
#line 364

#line 364

#line 364
	
#line 364
	allow amazon_ssm_agent_t var_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 364
	type_transition amazon_ssm_agent_t var_t:file quota_db_t "aquota.user";
#line 364

#line 364

#line 364
	 	
#line 364
##### end files_var_filetrans(amazon_ssm_agent_t,quota_db_t,file,"aquota.user") depth: 1
#line 364
 	
#line 364
	 	 	
#line 364
##### begin files_var_filetrans(amazon_ssm_agent_t,quota_db_t,file,"aquota.group") depth: 2
#line 364
 	
#line 364
	
#line 364
	
#line 364
		require {
#line 364
			
#line 364
		type var_t;
#line 364
	
#line 364
		} # end require
#line 364
	
#line 364

#line 364

#line 364
	
#line 364
	allow amazon_ssm_agent_t var_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 364
	type_transition amazon_ssm_agent_t var_t:file quota_db_t "aquota.group";
#line 364

#line 364

#line 364
	 	
#line 364
##### end files_var_filetrans(amazon_ssm_agent_t,quota_db_t,file,"aquota.group") depth: 1
#line 364
 	
#line 364
	 	 	
#line 364
##### begin files_spool_filetrans(amazon_ssm_agent_t,quota_db_t,file,"aquota.user") depth: 2
#line 364
 	
#line 364
	
#line 364
	
#line 364
		require {
#line 364
			
#line 364
		type var_t, var_spool_t;
#line 364
	
#line 364
		} # end require
#line 364
	
#line 364

#line 364

#line 364
	allow amazon_ssm_agent_t var_t:dir { getattr search open };
#line 364
	
#line 364
	allow amazon_ssm_agent_t var_spool_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 364
	type_transition amazon_ssm_agent_t var_spool_t:file quota_db_t "aquota.user";
#line 364

#line 364

#line 364
	 	
#line 364
##### end files_spool_filetrans(amazon_ssm_agent_t,quota_db_t,file,"aquota.user") depth: 1
#line 364
 	
#line 364
	 	 	
#line 364
##### begin files_spool_filetrans(amazon_ssm_agent_t,quota_db_t,file,"aquota.group") depth: 2
#line 364
 	
#line 364
	
#line 364
	
#line 364
		require {
#line 364
			
#line 364
		type var_t, var_spool_t;
#line 364
	
#line 364
		} # end require
#line 364
	
#line 364

#line 364

#line 364
	allow amazon_ssm_agent_t var_t:dir { getattr search open };
#line 364
	
#line 364
	allow amazon_ssm_agent_t var_spool_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 364
	type_transition amazon_ssm_agent_t var_spool_t:file quota_db_t "aquota.group";
#line 364

#line 364

#line 364
	 	
#line 364
##### end files_spool_filetrans(amazon_ssm_agent_t,quota_db_t,file,"aquota.group") depth: 1
#line 364
 	
#line 364
	 	 	
#line 364
##### begin mta_spool_filetrans(amazon_ssm_agent_t,quota_db_t,file,"aquota.user") depth: 2
#line 364
 	
#line 364
	
#line 364
	
#line 364
		require {
#line 364
			
#line 364
		type mail_spool_t;
#line 364
	
#line 364
		} # end require
#line 364
	
#line 364

#line 364

#line 364
	 	 	
#line 364
##### begin files_search_spool(amazon_ssm_agent_t) depth: 3
#line 364
 	
#line 364
	
#line 364
	
#line 364
		require {
#line 364
			
#line 364
		type var_t, var_spool_t;
#line 364
	
#line 364
		} # end require
#line 364
	
#line 364

#line 364

#line 364
	
#line 364
	allow amazon_ssm_agent_t var_t:dir { getattr search open };
#line 364
	allow amazon_ssm_agent_t var_spool_t:dir { getattr search open };
#line 364

#line 364

#line 364
	 	
#line 364
##### end files_search_spool(amazon_ssm_agent_t) depth: 2
#line 364
 	
#line 364
	
#line 364
	allow amazon_ssm_agent_t mail_spool_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 364
	type_transition amazon_ssm_agent_t mail_spool_t:file quota_db_t "aquota.user";
#line 364

#line 364

#line 364
	 	
#line 364
##### end mta_spool_filetrans(amazon_ssm_agent_t,quota_db_t,file,"aquota.user") depth: 1
#line 364
 	
#line 364
	 	 	
#line 364
##### begin mta_spool_filetrans(amazon_ssm_agent_t,quota_db_t,file,"aquota.group") depth: 2
#line 364
 	
#line 364
	
#line 364
	
#line 364
		require {
#line 364
			
#line 364
		type mail_spool_t;
#line 364
	
#line 364
		} # end require
#line 364
	
#line 364

#line 364

#line 364
	 	 	
#line 364
##### begin files_search_spool(amazon_ssm_agent_t) depth: 3
#line 364
 	
#line 364
	
#line 364
	
#line 364
		require {
#line 364
			
#line 364
		type var_t, var_spool_t;
#line 364
	
#line 364
		} # end require
#line 364
	
#line 364

#line 364

#line 364
	
#line 364
	allow amazon_ssm_agent_t var_t:dir { getattr search open };
#line 364
	allow amazon_ssm_agent_t var_spool_t:dir { getattr search open };
#line 364

#line 364

#line 364
	 	
#line 364
##### end files_search_spool(amazon_ssm_agent_t) depth: 2
#line 364
 	
#line 364
	
#line 364
	allow amazon_ssm_agent_t mail_spool_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 364
	type_transition amazon_ssm_agent_t mail_spool_t:file quota_db_t "aquota.group";
#line 364

#line 364

#line 364
	 	
#line 364
##### end mta_spool_filetrans(amazon_ssm_agent_t,quota_db_t,file,"aquota.group") depth: 1
#line 364
 	
#line 364
	 	 	
#line 364
##### begin mta_spool_filetrans_queue(amazon_ssm_agent_t,quota_db_t,file,"aquota.user") depth: 2
#line 364
 	
#line 364
	
#line 364
	
#line 364
		require {
#line 364
			
#line 364
		type mqueue_spool_t;
#line 364
	
#line 364
		} # end require
#line 364
	
#line 364

#line 364

#line 364
	 	 	
#line 364
##### begin files_search_spool(amazon_ssm_agent_t) depth: 3
#line 364
 	
#line 364
	
#line 364
	
#line 364
		require {
#line 364
			
#line 364
		type var_t, var_spool_t;
#line 364
	
#line 364
		} # end require
#line 364
	
#line 364

#line 364

#line 364
	
#line 364
	allow amazon_ssm_agent_t var_t:dir { getattr search open };
#line 364
	allow amazon_ssm_agent_t var_spool_t:dir { getattr search open };
#line 364

#line 364

#line 364
	 	
#line 364
##### end files_search_spool(amazon_ssm_agent_t) depth: 2
#line 364
 	
#line 364
	
#line 364
	allow amazon_ssm_agent_t mqueue_spool_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 364
	type_transition amazon_ssm_agent_t mqueue_spool_t:file quota_db_t "aquota.user";
#line 364

#line 364

#line 364
	 	
#line 364
##### end mta_spool_filetrans_queue(amazon_ssm_agent_t,quota_db_t,file,"aquota.user") depth: 1
#line 364
 	
#line 364
	 	 	
#line 364
##### begin mta_spool_filetrans_queue(amazon_ssm_agent_t,quota_db_t,file,"aquota.group") depth: 2
#line 364
 	
#line 364
	
#line 364
	
#line 364
		require {
#line 364
			
#line 364
		type mqueue_spool_t;
#line 364
	
#line 364
		} # end require
#line 364
	
#line 364

#line 364

#line 364
	 	 	
#line 364
##### begin files_search_spool(amazon_ssm_agent_t) depth: 3
#line 364
 	
#line 364
	
#line 364
	
#line 364
		require {
#line 364
			
#line 364
		type var_t, var_spool_t;
#line 364
	
#line 364
		} # end require
#line 364
	
#line 364

#line 364

#line 364
	
#line 364
	allow amazon_ssm_agent_t var_t:dir { getattr search open };
#line 364
	allow amazon_ssm_agent_t var_spool_t:dir { getattr search open };
#line 364

#line 364

#line 364
	 	
#line 364
##### end files_search_spool(amazon_ssm_agent_t) depth: 2
#line 364
 	
#line 364
	
#line 364
	allow amazon_ssm_agent_t mqueue_spool_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 364
	type_transition amazon_ssm_agent_t mqueue_spool_t:file quota_db_t "aquota.group";
#line 364

#line 364

#line 364
	 	
#line 364
##### end mta_spool_filetrans_queue(amazon_ssm_agent_t,quota_db_t,file,"aquota.group") depth: 1
#line 364
 	
#line 364

#line 364
	 	
#line 364
##### end quota_filetrans_named_content(amazon_ssm_agent_t) depth: 0
#line 364
 	
#line 364
         	 	
#line 364
##### begin selinux_validate_context(amazon_ssm_agent_t) depth: 1
#line 364
 	
#line 364
	
#line 364
	
#line 364
		require {
#line 364
			
#line 364
		type security_t;
#line 364
	
#line 364
		} # end require
#line 364
	
#line 364

#line 364

#line 364
	 	 	
#line 364
##### begin dev_getattr_sysfs_fs(amazon_ssm_agent_t) depth: 2
#line 364
 	
#line 364
	
#line 364
	
#line 364
		require {
#line 364
			
#line 364
		type sysfs_t;
#line 364
	
#line 364
		} # end require
#line 364
	
#line 364

#line 364

#line 364
	allow amazon_ssm_agent_t sysfs_t:filesystem getattr;
#line 364

#line 364
	 	
#line 364
##### end dev_getattr_sysfs_fs(amazon_ssm_agent_t) depth: 1
#line 364
 	
#line 364
	 	 	
#line 364
##### begin dev_search_sysfs(amazon_ssm_agent_t) depth: 2
#line 364
 	
#line 364
	
#line 364
	
#line 364
		require {
#line 364
			
#line 364
		type sysfs_t;
#line 364
	
#line 364
		} # end require
#line 364
	
#line 364

#line 364

#line 364
	
#line 364
	allow amazon_ssm_agent_t sysfs_t:dir { getattr search open };
#line 364
	allow amazon_ssm_agent_t sysfs_t:dir { getattr search open };
#line 364

#line 364

#line 364
	 	
#line 364
##### end dev_search_sysfs(amazon_ssm_agent_t) depth: 1
#line 364
 	
#line 364
	allow amazon_ssm_agent_t security_t:lnk_file { getattr read };
#line 364
	allow amazon_ssm_agent_t security_t:dir { getattr search open read lock ioctl };
#line 364
	allow amazon_ssm_agent_t security_t:file { open { getattr read write append ioctl lock } };
#line 364
	allow amazon_ssm_agent_t security_t:security check_context;
#line 364

#line 364
	 	
#line 364
##### end selinux_validate_context(amazon_ssm_agent_t) depth: 0
#line 364
 	
#line 364
         	 	
#line 364
##### begin userdom_create_user_home_dirs(amazon_ssm_agent_t) depth: 1
#line 364
 	
#line 364
	
#line 364
	
#line 364
		require {
#line 364
			
#line 364
		type user_home_dir_t;
#line 364
	
#line 364
		} # end require
#line 364
	
#line 364

#line 364

#line 364
	allow amazon_ssm_agent_t user_home_dir_t:dir { getattr create };
#line 364

#line 364
	 	
#line 364
##### end userdom_create_user_home_dirs(amazon_ssm_agent_t) depth: 0
#line 364
 	
#line 364
         	 	
#line 364
##### begin userdom_manage_user_home_content_files(amazon_ssm_agent_t) depth: 1
#line 364
 	
#line 364
	
#line 364
	
#line 364
		require {
#line 364
			
#line 364
		type user_home_dir_t, user_home_t;
#line 364
	
#line 364
		} # end require
#line 364
	
#line 364

#line 364

#line 364
	
#line 364
	allow amazon_ssm_agent_t user_home_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 364
	allow amazon_ssm_agent_t user_home_t:file { create open getattr setattr read write append rename link unlink ioctl lock };
#line 364

#line 364
	allow amazon_ssm_agent_t user_home_dir_t:dir { getattr search open };
#line 364
	 	 	
#line 364
##### begin files_search_home(amazon_ssm_agent_t) depth: 2
#line 364
 	
#line 364
	
#line 364
	
#line 364
		require {
#line 364
			
#line 364
		type home_root_t;
#line 364
	
#line 364
		} # end require
#line 364
	
#line 364

#line 364

#line 364
	allow amazon_ssm_agent_t home_root_t:dir { getattr search open };
#line 364
	allow amazon_ssm_agent_t home_root_t:lnk_file { getattr read };
#line 364

#line 364
	 	
#line 364
##### end files_search_home(amazon_ssm_agent_t) depth: 1
#line 364
 	
#line 364

#line 364
	 	
#line 364
##### end userdom_manage_user_home_content_files(amazon_ssm_agent_t) depth: 0
#line 364
 	
#line 364
         	 	
#line 364
##### begin files_list_kernel_modules(amazon_ssm_agent_t) depth: 1
#line 364
 	
#line 364
	
#line 364
	
#line 364
		require {
#line 364
			
#line 364
		type modules_object_t;
#line 364
	
#line 364
		} # end require
#line 364
	
#line 364

#line 364

#line 364
	allow amazon_ssm_agent_t modules_object_t:dir { getattr search open read lock ioctl };
#line 364

#line 364
	 	
#line 364
##### end files_list_kernel_modules(amazon_ssm_agent_t) depth: 0
#line 364
 	
#line 364
         	 	
#line 364
##### begin files_manage_generic_tmp_dirs(amazon_ssm_agent_t) depth: 1
#line 364
 	
#line 364
	
#line 364
	
#line 364
		require {
#line 364
			
#line 364
		type tmp_t;
#line 364
	
#line 364
		} # end require
#line 364
	
#line 364

#line 364

#line 364
	
#line 364
	allow amazon_ssm_agent_t tmp_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 364
	allow amazon_ssm_agent_t tmp_t:dir { create open getattr setattr read write link unlink rename search add_name remove_name reparent rmdir lock ioctl };
#line 364

#line 364

#line 364
	 	
#line 364
##### end files_manage_generic_tmp_dirs(amazon_ssm_agent_t) depth: 0
#line 364
 	
#line 364
         	 	
#line 364
##### begin corecmd_manage_all_executables(amazon_ssm_agent_t) depth: 1
#line 364
 	
#line 364
	
#line 364
	
#line 364
		require {
#line 364
			
#line 364
		attribute exec_type;
#line 364
		type bin_t;
#line 364
	
#line 364
		} # end require
#line 364
	
#line 364

#line 364

#line 364
	
#line 364
	allow amazon_ssm_agent_t bin_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 364
	allow amazon_ssm_agent_t exec_type:dir { create open getattr setattr read write link unlink rename search add_name remove_name reparent rmdir lock ioctl };
#line 364

#line 364
	
#line 364
	allow amazon_ssm_agent_t bin_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 364
	allow amazon_ssm_agent_t exec_type:file { create open getattr setattr read write append rename link unlink ioctl lock };
#line 364

#line 364
	
#line 364
	allow amazon_ssm_agent_t bin_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 364
	allow amazon_ssm_agent_t bin_t:lnk_file { create getattr setattr read write append rename link unlink ioctl lock };
#line 364

#line 364

#line 364
	 	
#line 364
##### end corecmd_manage_all_executables(amazon_ssm_agent_t) depth: 0
#line 364
 	
#line 364
         	 	
#line 364
##### begin files_manage_etc_symlinks(amazon_ssm_agent_t) depth: 1
#line 364
 	
#line 364
	
#line 364
	
#line 364
		require {
#line 364
			
#line 364
		type etc_t;
#line 364
	
#line 364
		} # end require
#line 364
	
#line 364

#line 364

#line 364
	
#line 364
	allow amazon_ssm_agent_t etc_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 364
	allow amazon_ssm_agent_t etc_t:lnk_file { create getattr setattr read write append rename link unlink ioctl lock };
#line 364

#line 364

#line 364
	 	
#line 364
##### end files_manage_etc_symlinks(amazon_ssm_agent_t) depth: 0
#line 364
 	
#line 364
         	 	
#line 364
##### begin files_manage_generic_pids_symlinks(amazon_ssm_agent_t) depth: 1
#line 364
 	
#line 364
	
#line 364
	
#line 364
		require {
#line 364
			
#line 364
		type var_run_t;
#line 364
	
#line 364
		} # end require
#line 364
	
#line 364

#line 364

#line 364
	
#line 364
	allow amazon_ssm_agent_t var_run_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 364
	allow amazon_ssm_agent_t var_run_t:lnk_file { create getattr setattr read write append rename link unlink ioctl lock };
#line 364

#line 364

#line 364
	 	
#line 364
##### end files_manage_generic_pids_symlinks(amazon_ssm_agent_t) depth: 0
#line 364
 	
#line 364
         	 	
#line 364
##### begin files_manage_usr_files(amazon_ssm_agent_t) depth: 1
#line 364
 	
#line 364
	
#line 364
	
#line 364
		require {
#line 364
			
#line 364
		type usr_t;
#line 364
	
#line 364
		} # end require
#line 364
	
#line 364

#line 364

#line 364
	
#line 364
	allow amazon_ssm_agent_t usr_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 364
	allow amazon_ssm_agent_t usr_t:file { create open getattr setattr read write append rename link unlink ioctl lock };
#line 364

#line 364

#line 364
	 	
#line 364
##### end files_manage_usr_files(amazon_ssm_agent_t) depth: 0
#line 364
 	
#line 364

#line 364
	} # end optional
#line 387


optional {

        
#line 391
	
#line 391
		require {
#line 391
			
#line 391
                type container_runtime_t;
#line 391
        
#line 391
		} # end require
#line 391
	
#line 393

                
#line 394
	allow amazon_ssm_agent_t container_runtime_t:dir { getattr search open read lock ioctl };
#line 394
	allow amazon_ssm_agent_t container_runtime_t:file { open { getattr read ioctl lock } };
#line 394
	allow amazon_ssm_agent_t container_runtime_t:lnk_file { getattr read };
#line 394
	allow amazon_ssm_agent_t container_runtime_t:process getattr;
#line 394

}


optional {

                
#line 400
	
#line 400
		require {
#line 400
			
#line 400
                type systemd_logind_t;
#line 400
        
#line 400
		} # end require
#line 400
	
#line 402


        allow amazon_ssm_agent_t systemd_logind_t:dir { getattr search open };
        allow amazon_ssm_agent_t systemd_logind_t:file { open { getattr read ioctl lock } };
        allow amazon_ssm_agent_t systemd_logind_t:lnk_file { getattr read };
}

optional {
                
#line 410
	
#line 410
		require {
#line 410
			
#line 410
                type system_dbusd_t;
#line 410
        
#line 410
		} # end require
#line 410
	
#line 412


        allow amazon_ssm_agent_t system_dbusd_t:unix_stream_socket connectto;
}
